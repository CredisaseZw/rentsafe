var B=Object.defineProperty,S=Object.defineProperties;var y=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;var x=(a,n,r)=>n in a?B(a,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[n]=r,j=(a,n)=>{for(var r in n||(n={}))C.call(n,r)&&x(a,r,n[r]);if(b)for(var r of b(n))v.call(n,r)&&x(a,r,n[r]);return a},N=(a,n)=>S(a,y(n));import{r as w,b as I,_ as g,j as e}from"./main-605f1a65.js";import{L as R}from"./Layout-d8d0e5c9.js";import A from"./SearchCreditor-b586b9cd.js";import{f as h}from"./formatting-9de8c923.js";import"./lodash-65d1f6eb.js";import"./assertThisInitialized-3be3daa4.js";import"./removeClass-2f25b0a4.js";import"./Modal-fa119524.js";import"./index-4b3e425d.js";import"./MultipleUpload-3f80ff47.js";import"./index-5b34db9a.js";import"./search-7ba8f0d2.js";function L(){const[a,n]=w.useState(O),[r,l]=w.useState(!1);function d(s,t){const{name:c,value:u}=s.target;n(f=>f.map((p,D)=>t===D?N(j({},p),{[c]:u}):p))}function m(s){s.preventDefault(),l(!0),I.post(reverseUrl("creditor_debit_journal"),{rows:a}).then(t=>{if(console.log(t),t.data.error)throw new Error(t.data.error);g.success("Journal entry(s) created successfully"),n([{id:1,date:new Date().toISOString().split("T")[0],creditorName:"",details:"",accountBalance:"",debitAmount:"",endBalance:"",leaseId:"",accountBalance:"",endDate:""}])}).catch(t=>{console.log(t),g.error(`Failed to submit data 
`+t)}),l(!1)}function i(s){n(t=>t.filter((c,u)=>u!==s))}function o(){n(s=>[...s,{id:s.length+1,date:new Date().toISOString().split("T")[0],creditorName:"",details:"",accountBalance:"",debitAmount:"",endBalance:"",leaseId:"",accountBalance:"",endDate:""}])}return{rows:a,isLoading:r,addRow:o,setRows:n,removeRow:i,handleSubmit:m,handleInputChange:d}}const O=[{id:1,date:new Date().toISOString().split("T")[0],creditorName:"",details:"",accountBalance:"",debitAmount:"",endBalance:"",leaseId:"",accountBalance:"",endDate:""}];function E(){const{rows:a,isLoading:n,addRow:r,setRows:l,removeRow:d,handleSubmit:m,handleInputChange:i}=L();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-white border rounded-3",children:[e.jsx("h5",{className:"text-center p-2 mb-0 text-white bg-info",children:"Debit Journal"}),e.jsxs("form",{className:"p-2",onSubmit:m,children:[e.jsxs("table",{className:"table table-responsive table-bordered table-sm",children:[e.jsx("thead",{className:"position-sticky c-table-top bg-white shadow-sm c-z-5",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-nowrap",children:"Date"}),e.jsx("th",{className:"text-nowrap",children:"Creditor"}),e.jsx("th",{className:"text-nowrap",children:"Details"}),e.jsx("th",{className:"text-nowrap",children:"Account Balance"}),e.jsx("th",{className:"text-nowrap",children:"Debit Amount"}),e.jsx("th",{className:"text-nowrap",children:"End Balance"}),e.jsx("th",{className:"text-nowrap",children:"Action"})]})}),e.jsx("tbody",{children:a.map((o,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:"custom-w-170",children:e.jsx("input",{className:"form-control custom-w-fit",type:"date",name:"date",required:!0,max:new Date().toISOString().split("T")[0],min:o.endDate?new Date(o.endDate).toISOString().split("T")[0]:void 0,value:o.date,onChange:t=>i(t,s)})}),e.jsx("td",{className:"custom-w-170 position-relative",style:{zIndex:a.length-s},children:e.jsx(A,{value:o.creditorName,setValue:t=>{const c=[...a];c[s].creditorName=t,l(c)},url:"",placeholder:"Start typing",delay:500,setCreditorName:t=>{const c=[...a];c[s].creditorName=t,l(c)},setLeaseId:t=>{const c=[...a];c[s].leaseId=t,l(c)},setOpeningBalance:t=>{const c=[...a];c[s].accountBalance=t,l(c)},setEndDate:t=>{const c=[...a];c[s].endDate=t,l(c)}})}),e.jsx("td",{className:"custom-w-3",children:e.jsx("textarea",{name:"details",className:"form-control",rows:2,id:"details",value:o.details,onChange:t=>i(t,s)})}),e.jsx("td",{className:"text-end",children:o.accountBalance?h(o.accountBalance):""}),e.jsx("td",{className:"custom-w-150",children:e.jsx("input",{onChange:t=>i(t,s),className:"form-control",type:"number",id:"debitAmount",name:"debitAmount",value:o.debitAmount,required:!0})}),e.jsx("td",{className:"text-end",children:o.debitAmount?h(Number(o.accountBalance)-Number(o.debitAmount)):o.accountBalance?h(Number(o.accountBalance)):""}),e.jsx("td",{className:"text-center",children:e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>d(s),disabled:a.length===1,children:"-"})})]},o.id))})]}),e.jsx("div",{className:"text-end p-2",children:e.jsxs("button",{type:"button",className:"btn btn-success",onClick:r,children:[e.jsx("i",{className:"leading-icon material-icons",children:"add"}),"Add Row"]})}),e.jsx("div",{className:"text-center mb-3",children:e.jsx("button",{type:"submit",className:"btn btn-info text-white",children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ms-2",children:"processing.."})]}):"Submit"})})]})]})})}E.layout=a=>e.jsx(R,{children:a,title:"Creditor Credit Adjustment - Debit Journal"});export{E as default};
