import{r as p,a as b,j as e,_ as u}from"./media/main-603c3784.js";import{c as g,L as y}from"./Layout-af962dee.js";import{M as d}from"./Modal-c85fcfb1.js";import{B as f}from"./Button-fbe2fdbe.js";import{l as N}from"./lodash-de20a893.js";import"./assertThisInitialized-3be3daa4.js";import"./removeClass-ac4cdc4d.js";import"./index-b312c35d.js";import"./formatting-fad57ba1.js";import"./MultipleUpload-ed4b9494.js";import"./index-80d694c0.js";import"./search-3ccb72b6.js";import"./index-fc1756e4.js";import"./Button-27afb56f.js";const w=({show:t,handleClose:n,userData:l})=>{const[r,i]=p.useState(!1),{data:a,post:s}=b({userId:l.userId}),m=()=>{s(reverseUrl("destroy-user"),{onStart:()=>{i(!0)},onSuccess:o=>{u.success("User deleted successfully"),i(!1),n()},onError:o=>{u.error("Something went wrong! Please try again"),i(!1)}}),n()};return e.jsxs(d,{show:t,onHide:n,size:"md",backdrop:"static",centered:!0,children:[e.jsx(d.Header,{closeButton:!0,className:"h4 bg-info text-white text-center text-uppercase",children:"Confirm Delete User"}),e.jsx(d.Body,{className:"p-4 d-flex justify-content-between align-items-center gap-4",children:e.jsxs("p",{className:"my-3 text-center",children:["Are you sure you want to delete ",l.firstName," ",l.lastName," from the system? This action cannot be undone."]})}),e.jsxs(d.Footer,{className:"p-4 d-flex justify-content-end gap-4",children:[e.jsxs(f,{onClick:n,variant:"secondary",children:[e.jsx("i",{className:"material-icons",children:"cancel"}),"Cancel"]}),e.jsxs(f,{onClick:m,variant:"danger",children:[e.jsx("i",{className:"material-icons",children:"done"}),"Delete"]})]})]})},U=w;function A(t,n,l,r){const{errors:i,data:a,processing:s,setData:m,post:o,put:c}=b({firstName:t.firstName||"",lastName:t.lastName||"",identificationNumber:t.identificationNumber||"",identificationType:t.identificationType||"",mobileNumber:t.mobile||"",userEmail:t.email||"",accessLevel:t.access_level||"",address:t.address||"",userId:t.userId||-1});function h(){o(reverseUrl(n),{onSuccess:()=>{u.success(`${N.capitalize(a.firstName)} ${N.capitalize(a.lastName)}'s details were added successfully`),r()},onError:()=>{u.error("Error adding details")}})}function x(){c(reverseUrl(n),{onSuccess:()=>{u.success(`${N.capitalize(a.firstName)} ${N.capitalize(a.lastName)}'s details were updated successfully`),r()},onError:()=>{u.error("Error updating details")}})}function v(j){j.preventDefault(),l==="add"?h():x()}return{data:a,errors:i,isLoading:s,handleSubmit:v,changeHandler:j=>m({...a,[j.target.id]:j.target.value})}}function S({show:t,handleClose:n,action:l,user:r,url:i}){const{data:a,errors:s,isLoading:m,handleSubmit:o,changeHandler:c}=A(r,i,l,n);return e.jsxs(d,{size:"lg",backdrop:"static",centered:!0,show:t,onHide:n,children:[e.jsx(d.Header,{closeButton:!0,className:"bg-info",children:e.jsx("h3",{className:"mb-0 text-white",children:l==="add"?r?.userId?"Add Internal User":"Add New User":"Update User"})}),e.jsx(d.Body,{children:e.jsxs("form",{onSubmit:o,className:"border border-3 border-info p-4 mt-4",children:[e.jsxs("div",{className:"row row-cols-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Surname"}),e.jsx("input",{value:a.lastName,onChange:c,type:"text",placeholder:"Surname",required:!0,name:"lastName",id:"lastName",className:"form-control"}),s&&e.jsx("div",{className:"text-danger small mt-1",children:s.lastName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"First Name"}),e.jsx("input",{value:a.firstName,onChange:c,type:"text",placeholder:"First Name",required:!0,name:"firstName",id:"firstName",className:"form-control"}),s&&e.jsx("div",{className:"text-danger small mt-1",children:s.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Identification Type"}),e.jsxs("select",{className:"form-select","aria-label":"Default select example",name:"identificationType",required:!0,id:"identificationType",onChange:c,value:a.identificationType,children:[e.jsx("option",{children:"Select Type..."}),e.jsx("option",{value:"nationalid",children:"National ID"}),e.jsx("option",{value:"passport",children:"Passport"}),e.jsx("option",{value:"servicesid",children:"Service ID"})]}),s&&e.jsx("div",{className:"text-danger small mt-1",children:s.identificationType})]})]}),e.jsxs("div",{className:"row row-cols-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Identification Number"}),e.jsx("input",{value:a.identificationNumber,onChange:c,type:"text",required:!0,placeholder:"Identification Number",name:"identificationNumber",id:"identificationNumber",className:"form-control"}),s&&e.jsx("div",{className:"text-danger small mt-1",children:s.identificationNumber})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Address"}),e.jsx("textarea",{value:a.address,onChange:c,type:"text",placeholder:"Address",id:"address",required:!0,name:"address",className:"form-control"}),s&&e.jsx("div",{className:"text-danger small mt-1",children:s.address})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Mobile Number"}),e.jsx("input",{value:a.mobileNumber,onChange:c,required:!0,placeholder:"Mobile Number",type:"text",name:"mobileNumber",id:"mobileNumber",className:"form-control"}),s&&e.jsx("div",{className:"text-danger small mt-1",children:s.mobileNumber})]})]}),e.jsxs("div",{className:"row row-cols-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Access Level"}),e.jsxs("select",{value:a.accessLevel,onChange:c,id:"accessLevel",required:!0,name:"accessLevel",className:"form-select",children:[e.jsx("option",{value:"",disabled:!0,children:"Select Level..."}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"user",children:"User"})]}),s&&e.jsx("div",{className:"text-danger small mt-1",children:s.accessLevel})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"User Email"}),e.jsx("input",{value:a.userEmail,onChange:c,type:"email",name:"userEmail",placeholder:"eg. joe@rentsafe.com",id:"userEmail",required:!0,className:"form-control"}),s&&e.jsx("div",{className:"text-danger small mt-1",children:s.userEmail})]})]}),e.jsx("div",{className:"text-end mt-4",children:e.jsx("button",{type:"submit",disabled:m,className:"btn btn-info text-white",children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm me-2"}),e.jsx("span",{className:"ml-2",children:"processing.."})]}):l==="add"?"Add User":"Update User"})})]})})]})}function C({show:t,handleClose:n,handleProceed:l}){const[r,i]=p.useState();function a(s){i({userId:s.id,firstName:s.firstname,lastName:s.surname,identificationNumber:s.national_id,identificationType:"nationalid"})}return e.jsxs(d,{size:"md",backdrop:"static",centered:!0,show:t,onHide:n,children:[e.jsx(d.Header,{closeButton:!0,className:"bg-info",children:e.jsx("h3",{className:"mb-0 text-white",children:"Add Internal User"})}),e.jsx(d.Body,{children:e.jsx("div",{className:"custom-mn-h-3 py-5 px-4 mt-4",children:e.jsxs("div",{className:"d-flex gap-2 py-4",children:[e.jsx(g,{onChange:s=>a(s),extraProps:{className:"flex-grow-1",placeholder:"ID number or full name..."},useAlternateFetchOptions:{type:"individual"},noOptionsMessage:()=>e.jsxs("p",{className:"m-0 text-center",children:["No search results found. Please add this individual's details by clicking",e.jsx("br",{}),e.jsx("button",{type:"button",className:"btn btn-info btn-sm text-white mt-2",onClick:()=>{l({})},children:"Ok"})]})}),r?.userId?e.jsx("button",{className:"btn btn-info text-white c-w-fit",onClick:()=>l(r),children:"Proceed"}):e.jsx("div",{className:"text-white bg-info d-flex align-items-center px-2",children:e.jsx("i",{className:"material-icons",children:"search"})})]})})})]})}function T(t){const[n,l]=p.useState(t),[r,i]=p.useState(""),[a,s]=p.useState({type:"",action:"",userToActOn:{}});function m(o){o.preventDefault(),i(o.target.value);const c=t.filter(h=>{const x=o.target.value.toLowerCase();return h.email.toLowerCase().includes(x)||h.firstName.toLowerCase().includes(x)||h.lastName.toLowerCase().includes(x)});l(c)}return{searchValue:r,filteredUsers:n,userModalOptions:a,setUserModalOptions:s,handleSearch:m}}function I({users:t}){const{searchValue:n,filteredUsers:l,userModalOptions:r,setUserModalOptions:i,handleSearch:a}=T(t);return e.jsxs("main",{children:[r?.type!==""&&e.jsxs(e.Fragment,{children:[e.jsx(S,{show:r.type==="user",action:r.action,user:r.userToActOn,url:r.action==="add"?"create-user":"edit-user",handleClose:()=>i({type:"",action:"",userToActOn:{}})},JSON.stringify(r.userToActOn)),e.jsx(C,{show:r.type==="add-internal-user",handleClose:()=>i({type:"",action:"",userToActOn:{}}),handleProceed:s=>i({type:"user",action:"add",userToActOn:s})}),e.jsx(U,{userData:r.userToActOn,show:r.type==="delete",handleClose:()=>i({type:"",action:"",userToActOn:{}})})]}),e.jsx("h5",{className:"text-center p-2 mb-0 text-white bg-info",children:"Internal Users"}),e.jsxs("table",{className:"table table-sm table-striped border bg-white ",children:[e.jsxs("thead",{className:"position-sticky c-table-top bg-white shadow-sm c-z-5",children:[e.jsx("tr",{className:"c-bg-whitesmoke",children:e.jsx("td",{colSpan:7,children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"col-5 d-flex",children:[e.jsx("input",{type:"search",value:n,onChange:a,placeholder:"Full name or email...",className:"form-control custom-mx-w-4 rounded-0 rounded-start"}),e.jsx("div",{className:"text-white custom-bg-grey rounded-end d-flex align-items-center px-2",children:e.jsx("i",{className:"material-icons",children:"search"})})]}),e.jsxs("button",{className:"btn btn-info text-white rounded-0 rounded-top rounded-top-5",onClick:()=>i({type:"add-internal-user",action:"",userToActOn:{}}),children:[e.jsx("i",{className:"leading-icon material-icons",children:"add"}),"Add User"]})]})})}),e.jsxs("tr",{className:"c-force-borders",children:[e.jsx("th",{className:"ps-3",children:e.jsx("div",{children:" Surname"})}),e.jsx("th",{children:e.jsx("div",{children:"First Name "})}),e.jsx("th",{children:e.jsx("div",{children:"Level "})}),e.jsx("th",{children:e.jsx("div",{children:"Email "})}),e.jsx("th",{children:e.jsx("div",{children:"Mobile Number "})}),e.jsx("th",{className:"text-end pe-3",children:e.jsx("div",{children:"Actions "})})]})]}),e.jsx("tbody",{children:l?.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-capitalize ps-3",children:s.lastName}),e.jsx("td",{className:"text-capitalize",children:s.firstName}),e.jsx("td",{className:"text-capitalize",children:s.access_level}),e.jsx("td",{className:"text-lowercase",children:s.email}),e.jsx("td",{children:s.mobile}),e.jsxs("td",{className:"d-flex gap-2 justify-content-end pe-3",children:[e.jsx("button",{className:"btn btn-sm btn-info text-white",onClick:()=>{i({type:"user",action:"edit",userToActOn:s})},children:"Edit"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>{i({type:"delete",action:"",userToActOn:s})},children:"Delete"})]})]},s.userId))})]}),l?.length===0&&n?e.jsx("p",{className:"custom-mx-w-4 mx-auto p-4 border border-2 text-center border-info",children:"This individual is not part of the user list. Click 'Add User' to start the process of adding a new Internal User"}):""]})}I.layout=t=>e.jsx(y,{children:t,title:"Users"});export{I as default};
