import{r as s,b as B,u as F,j as t}from"./main-4a381f5d.js";import{_ as Y}from"./lodash-d38e7526.js";import{_ as q}from"./index-c43108c2.js";function J({delay:p=500,url:f,value:d,setValue:b,placeholder:L,type:R,setAddress:h,setClientId:z,setRegNumber:i,setClientName:g,setMobileNo:x,from:u="subs"}){var j,k,C;const[I,c]=s.useState(!1),[y,l]=s.useState(!1),[v,w]=s.useState(""),[S,n]=s.useState([]),[m,P]=s.useState([]);s.useEffect(()=>{if(!d){n([]);return}const a=Y.debounce(r=>{l(!0),B.post(f,{searchParam:"guess",searchValue:r}).then(e=>{var E,D;((E=e.data)==null?void 0:E.status)!=="failed"?(R==="company"?(P([...e.data]),n(e.data.map(o=>({label:o.registration_name+"("+o.registration_number+")",value:o.id})))):n(e.data.map(o=>({label:o.firstname+" "+o.surname+"("+o.national_id+")",value:o.id}))),w(""),l(!1)):(n([]),l(!1),w((D=e.data)==null?void 0:D.result))})},p);return a(d),l(!1),()=>{a.cancel()}},[p,f,d]);const _=(C=(k=(j=F().props)==null?void 0:j.Auth)==null?void 0:k.company)==null?void 0:C.company_id,T=a=>{const r=Number(a.value)===Number(_);if(console.log({selected_company_id:a.value,company_id:_,isSelfCompany:r}),r){q.error("Error: cannot setup lease for own company");return}z(a.value),b(a.label),g&&g(a.label.split("(")[0]),i&&u==="subs"&&i(a.label.split("(").at(-1).split(")")[0]),i&&u==="leases"&&i(m.find(e=>e.id===a.value).email),x&&u==="leases"&&x(m.find(e=>e.id===a.value).mobile),h&&h(m.find(e=>e.id===a.value).address),c(!1)};return t.jsxs("div",{style:{width:"100%",border:"1px solid gray",borderRadius:"0.5rem",position:"relative"},children:[t.jsx("input",{type:"text",placeholder:L,value:d,onChange:a=>b(a.target.value),onFocus:()=>c(!0),onBlur:()=>{setTimeout(()=>c(!1),200)},style:{width:"100%",padding:"0.2rem",fontSize:"1rem",border:"none",borderRadius:"0.5rem",backgroundColor:"#eee",color:"black",opacity:"0.8"},className:"form-control"}),I&&t.jsx("div",{style:{border:"2px #ccc solid",borderRadius:"0.5rem",backgroundColor:"#d9d9d9",padding:"1rem 0.2rem",height:"250px",overflowY:"scroll",width:"100%",marginTop:"0.1rem",position:"absolute",top:"100%",left:"0",zIndex:"100"},children:!y&&v?t.jsx("div",{style:{color:"red",margin:"auto"},children:v}):y&&S.length===0?t.jsx("div",{style:{color:"black",margin:"auto"},children:"Loading..."}):S.map((a,r)=>t.jsx("div",{onClick:()=>T(a),style:{cursor:"pointer",padding:"0.2rem 0.5rem",color:"black",opacity:"0.8",backgroundColor:"#d3d3d3",borderRadius:"0.5rem",margin:"0.5rem 0"},children:a.label},r))})]})}export{J as S};
