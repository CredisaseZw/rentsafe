import{r as o,b as E,_ as F,j as t}from"./main-a6dda5c9.js";import{C as N,L as q}from"./Layout-b4321159.js";import"./lodash-d3c3e9f3.js";import"./assertThisInitialized-3be3daa4.js";import"./removeClass-6ad84934.js";import"./Modal-c2655e25.js";import"./index-e760cfb2.js";import"./formatting-9de8c923.js";import"./MultipleUpload-0f1cec23.js";import"./index-cdca6ff0.js";import"./search-2b7e2b99.js";function k(){const[a,i]=o.useState(!1),[b,r]=o.useState(!1),[m,u]=o.useState(null),[d,x]=o.useState([]),[j,f]=o.useState([]),[c,e]=o.useState(!1);function A(){e(!0),E.get("/accounting/sales-accounts/").then(s=>{const n=s.data.map(l=>({accountName:l.account_name,accountNumber:l.account_number,accountsSector:l.account_sector,sectorName:l.account_sector,isEditable:!1}));x(n),e(!1)}).catch(s=>{console.error(s),e(!1)})}const w=()=>{f([])};o.useEffect(()=>{A(),w()},[]);const g=[...j,...d].sort((s,n)=>s.accountNumber-n.accountNumber);function S(s){s.preventDefault();const n=s.target,l=Object.fromEntries(new FormData(n)),h={};if(Object.entries(l).forEach(([v,y])=>{const[C,p]=v.split("-");h[p]||(h[p]={}),h[p][C]=y}),Object.values(h).length===0){F.error("No accounts are available to edit/were edited");return}u(),i(!0)}function _(){console.log("Update accounts",m),i(!1),u(null)}function L(s){s.preventDefault();const n=Object.fromEntries(new FormData(s.target));console.log("Add new account",n),r(!1)}return{mappableAccountsList:g,showConfirmPrompt:a,showNewAccForm:b,submittedAccs:m,loading:c,setShowConfirmPrompt:i,setShowNewAccForm:r,handleAddition:L,submitUpdates:_,handleSubmit:S}}function D(){const{mappableAccountsList:a,showConfirmPrompt:i,showNewAccForm:b,submittedAccs:r,loading:m,setShowConfirmPrompt:u,setShowNewAccForm:d,handleAddition:x,submitUpdates:j,handleSubmit:f}=k();return t.jsxs("div",{children:[t.jsxs(N,{show:i,handleClose:()=>u(!1),size:"md",title:"Edit Account",children:[t.jsxs("p",{className:"text-center mb-4",children:["You are about to edit ",r==null?void 0:r.length," General Ledger accounts. Click OK to accept or Exit to return to list"]}),t.jsxs("div",{className:"d-flex justify-content-center",children:[t.jsx("button",{onClick:j,className:"btn btn-info text-white me-2",children:"OK"}),t.jsx("button",{onClick:()=>u(!1),className:"btn btn-secondary",children:"Exit"})]})]}),t.jsx(N,{show:b,handleClose:()=>d(!1),size:"lg",title:"Add General Ledger Account",children:t.jsxs("form",{onSubmit:x,children:[t.jsxs("div",{className:"d-flex gap-3 align-items-center justify-content-around mb-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"account_name",className:"form-label",children:"Account Name"}),t.jsx("input",{type:"text",className:"form-control",id:"account_name",name:"account_name",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"account_number",className:"form-label",children:"Account Number"}),t.jsx("input",{className:"form-control",id:"account_number",name:"account_number",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"accounts_sector",className:"form-label",children:"Accounts Sector"}),t.jsx("input",{type:"text",className:"form-control",id:"accounts_sector",name:"accounts_sector",required:!0})]})]}),t.jsxs("div",{className:"text-end",children:[t.jsx("button",{type:"submit",className:"btn btn-info text-white",children:"Save"}),t.jsx("button",{type:"button",onClick:()=>d(!1),className:"btn btn-secondary ms-2",children:"Cancel"})]})]})}),t.jsxs("form",{onSubmit:f,children:[t.jsx("h5",{className:"rounded-2 bg-success text-white text-center p-1",children:"Accounts List"}),t.jsx("div",{className:"text-end mb-2",children:t.jsxs("button",{type:"button",onClick:()=>d(!0),className:"btn btn-info text-white",children:[t.jsx("i",{className:"material-icons leading-icon",children:"add"}),"Add Account"]})}),t.jsxs("table",{className:"table table-responsive table-sm table-bordered",children:[t.jsx("thead",{className:"position-sticky c-table-top bg-white shadow-sm",children:t.jsxs("tr",{children:[t.jsx("th",{children:"Account Name"}),t.jsx("th",{children:"Account Number"}),t.jsx("th",{children:"Accounts Sector"}),t.jsx("th",{children:"Sector Name"})]})}),t.jsx("tbody",{children:m?t.jsx("tr",{children:t.jsx("td",{colSpan:"4",className:"text-center bg-white p-5",children:t.jsx("div",{className:"spinner-border text-success",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})})})}):a.length===0?t.jsx("tr",{children:t.jsx("td",{colSpan:"4",className:"text-center bg-white p-5",children:"Nothing to show"})}):a.map((c,e)=>c.isEditable?t.jsxs("tr",{className:"bg-white c-pointer",children:[t.jsx("td",{children:t.jsx("input",{name:"account_name-"+e,id:"account_name-"+e,className:"form-control",defaultValue:c.accountName,placeholder:"Account Name",required:!0})}),t.jsx("td",{children:t.jsx("input",{name:"account_number-"+e,id:"account_number-"+e,className:"form-control",defaultValue:c.accountNumber,placeholder:"Account Number",required:!0})}),t.jsx("td",{children:t.jsx("input",{name:"accounts_sector-"+e,id:"accounts_sector-"+e,className:"form-control",defaultValue:c.accountsSector,placeholder:"Accounts Sector",required:!0})}),t.jsx("td",{children:t.jsx("input",{type:"text",name:"sector_name-"+e,id:"sector_name-"+e,className:"form-control",defaultValue:c.sectorName,placeholder:"Sector Name",required:!0})})]},e):t.jsxs("tr",{children:[t.jsx("td",{children:c.accountName}),t.jsx("td",{children:c.accountNumber}),t.jsx("td",{children:c.accountsSector}),t.jsx("td",{children:c.sectorName})]},e))})]}),t.jsx("div",{className:"text-end",children:t.jsx("button",{type:"submit",className:"btn btn-info text-white",children:"Update"})})]})]})}D.layout=a=>t.jsx(q,{children:a,title:"Accounts List"});export{D as default};
