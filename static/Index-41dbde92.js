var Le=Object.defineProperty,ke=Object.defineProperties;var Ye=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var ye=Math.pow,Ne=(d,l,a)=>l in d?Le(d,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):d[l]=a,I=(d,l)=>{for(var a in l||(l={}))fe.call(l,a)&&Ne(d,a,l[a]);if(se)for(var a of se(l))je.call(l,a)&&Ne(d,a,l[a]);return d},E=(d,l)=>ke(d,Ye(l));var le=(d,l)=>{var a={};for(var i in d)fe.call(d,i)&&l.indexOf(i)<0&&(a[i]=d[i]);if(d!=null&&se)for(var i of se(d))l.indexOf(i)<0&&je.call(d,i)&&(a[i]=d[i]);return a};var oe=(d,l,a)=>new Promise((i,j)=>{var g=n=>{try{b(a.next(n))}catch(c){j(c)}},h=n=>{try{b(a.throw(n))}catch(c){j(c)}},b=n=>n.done?i(n.value):Promise.resolve(n.value).then(g,h);b((a=a.apply(d,l)).next())});import{r as m,j as e,a as ce,b as ee,u as Re,d as Ge,R as Ve}from"./main-5b40e739.js";import{b as Fe,d as Ue,F as He,u as xe,a as $e,c as pe,C as qe,M as J}from"./Modal-b566b2dd.js";import{E as ze,e as Je}from"./removeClass-ffc5027a.js";import{a as de,R as ge,L as We}from"./Layout-e3187c6c.js";import{h as $}from"./moment-686b5dfa.js";import{_,I as be}from"./index-6f7cd0f9.js";import{f as ie}from"./formatting-345d2430.js";import{M as Ce}from"./MultipleUpload-3eb103cc.js";import{S as Ze}from"./search-ff4beb98.js";import{B as he}from"./Button-8d276de9.js";import{B as Xe,D as Ke}from"./DrawerContent-363972f7.js";import{S as Qe,P as De}from"./PaginationControls-5a0bd18c.js";import{A as ea,D as aa,C as ta,a as na,F as ra,P as oa}from"./Payments-8a953466.js";import{l as Se}from"./lodash-7ed354f0.js";import{A as ve}from"./index-18a0ccb1.js";import"./index-c570846a.js";import"./assertThisInitialized-3be3daa4.js";import"./Button-29eb3641.js";import"./index-ab81bb2e.js";const ue=ye(2,31)-1;function Be(d,l,a){const i=a-Date.now();d.current=i<=ue?setTimeout(l,i):setTimeout(()=>Be(d,l,a),ue)}function sa(){const d=Fe(),l=m.useRef();return Ue(()=>clearTimeout(l.current)),m.useMemo(()=>{const a=()=>clearTimeout(l.current);function i(j,g=0){d()&&(a(),g<=ue?l.current=setTimeout(j,g):Be(l,j,Date.now()+g))}return{set:i,clear:a,handleRef:l}},[])}const la={[ze]:"showing",[Je]:"showing show"},Pe=m.forwardRef((d,l)=>e.jsx(He,E(I({},d),{ref:l,transitionClasses:la})));Pe.displayName="ToastFade";const da=Pe,ca=m.createContext({onClose(){}}),Ie=ca,Ee=m.forwardRef((n,b)=>{var c=n,{bsPrefix:d,closeLabel:l="Close",closeVariant:a,closeButton:i=!0,className:j,children:g}=c,h=le(c,["bsPrefix","closeLabel","closeVariant","closeButton","className","children"]);d=xe(d,"toast-header");const s=m.useContext(Ie),O=$e(C=>{s==null||s.onClose==null||s.onClose(C)});return e.jsxs("div",E(I({ref:b},h),{className:pe(d,j),children:[g,i&&e.jsx(qe,{"aria-label":l,variant:a,onClick:O,"data-dismiss":"toast"})]}))});Ee.displayName="ToastHeader";const ia=Ee,Oe=m.forwardRef((g,j)=>{var h=g,{className:d,bsPrefix:l,as:a="div"}=h,i=le(h,["className","bsPrefix","as"]);return l=xe(l,"toast-body"),e.jsx(a,I({ref:j,className:pe(d,l)},i))});Oe.displayName="ToastBody";const ma=Oe,Me=m.forwardRef((F,y)=>{var H=F,{bsPrefix:d,className:l,transition:a=da,show:i=!0,animation:j=!0,delay:g=5e3,autohide:h=!1,onClose:b,onEntered:n,onExit:c,onExiting:s,onEnter:O,onEntering:C,onExited:t,bg:r}=H,o=le(H,["bsPrefix","className","transition","show","animation","delay","autohide","onClose","onEntered","onExit","onExiting","onEnter","onEntering","onExited","bg"]);d=xe(d,"toast");const P=m.useRef(g),R=m.useRef(b);m.useEffect(()=>{P.current=g,R.current=b},[g,b]);const L=sa(),B=!!(h&&i),S=m.useCallback(()=>{B&&(R.current==null||R.current())},[B]);m.useEffect(()=>{L.set(S,P.current)},[L,S]);const v=m.useMemo(()=>({onClose:b}),[b]),W=!!(a&&j),Z=e.jsx("div",E(I({},o),{ref:y,className:pe(d,l,r&&`bg-${r}`,!W&&(i?"show":"hide")),role:"alert","aria-live":"assertive","aria-atomic":"true"}));return e.jsx(Ie.Provider,{value:v,children:W&&a?e.jsx(a,{in:i,onEnter:O,onEntering:C,onEntered:n,onExit:c,onExiting:s,onExited:t,unmountOnExit:!0,children:Z}):Z})});Me.displayName="Toast";const we=Object.assign(Me,{Body:ma,Header:ia});function ha(d,l){const[a,i]=m.useState(d);return m.useEffect(()=>{const j=setTimeout(()=>{i(d)},l);return()=>{clearTimeout(j)}},[d,l]),a}function ua(d,l,a,i,j){const[g,h]=m.useState(!1),[b,n]=m.useState(""),[c,s]=m.useState(!1),[O,C]=m.useState({}),[t,r]=m.useState("single"),{data:o,setData:y,post:F,reset:H}=ce({identificationNumber:(a==null?void 0:a.reg_ID_Number)||"",lesseeName:(a==null?void 0:a.name)||"",lesseeAddress:(a==null?void 0:a.address)||"",rentGuarantorId:(a==null?void 0:a.rent_guarantor_id)||"",rentGuarantorIdType:(a==null?void 0:a.rent_guarantor_id_type)||"",rentGuarantorName:(a==null?void 0:a.rent_guarantor_name)||"",lesseePhone:(a==null?void 0:a.mobile)||"",leaseDetails:(a==null?void 0:a.lease_details)||"",leaseStartDate:(a==null?void 0:a.start_date)||"",leaseEndDate:(a==null?void 0:a.end_date)||"",leaseCurrency:(a==null?void 0:a.currency)||"USD",depositAmount:(a==null?void 0:a.deposit_amount)||0,leasePeriod:i||(a==null?void 0:a.lease_period),rentVariable:(a==null?void 0:a.rent_variable)||!1,depositPeriod:(a==null?void 0:a.deposit_period)||0,monthlyRental:(a==null?void 0:a.monthly_rentals)||0,paymentPeriodStart:(a==null?void 0:a.payment_period_start)||"25",paymentPeriodEnd:(a==null?void 0:a.payment_period_end)||"7",isCompany:!1,leaseId:(a==null?void 0:a.lease_id)||-1,monthOneBalance:"",monthTwoBalance:"",monthThreeBalance:"",moreThanThreeMonthsBalance:"",currentBalance:"",landlordType:a!=null&&a.agent_reg_number?"COMPANY":"INDIVIDUAL",regIdNumber:(a==null?void 0:a.agent_reg_number)||(a==null?void 0:a.agent_id),landlordName:(a==null?void 0:a.agent_name)||"",commission:Number(a!=null&&a.commission_amount&&(a==null?void 0:a.commission_amount)!=="N/A"?a==null?void 0:a.commission_amount:0),openingBalance:Number(a!=null&&a.agent_opening_balance&&(a==null?void 0:a.agent_opening_balance)!=="N/A"?a==null?void 0:a.agent_opening_balance:0)}),P=$(),R=P.clone().add(o.paymentPeriodEnd>=P.date()?0:1,"months").date(o.paymentPeriodEnd).format("DD-MMM-YY"),L=P.clone().subtract(o.paymentPeriodEnd>=P.date()?1:0,"months").date(o.paymentPeriodEnd).format("DD-MMM-YY"),B=P.clone().subtract(o.paymentPeriodEnd>=P.date()?2:1,"months").date(o.paymentPeriodEnd).format("DD-MMM-YY"),S=P.clone().subtract(o.paymentPeriodEnd>=P.date()?3:2,"months").date(o.paymentPeriodEnd).format("DD-MMM-YY"),v=ha(o.identificationNumber,500),W=m.useCallback(()=>{if(v&&v.length>=5)try{h(!0),ee.post(reverseUrl("get-user"),{identificationNumber:o.identificationNumber}).then(u=>{var x,M,Y,q,U,Q,ae,N;(x=u.data)!=null&&x.props.name?(y(E(I({},o),{lesseeName:((M=u.data)==null?void 0:M.props.name)||"",lesseeAddress:((Y=u.data)==null?void 0:Y.props.address)||"",lesseePhone:((q=u.data)==null?void 0:q.props.phone)||""})),C((Q=(U=u.data)==null?void 0:U.props)==null?void 0:Q.openingBalances)):((o.identificationNumber.length===6||o.identificationNumber.length>7)&&_.error("User not found!",{duration:4e3,id:"error-toast",icon:"❌"}),n((N=(ae=u.data)==null?void 0:ae.props)==null?void 0:N.errors)),h(!1)}).catch(u=>{_.error("Something went wrong! Please try again"),n(u)}).finally(()=>{h(!1)})}catch(u){_.error("Something went wrong! Please try again"),n(u)}},[v]);m.useEffect(()=>{l==="add"&&W()},[l,W]),m.useEffect(()=>{l==="add"&&(()=>{if(o.rentGuarantorId&&/^[\d]{8,9}[A-Za-z]{1}[\d]{2}$/.test(o.rentGuarantorId))try{h(!0),ee.post(reverseUrl("get-user"),{identificationNumber:o.rentGuarantorId}).then(x=>{var M,Y,q,U,Q;(M=x.data)!=null&&M.props.name?y(E(I({},o),{rentGuarantorName:((Y=x.data)==null?void 0:Y.props.name)||"",rentGuarantorIdType:((q=x.data)==null?void 0:q.props.identification_type)||""})):(_.error("User not found!",{duration:4e3,icon:"❌"}),n((Q=(U=x.data)==null?void 0:U.props)==null?void 0:Q.errors)),h(!1)}).catch(x=>{_.error("Something went wrong! Please try again"),n(x)}).finally(()=>{h(!1)})}catch(x){_.error("Something went wrong! Please try again"),n(x)}})()},[o.rentGuarantorId]);function Z(u){y(x=>E(I({},x),{rentGuarantorId:u.label.split(" - ")[1]}))}const D=u=>{u.target.id==="rentVariable"?y(E(I({},o),{[u.target.id]:u.target.checked})):u.target.id==="leasePeriod"?Number(u.target.value)>Number(i)?(_.error(`Lease period cannot be more than your subscription period (${i} months)`),y(E(I({},o),{[u.target.id]:i}))):y(E(I({},o),{[u.target.id]:u.target.value})):y(E(I({},o),{[u.target.id]:u.target.value}))},X=u=>oe(this,null,function*(){if(u.preventDefault(),o.lesseeName===""){_.error("Please enter a valid lessee");return}o.leaseEndDate=$(o.leaseEndDate).format("YYYY-MM-DD"),o.leaseStartDate=$(o.leaseStartDate).format("YYYY-MM-DD"),o.monthOneBalance=Number(o.monthOneBalance),o.monthTwoBalance=Number(o.monthTwoBalance),o.monthThreeBalance=Number(o.monthThreeBalance),o.moreThanThreeMonthsBalance=Number(o.moreThanThreeMonthsBalance),o.currentBalance=Number(o.currentBalance),o.monthOneDate=$(L).format("YYYY-MM-DD"),o.monthTwoDate=$(B).format("YYYY-MM-DD"),o.monthThreeDate=$(S).format("YYYY-MM-DD"),o.currentDate=$(R).format("YYYY-MM-DD"),o.monthlyRental=Number(o.monthlyRental),o.depositAmount=o.depositAmount,o.depositPeriod=Number(o.depositPeriod),o.leasePeriod=Number(o.leasePeriod),o.outStandingBalance=o.moreThanThreeMonthsBalance+o.monthThreeBalance+o.monthTwoBalance+o.monthOneBalance+o.currentBalance,F(reverseUrl("create-individual-lease"),{onStart:()=>{h(!0)},onSuccess:x=>{var Y,q,U;const M=(Y=x==null?void 0:x.props)==null?void 0:Y.flash.message;M&&((q=x==null?void 0:x.props)==null?void 0:q.flash.type)==="success"?(d(),j(M,o.lesseeName)):M&&((U=x==null?void 0:x.props)==null?void 0:U.flash.type)==="error"&&_.error(M.message),H(),h(!1)},onError:x=>{_.error(JSON.stringify(x)),n(x),h(!1)}})}),k=u=>{u.preventDefault(),o.leaseStartDate=$(o.leaseStartDate).format("YYYY-MM-DD"),o.leaseEndDate=$(o.leaseEndDate).format("YYYY-MM-DD"),F(reverseUrl("client-edit-lease"),{onStart:()=>{console.log(o),h(!0)},onSuccess:x=>{var M,Y;((M=x==null?void 0:x.props)==null?void 0:M.flash.type)==="success"?(d(),j("Lease updated successfully")):((Y=x==null?void 0:x.props)==null?void 0:Y.flash.type)==="error"&&_.error("An error occurred, please try again later"),h(!1)},onError:x=>{_.error(JSON.stringify(x)),n(x),h(!1)}})};function K(u){if(u.preventDefault,l==="add")X(u);else if(l==="edit")k(u);else throw new Error("Invalid action: "+l)}return{isSingleTab:t==="single",toggleTab:()=>{r(u=>u==="single"?"multiple":"single")},handleAddLease:X,handleUpdateLease:k,changeHandler:D,errors:b,monthThree:S,monthTwo:B,monthOne:L,currentDate:R,data:o,isLoading:g,showReceipt:c,viewReceipt:()=>s(!0),closeReceipt:()=>s(!1),handleSubmit:K,changeRentGuarantorId:Z,changeLandlordType:u=>y(x=>E(I({},x),{landlordType:u,regIdNumber:"",landlordName:""})),changeLandlord:u=>y(x=>E(I({},x),{landlordName:u.label.split(" - ")[0],regIdNumber:u.label.split(" - ")[1],landlordName:u.label.split(" - ")[0]}))}}function Te({show:d,handleClose:l,action:a,lesseeDetails:i,subscriptionPeriod:j,handleShowAlert:g}){const{isSingleTab:h,toggleTab:b,changeHandler:n,errors:c,monthThree:s,monthTwo:O,monthOne:C,currentDate:t,data:r,isLoading:o,showReceipt:y,viewReceipt:F,closeReceipt:H,handleSubmit:P,changeLandlordType:R,changeLandlord:L,changeRentGuarantorId:B}=ua(l,a,i,j,g);return e.jsxs(J,{size:"lg",show:d,onHide:l,centered:!0,children:[e.jsxs(J.Header,{closeButton:!0,className:"card-header bg-transparent ps-0",children:[e.jsx("button",{className:`btn btn-sm ${h?"btn-info text-white":"btn-light"}`,onClick:b,children:"Single"}),e.jsx("button",{className:`btn btn-sm ${h?"btn-light":"btn-info text-white"}`,onClick:b,children:"Multiple"})]}),e.jsx(J.Body,{className:"p-0",children:h?e.jsxs("div",{className:"card card-raised",children:[e.jsx("div",{className:"card-header bg-info",children:e.jsx("h2",{className:"display-6 mb-0 text-white",children:a==="view"?"View Lease - Individual":a==="edit"?"Edit Lease - Individual":"Add Lease - Individual"})}),e.jsxs("div",{className:"card-body p-4",children:[e.jsx("h6",{className:"bg-info p-1 display-6 m-0 text-center text-white",children:"Lease details"}),e.jsxs("form",{className:"p-5 border border-2 border-info",onSubmit:P,children:[e.jsxs("div",{className:"row mb-4",children:[e.jsx(be,{}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"National ID:"}),e.jsx("input",{value:r.identificationNumber,onChange:n,type:"text",required:!0,name:"identificationNumber",id:"identificationNumber",className:"form-control form-control-sm"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.identificationNumber})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lessee Name:"}),e.jsx("input",{value:r.lesseeName,onChange:n,type:"text",name:"lesseeName",required:!0,id:"lesseeName",className:"form-control form-control-sm",readOnly:!0}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.lesseeName})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lessee Mobile Number"}),e.jsx("input",{value:r.lesseePhone,onChange:n,type:"text",name:"lesseePhone",id:"lesseePhone",required:!0,className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.lesseePhone})]})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Address:"}),e.jsx("textarea",{value:r.lesseeAddress,onChange:n,type:"text",required:!!r.lesseeName,name:"lesseeAddress",id:"lesseeAddress",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.lesseeAddress})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Rent Guarantor ID:"}),e.jsx(de,{onChange:S=>B(S),extraProps:{required:!1,className:"w-100",name:"rentGuarantorId",id:"rentGuarantorId",placeholder:r.rentGuarantorId||void 0},isDisabled:a==="view",defaultValue:a==="view"?r.rentGuarantorId:"",useAlternateFetchOptions:{type:"individual"}}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.rentGuarantorId})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Rent Guarantor Name:"}),e.jsx("input",{value:r.rentGuarantorName,onChange:n,type:"text",name:"rentGuarantorName",id:"rentGuarantorName",className:"form-control form-control-sm",readOnly:!0}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.rentGuarantorName})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Details:"}),e.jsx("textarea",{value:r.leaseDetails,onChange:n,name:"leaseDetails",id:"leaseDetails",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leaseDetails})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Currency"}),e.jsxs("select",{value:r.leaseCurrency,onChange:n,id:"leaseCurrency",name:"leaseCurrency",className:"form-select form-select-sm",readOnly:a==="view",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"ZWG",children:"ZWG"})]}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leaseCurrency})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Monthly Rental:"}),e.jsx("input",{value:r.monthlyRental===0?"":r.monthlyRental,placeholder:"enter monthly rental",onChange:n,type:"text",required:!!r.lesseeName,id:"monthlyRental",name:"monthlyRental",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.monthlyRental})]}),e.jsxs("div",{className:"mt-1 col-lg-4 d-flex flex-column",children:[e.jsx("label",{className:"form-label",children:"Variable Rent:"}),e.jsx("input",{checked:r.rentVariable,onChange:n,type:"checkbox",id:"rentVariable",name:"rentVariable",className:"form-check-input border-1 p-2 border-black"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.rentVariable})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Period(Months):"}),e.jsx("input",{value:r.depositPeriod===0?"":r.depositPeriod,placeholder:"enter deposit period",onChange:n,type:"text",id:"depositPeriod",name:"depositPeriod",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.depositPeriod})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Amount:"}),e.jsx("input",{value:r.depositAmount===0?"":r.depositAmount,placeholder:"enter deposit amount",onChange:n,type:"text",name:"depositAmount",id:"depositAmount",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.depositAmount})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Subscription period left (months):"}),e.jsx("input",{value:r.leasePeriod,onChange:n,type:"number",id:"leasePeriod",name:"leasePeriod",className:"form-control form-control-sm"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leasePeriod})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Start Date:"}),e.jsx("input",{value:r.leaseStartDate,onChange:n,type:"date",required:!!r.lesseeName,name:"leaseStartDate",id:"leaseStartDate",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leaseStartDate})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease End Date:"}),e.jsx("input",{value:r.leaseEndDate,onChange:n,type:"date",name:"leaseEndDate",id:"leaseEndDate",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leaseEndDate})]}),e.jsxs("div",{className:"col-lg-4 mt-1",children:[e.jsx("label",{className:"form-label",children:"Payment Period Start Date:"}),e.jsx("input",{value:r.paymentPeriodStart,type:"number",id:"paymentPeriodStart",name:"paymentPeriodStart",className:"form-control form-control-sm",readOnly:!0,disabled:!0}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.paymentPeriodStart})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Payment Period End Date:"}),e.jsx("input",{value:r.paymentPeriodEnd,onChange:n,type:"number",min:"1",max:"31",required:!!r.lesseeName,name:"paymentPeriodEnd",id:"paymentPeriodEnd",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.paymentPeriodEnd})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-center p-2 fw-bolder h6 custom-bg-grey",children:"Estate Agents Section"}),e.jsxs("div",{className:"row align-items-center",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Landlord Type:"}),e.jsxs("select",{className:"form-select form-select-md",name:"landlordType",id:"landlordType",value:r.landlordType,disabled:a==="view"||a==="edit",onChange:S=>R(S.target.value),children:[e.jsx("option",{value:"INDIVIDUAL",children:"Individual"}),e.jsx("option",{value:"COMPANY",children:"Company"})]}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.landlordType})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsxs("label",{htmlFor:"regIdNumber",className:"form-label",children:[r.landlordType==="COMPANY"?"Reg Number":"ID"," (or Name)",":"]}),e.jsx(de,{onChange:S=>L(S),extraProps:{required:!1,id:"regIdNumber",className:"w-100",name:"regIdNumber",placeholder:(r.regIdNumber||r.landlordName)&&(r.regIdNumber||" - "+r.landlordName)||""},defaultValue:r.regIdNumber?r.regIdNumber:"",isDisabled:a==="view"||a==="edit"||r.landlordType==="",useAlternateFetchOptions:{type:r.landlordType.toLowerCase()}},r.landlordType),c&&e.jsx("div",{className:"text-danger mt-1",children:c.idRegOrName})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{htmlFor:"landlordName",className:"form-label",children:"Landlord Name"}),e.jsx("input",{value:r.landlordName,name:"landlordName",id:"landlordName",className:"form-control form-control-md custom-no-pointer-events border border-2",readOnly:!0}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.landlordName})]}),e.jsxs("div",{className:"mt-2 col-lg-4",children:[e.jsx("label",{htmlFor:"commission",className:"form-label",children:"Commission %"}),e.jsx("input",{value:r.commission,onChange:n,type:"number",min:0,max:100,name:"commission",id:"commission",className:"form-control form-control-sm",disabled:a==="view"||a==="edit"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.commission})]}),e.jsxs("div",{className:"mt-2 col-lg-4",children:[e.jsx("label",{htmlFor:"openingBalance",className:"form-label",children:"Landlord Opening Balance"}),e.jsx("input",{value:r.openingBalance,onChange:n,type:"number",min:0,name:"openingBalance",id:"openingBalance",className:"form-control form-control-sm",disabled:a==="view"||a==="edit"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.openingBalance})]})]})]}),a==="add"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-center p-2 fw-bolder h6 custom-bg-grey",children:"Tenant Opening Rent Balances"}),e.jsx("table",{className:"table table-responsive table-bordered",children:e.jsxs("tbody",{children:[e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",style:{lineHeight:"15px"},children:"Payment Date"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:"More than 3 months"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:s}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:O}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:C}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:t}),e.jsx("td",{className:"fw-bold",style:{lineHeight:"15px"},children:"Outstanding Balance"})]}),e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",children:"Amount"}),e.jsx("td",{className:"bg-black text-white",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"moreThanThreeMonthsBalance",name:"moreThanThreeMonthsBalance",onChange:n,value:r.moreThanThreeMonthsBalance})}),e.jsx("td",{className:"text-white bg-danger",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthThreeBalance",name:"monthThreeBalance",onChange:n,value:r.monthThreeBalance})}),e.jsx("td",{className:"text-white custom-bg-pink",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthTwoBalance",name:"monthTwoBalance",onChange:n,value:r.monthTwoBalance})}),e.jsx("td",{className:"text-white bg-warning",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthOneBalance",name:"monthOneBalance",onChange:n,value:r.monthOneBalance})}),e.jsx("td",{className:"text-white bg-success",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"currentBalance",name:"currentBalance",onChange:n,value:r.currentBalance})}),e.jsx("td",{className:`text-white d-flex align-items-center justify-content-center py-4 my-auto ${Number(r.moreThanThreeMonthsBalance)>0?"bg-black":Number(r.monthThreeBalance)>0?"bg-danger":Number(r.monthTwoBalance)>0?"custom-bg-pink":Number(r.monthOneBalance)>0?"bg-warning":"bg-success"}`,style:{backgroundColor:Number(r.monthTwoBalance)>0?"#f87171":""},children:ie(Number(r.moreThanThreeMonthsBalance)+Number(r.monthThreeBalance)+Number(r.monthTwoBalance)+Number(r.monthOneBalance)+Number(r.currentBalance)||0)})]})]})})]}),e.jsx("div",{className:"d-flex justify-content-end align-items-center gap-3",children:a==="view"?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-info text-white",onClick:F,children:"Receipt"}),e.jsx("button",{className:"btn btn-success",onClick:l,children:"Edit"}),e.jsx("button",{className:"btn btn-danger",onClick:l,children:"Terminate"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Cancel"}),e.jsx("button",{className:"btn btn-info text-white",type:"submit",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"d-inline-block ml-2",children:"processing.."})]}):"Submit"})]})})]}),e.jsx(ge,{show:y,handleClose:H})]})]}):e.jsx(Ce,{type:"individual",actionType:"lease"})})]})}function xa(d,l,a,i,j){const[g,h]=m.useState(!1),[b,n]=m.useState("single"),[c,s]=m.useState(""),[O,C]=m.useState(!1),{data:t,setData:r,post:o,reset:y}=ce({identificationNumber:(a==null?void 0:a.reg_ID_Number)||"",lesseeName:(a==null?void 0:a.name)||"",lesseeAddress:(a==null?void 0:a.address)||"",mobile:(a==null?void 0:a.mobile)||"",email:(a==null?void 0:a.email)||"",rentGuarantorId:(a==null?void 0:a.rent_guarantor_id)||"",rentGuarantorIdType:(a==null?void 0:a.rent_guarantor_id_type)||"",rentGuarantorName:(a==null?void 0:a.rent_guarantor_name)||"",leaseDetails:(a==null?void 0:a.lease_details)||"",leaseStartDate:(a==null?void 0:a.start_date)||"",rentVariable:(a==null?void 0:a.rent_variable)||!1,leaseEndDate:(a==null?void 0:a.end_date)||"",leaseCurrency:(a==null?void 0:a.currency)||"USD",depositAmount:(a==null?void 0:a.deposit_amount)||0,leasePeriod:i||(a==null?void 0:a.lease_period),depositPeriod:(a==null?void 0:a.deposit_period)||0,monthlyRental:(a==null?void 0:a.monthly_rentals)||0,paymentPeriodStart:(a==null?void 0:a.payment_period_start)||"25",paymentPeriodEnd:(a==null?void 0:a.payment_period_end)||"7",isCompany:!0,leaseId:(a==null?void 0:a.lease_id)||-1,monthOneBalance:"",monthTwoBalance:"",monthThreeBalance:"",moreThanThreeMonthsBalance:"",currentBalance:"",isGovernment:!1,accountNumber:a.customer_number||"",landlordType:a!=null&&a.agent_reg_number?"COMPANY":"INDIVIDUAL",regIdNumber:(a==null?void 0:a.agent_reg_number)||(a==null?void 0:a.agent_id),landlordName:(a==null?void 0:a.agent_name)||"",commission:Number(a!=null&&a.commission_amount&&(a==null?void 0:a.commission_amount)!=="N/A"?a==null?void 0:a.commission_amount:0),openingBalance:Number(a!=null&&a.agent_opening_balance&&(a==null?void 0:a.agent_opening_balance)!=="N/A"?a==null?void 0:a.agent_opening_balance:0)}),[F,H]=m.useState(l==="edit"?t.lesseeName:""),[P,R]=m.useState(t.lesseeName),[L,B]=m.useState(t.email),[S,v]=m.useState(t.identificationNumber),[W,Z]=m.useState(t.mobile),[D,X]=m.useState(t.lesseeAddress),k=$(),K=k.clone().add(t.paymentPeriodEnd>=k.date()?0:1,"months").date(t.paymentPeriodEnd).format("DD-MMM-YY"),u=k.clone().subtract(t.paymentPeriodEnd>=k.date()?1:0,"months").date(t.paymentPeriodEnd).format("DD-MMM-YY"),x=k.clone().subtract(t.paymentPeriodEnd>=k.date()?2:1,"months").date(t.paymentPeriodEnd).format("DD-MMM-YY"),M=k.clone().subtract(t.paymentPeriodEnd>=k.date()?3:2,"months").date(t.paymentPeriodEnd).format("DD-MMM-YY");m.useEffect(()=>{r(E(I({},t),{lesseeName:P,email:L,identificationNumber:String(S),mobile:W,lesseeAddress:D}))},[S,P,L,W,D]),m.useEffect(()=>{l==="add"&&(()=>{if(t.rentGuarantorId&&/^[\d]{8,9}[A-Za-z]{1}[\d]{2}$/.test(t.rentGuarantorId))try{h(!0),ee.post(reverseUrl("get-user"),{identificationNumber:t.rentGuarantorId}).then(f=>{var p,z,G,te,re;(p=f.data)!=null&&p.props.name?r(E(I({},t),{rentGuarantorName:((z=f.data)==null?void 0:z.props.name)||"",rentGuarantorIdType:((G=f.data)==null?void 0:G.props.identification_type)||""})):(_.error("User not found!",{duration:4e3,icon:"❌"}),s((re=(te=f.data)==null?void 0:te.props)==null?void 0:re.errors)),h(!1)}).catch(f=>{_.error("Something went wrong! Please try again"),s(f)}).finally(()=>{h(!1)})}catch(f){_.error("Something went wrong! Please try again"),s(f)}})()},[t.rentGuarantorId]);const Y=N=>{N.target.id==="rentVariable"?r(E(I({},t),{[N.target.id]:N.target.checked})):N.target.id==="leasePeriod"?Number(N.target.value)>Number(i)?(_.error(`Lease period cannot be more than your subscription period (${i} months)`),r(E(I({},t),{[N.target.id]:i}))):r(E(I({},t),{[N.target.id]:N.target.value})):r(E(I({},t),{[N.target.id]:N.target.value}))},q=N=>oe(this,null,function*(){if(N.preventDefault(),!t.lesseeName){_.error("Please add a valid lessee");return}h(!0),t.leaseEndDate=$(t.leaseEndDate).format("YYYY-MM-DD"),t.monthOneBalance=Number(t.monthOneBalance),t.monthTwoBalance=Number(t.monthTwoBalance),t.monthThreeBalance=Number(t.monthThreeBalance),t.moreThanThreeMonthsBalance=Number(t.moreThanThreeMonthsBalance),t.currentBalance=Number(t.currentBalance),t.monthOneDate=$(u).format("YYYY-MM-DD"),t.monthTwoDate=$(x).format("YYYY-MM-DD"),t.monthThreeDate=$(M).format("YYYY-MM-DD"),t.currentDate=$(K).format("YYYY-MM-DD"),t.monthlyRental=Number(t.monthlyRental),t.depositAmount=t.depositAmount,t.depositPeriod=Number(t.depositPeriod),t.leasePeriod=Number(t.leasePeriod),t.outStandingBalance=t.moreThanThreeMonthsBalance+t.monthThreeBalance+t.monthTwoBalance+t.monthOneBalance+t.currentBalance,o(reverseUrl("create-company-lease"),{onStart:()=>{h(!0)},onSuccess:f=>{var z,G,te;const p=(z=f==null?void 0:f.props)==null?void 0:z.flash.message;p&&((G=f==null?void 0:f.props)==null?void 0:G.flash.type)==="success"?(d(),y(),j(p,t.lesseeName)):p&&((te=f==null?void 0:f.props)==null?void 0:te.flash.type)==="error"&&_.error(p.message),h(!1)},onError:f=>{_.error(JSON.stringify(f)),s(f),h(!1)}})}),U=N=>{N.preventDefault(),t.leaseStartDate=$(t.leaseStartDate).format("YYYY-MM-DD"),t.leaseEndDate=$(t.leaseEndDate).format("YYYY-MM-DD"),o(reverseUrl("client-edit-lease"),{onStart:()=>{console.log(t),h(!0)},onSuccess:f=>{var p,z;((p=f==null?void 0:f.props)==null?void 0:p.flash.type)==="success"?(d(),j("Lease updated successfully")):((z=f==null?void 0:f.props)==null?void 0:z.flash.type)==="error"&&_.error("An error occurred, please try again"),h(!1)},onError:f=>{_.error(JSON.stringify(f)),s(f),h(!1)}})};function Q(N){if(N.preventDefault,l==="add")q(N);else if(l==="edit")U(N);else throw new Error("Invalid action: "+l)}function ae(N){r(f=>E(I({},f),{rentGuarantorId:N.label.split(" - ")[1]}))}return{isSingleTab:b==="single",isLoading:g,errors:c,showReceipt:O,data:t,value:F,currentDate:K,monthOne:u,monthTwo:x,monthThree:M,handleSubmit:Q,toggleTab:()=>{n(N=>N==="single"?"multiple":"single")},viewReceipt:()=>C(!0),closeReceipt:()=>C(!1),setValue:H,setClientName:R,setClientId:v,setMobileNo:Z,setRegNumber:B,setAddress:X,changeHandler:Y,changeLandlordType:N=>r(f=>E(I({},f),{landlordType:N,regIdNumber:"",landlordName:""})),changeLandlord:N=>r(f=>E(I({},f),{landlordName:N.label.split(" - ")[0],regIdNumber:N.label.split(" - ")[1],landlordName:N.label.split(" - ")[0]})),changeRentGuarantorId:ae,toggleIsGovernment:()=>r(N=>E(I({},N),{isGovernment:!N.isGovernment}))}}const pa=({show:d,handleClose:l,action:a,lesseeDetails:i,subscriptionPeriod:j,handleShowAlert:g})=>{const{isLoading:h,isSingleTab:b,errors:n,showReceipt:c,data:s,value:O,currentDate:C,monthOne:t,monthTwo:r,monthThree:o,handleSubmit:y,toggleTab:F,setValue:H,setClientName:P,setClientId:R,setMobileNo:L,setRegNumber:B,setAddress:S,changeHandler:v,viewReceipt:W,closeReceipt:Z,changeLandlordType:D,changeLandlord:X,toggleIsGovernment:k,changeRentGuarantorId:K}=xa(l,a,i,j,g);return e.jsxs(J,{size:"lg",show:d,onHide:l,centered:!0,children:[e.jsxs(J.Header,{closeButton:!0,className:"card-header bg-transparent ps-0",children:[e.jsx("button",{className:`btn btn-sm ${b?"btn-info text-white":"btn-light"}`,onClick:F,children:"Single"}),e.jsx("button",{className:`btn btn-sm ${b?"btn-light":"btn-info text-white"}`,onClick:F,children:"Multiple"})]}),e.jsx(J.Body,{className:"p-0",children:b?e.jsxs("div",{className:"card card-raised",children:[e.jsx("div",{className:"card-header bg-info",children:e.jsx("h2",{className:"display-6 mb-0 text-white",children:a==="view"?"View Lease - Company":a==="edit"?"Edit Lease - Company":"Add Lease - Company"})}),e.jsxs("div",{className:"card-body p-4",children:[e.jsx("h6",{className:"bg-info p-1 display-6 m-0 text-center text-white",children:"Lease details"}),e.jsxs("form",{className:"p-5 border border-2 border-info",onSubmit:y,children:[e.jsxs("div",{className:"row mb-4",children:[e.jsx(be,{}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Company Name:"}),e.jsx(Ze,{from:"leases",delay:500,placeholder:"Company Name",value:O,setValue:H,url:reverseUrl("get_searched_companies"),type:"company",setAddress:S,setClientName:P,setRegNumber:B,setClientId:R,setMobileNo:L}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.identificationNumber})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Account Number:"}),e.jsx("input",{value:s.accountNumber,onChange:v,type:"text",name:"accountNumber",id:"accountNumber",className:"form-control form-control-sm",readOnly:a==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.accountNumber})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lessee Name:"}),e.jsx("input",{value:s.lesseeName,onChange:v,type:"text",name:"lesseeName",readOnly:!0,required:!0,id:"lesseeName",className:"form-control form-control-sm"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.lesseeName})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Email:"}),e.jsx("input",{value:s.email,onChange:v,type:"text",name:"email",required:!0,id:"email",className:"form-control form-control-sm",readOnly:a==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.email})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Mobile:"}),e.jsx("input",{value:s.mobile,onChange:v,type:"text",name:"mobile",required:!0,id:"mobile",className:"form-control form-control-sm",readOnly:a==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.mobile})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Rent Guarantor ID:"}),e.jsx(de,{onChange:u=>K(u),extraProps:{required:!1,className:"w-100",name:"rentGuarantorId",id:"rentGuarantorId",placeholder:s.rentGuarantorId||void 0},isDisabled:a==="view",defaultValue:a==="view"?s.rentGuarantorId:"",useAlternateFetchOptions:{type:"individual"}}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.rentGuarantorId})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Rent Guarantor Name:"}),e.jsx("input",{value:s.rentGuarantorName,onChange:v,type:"text",name:"rentGuarantorName",id:"rentGuarantorName",className:"form-control form-control-sm",readOnly:!0}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.rentGuarantorName})]}),e.jsxs("div",{className:"mt-1 col-lg-4 d-flex flex-column",children:[e.jsx("label",{htmlFor:"isGovernment",className:"form-label",children:"Government:"}),e.jsx("input",{checked:s.isGovernment,onChange:k,type:"checkbox",id:"isGovernment",name:"isGovernment",className:"form-check-input border-1 p-2 border-black",readOnly:a==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.isGovernment})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Address:"}),e.jsx("textarea",{value:s.lesseeAddress,onChange:v,type:"text",required:!!s.lesseeName,name:"lesseeAddress",id:"lesseeAddress",className:"form-control form-control-sm",readOnly:a==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.lesseeAddress})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Details:"}),e.jsx("textarea",{value:s.leaseDetails,onChange:v,type:"text",name:"leaseDetails",id:"leaseDetails",className:"form-control form-control-sm",readOnly:a==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.leaseDetails})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Currency"}),e.jsxs("select",{value:s.leaseCurrency,onChange:v,id:"leaseCurrency",name:"leaseCurrency",className:"form-select form-select-sm",readOnly:a==="view",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"ZWG",children:"ZWG"})]}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.leaseCurrency})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Monthly Rental:"}),e.jsx("input",{value:s.monthlyRental===0?"":s.monthlyRental,placeholder:"enter monthly rental",onChange:v,type:"text",required:!!s.lesseeName,id:"monthlyRental",name:"monthlyRental",className:"form-control form-control-sm",readOnly:a==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.monthlyRental})]}),e.jsxs("div",{className:"mt-1 col-lg-4 d-flex flex-column",children:[e.jsx("label",{className:"form-label",children:"Variable Rent:"}),e.jsx("input",{checked:s.rentVariable,onChange:v,type:"checkbox",id:"rentVariable",name:"rentVariable",className:"form-check-input border-1 p-2 border-black",readOnly:a==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.rentVariable})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Period(Months):"}),e.jsx("input",{value:s.depositPeriod===0?"":s.depositPeriod,placeholder:"enter deposit period",onChange:v,type:"text",id:"depositPeriod",name:"depositPeriod",className:"form-control form-control-sm",readOnly:a==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.depositPeriod})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Amount:"}),e.jsx("input",{value:s.depositAmount===0?"":s.depositAmount,placeholder:"enter deposit amount",onChange:v,type:"text",name:"depositAmount",id:"depositAmount",className:"form-control form-control-sm",readOnly:a==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.depositAmount})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Subscription period left (months):"}),e.jsx("input",{value:s.leasePeriod,onChange:v,type:"number",id:"leasePeriod",name:"leasePeriod",className:"form-control form-control-sm"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.leasePeriod})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Start Date:"}),e.jsx("input",{value:s.leaseStartDate,onChange:v,type:"date",name:"leaseStartDate",required:!!s.lesseeName,id:"leaseStartDate",className:"form-control form-control-sm",readOnly:a==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.leaseStartDate})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease End Date:"}),e.jsx("input",{value:s.leaseEndDate,onChange:v,type:"date",name:"leaseEndDate",id:"leaseEndDate",className:"form-control form-control-sm",readOnly:a==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.leaseEndDate})]}),e.jsxs("div",{className:"col-lg-4 mt-1",children:[e.jsx("label",{className:"form-label",children:"Payment Period Start Date:"}),e.jsx("input",{value:s.paymentPeriodStart,onChange:v,type:"number",id:"paymentPeriodStart",name:"paymentPeriodStart",className:"form-control form-control-sm",readOnly:!0,disabled:!0}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.paymentPeriodStart})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Payment Period End Date:"}),e.jsx("input",{value:s.paymentPeriodEnd,onChange:v,min:"1",max:"31",type:"number",required:!!s.lesseeName,name:"paymentPeriodEnd",id:"paymentPeriodEnd",className:"form-control form-control-sm",readOnly:a==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.paymentPeriodEnd})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-center p-2 fw-bolder h6 custom-bg-grey",children:"Estate Agents Section"}),e.jsxs("div",{className:"row align-items-center",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Landlord Type:"}),e.jsxs("select",{className:"form-select form-select-md",name:"landlordType",id:"landlordType",value:s.landlordType,disabled:a==="view"||a==="edit",onChange:u=>D(u.target.value),children:[e.jsx("option",{value:"INDIVIDUAL",children:"Individual"}),e.jsx("option",{value:"COMPANY",children:"Company"})]}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.landlordType})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsxs("label",{htmlFor:"regIdNumber",className:"form-label",children:[s.landlordType==="COMPANY"?"Reg Number":"ID"," (or Name)",":"]}),e.jsx(de,{onChange:u=>X(u),extraProps:{required:!1,id:"regIdNumber",className:"w-100",name:"regIdNumber",placeholder:(s.regIdNumber||s.landlordName)&&(s.regIdNumber||" - "+s.landlordName)||""},defaultValue:s.regIdNumber?s.regIdNumber:"",isDisabled:a==="view"||a==="edit"||s.landlordType==="",useAlternateFetchOptions:{type:s.landlordType.toLowerCase()}},s.landlordType),n&&e.jsx("div",{className:"text-danger mt-1",children:n.regIdNumber})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{htmlFor:"landlordName",className:"form-label",children:"Landlord Name"}),e.jsx("input",{value:s.landlordName,name:"landlordName",id:"landlordName",className:"form-control form-control-md custom-no-pointer-events border border-2",readOnly:!0}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.landlordName})]}),e.jsxs("div",{className:"mt-2 col-lg-4",children:[e.jsx("label",{htmlFor:"commission",className:"form-label",children:"Commission %"}),e.jsx("input",{value:s.commission,onChange:v,type:"number",min:0,max:100,name:"commission",id:"commission",className:"form-control form-control-sm",disabled:a==="view"||a==="edit"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.commission})]}),e.jsxs("div",{className:"mt-2 col-lg-4",children:[e.jsx("label",{htmlFor:"openingBalance",className:"form-label",children:"Landlord Opening Balance"}),e.jsx("input",{value:s.openingBalance,onChange:v,type:"number",min:0,name:"openingBalance",id:"openingBalance",className:"form-control form-control-sm",disabled:a==="view"||a==="edit"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.openingBalance})]})]})]}),a==="add"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-center p-2 fw-bolder h6 custom-bg-grey",children:"Tenant Opening Rent Balances"}),e.jsx("table",{className:"table table-responsive table-bordered",children:e.jsxs("tbody",{children:[e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",style:{lineHeight:"15px"},children:"Payment Date"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:"More than 3 months"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:o}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:r}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:t}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:C}),e.jsx("td",{className:"fw-bold",style:{lineHeight:"15px"},children:"Outstanding Balance"})]}),e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",children:"Amount"}),e.jsx("td",{className:"bg-black text-white",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"moreThanThreeMonthsBalance",name:"moreThanThreeMonthsBalance",onChange:v,value:s.moreThanThreeMonthsBalance})}),e.jsx("td",{className:"text-white bg-danger",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthThreeBalance",name:"monthThreeBalance",onChange:v,value:s.monthThreeBalance})}),e.jsx("td",{className:"text-white custom-bg-pink",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthTwoBalance",name:"monthTwoBalance",onChange:v,value:s.monthTwoBalance})}),e.jsx("td",{className:"text-white bg-warning",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthOneBalance",name:"monthOneBalance",onChange:v,value:s.monthOneBalance})}),e.jsx("td",{className:"text-white bg-success",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"currentBalance",name:"currentBalance",onChange:v,value:s.currentBalance})}),e.jsx("td",{className:`text-white text-end h-100 d-flex align-items-center justify-content-center py-4 my-auto ${Number(s.moreThanThreeMonthsBalance)>0?"bg-black":Number(s.monthThreeBalance)>0?"bg-danger":Number(s.monthTwoBalance)>0?"custom-bg-pink":Number(s.monthOneBalance)>0?"bg-warning":"bg-success"}`,style:{backgroundColor:Number(s.monthTwoBalance)>0?"#f87171":""},children:ie(Number(s.moreThanThreeMonthsBalance)+Number(s.monthThreeBalance)+Number(s.monthTwoBalance)+Number(s.monthOneBalance)+Number(s.currentBalance)||0)})]})]})})]}),e.jsx("div",{className:"d-flex justify-content-end align-items-center gap-3",children:a==="view"?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-info text-white",onClick:W,children:"Receipt"}),e.jsx("button",{className:"btn btn-success",onClick:l,children:"Edit"}),e.jsx("button",{className:"btn btn-danger",onClick:l,children:"Terminate"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Cancel"}),e.jsx("button",{className:"btn btn-info text-white",type:"submit",disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"d-inline-block ml-2",children:"processing.."})]}):"Submit"})]})})]}),e.jsx(ge,{show:c,handleClose:Z})]})]}):e.jsx(Ce,{type:"company",actionType:"lease"})})]})},_e=pa,ga=({show:d,handleClose:l,handleShowAlert:a,leaseData:i})=>{const[j,g]=m.useState(!1),{data:h,post:b}=ce({leaseId:i.lease_id}),n=()=>{b(reverseUrl("delete_lease"),{onStart:()=>{g(!0)},onSuccess:c=>{a("Lease terminated successfully"),g(!1)},onError:c=>{_.error("Something went wrong! Please try again"),g(!1)},onFinish:()=>{l()}})};return e.jsxs(J,{show:d,onHide:l,size:"md",backdrop:"static",centered:!0,children:[e.jsx(J.Header,{closeButton:!0,className:"h4 bg-info text-white text-center text-uppercase",children:"Confirm Lease Termination"}),e.jsxs(J.Body,{className:"p-4 d-flex justify-content-between align-items-center gap-4",children:[e.jsx(be,{}),e.jsxs("p",{className:"my-3 text-center",children:["Are you sure you want to terninate lease for ",i.name,"? This action cannot be undone."]})]}),e.jsxs(J.Footer,{className:"p-4 d-flex justify-content-end gap-4",children:[e.jsxs(he,{onClick:l,variant:"secondary",children:[e.jsx("i",{className:"material-icons",children:"cancel"}),"Cancel"]}),e.jsxs(he,{onClick:n,variant:"danger",children:[e.jsx("i",{className:"material-icons",children:"done"}),"Delete"]})]})]})},ba=ga;function Na({clientViewProps:{showModal:d,hideClientView:l,data:a,error:i,isLoading:j,clientId:g,refreshClientViewData:h,lease:b}}){const n=!a;return e.jsx(e.Fragment,{children:e.jsxs(J,{show:d,onHide:l,fullscreen:!0,contentClassName:"custom-bg-whitesmoke",children:[e.jsx(J.Header,{className:"p-0",children:e.jsxs("div",{className:"w-100 p-2 text-center bg-info position-relative",children:[e.jsx("h4",{className:"text-white",children:j||i||n?"Client View":a.tenantName}),e.jsx("button",{type:"button",onClick:l,className:"btn position-absolute top-0 end-0 h-100 d-flex align-items-center text-white",children:e.jsx("i",{className:"material-icons fs-3 px-4",children:"close"})})]})}),e.jsx(J.Body,{children:e.jsxs("div",{className:"position-relative custom-mn-h-5",children:[j&&e.jsxs("div",{className:"text-center position-absolute top-50 start-50 translate-middle",children:[e.jsx("div",{className:"spinner-border text-info spinner-border-md",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{children:"Loading...please wait"})]}),i&&e.jsxs("div",{className:"text-center text-danger position-absolute top-50 start-50 translate-middle",children:[e.jsx("p",{children:e.jsx("i",{className:"material-icons fs-1",children:"warning"})}),e.jsxs("p",{children:["Error: ",Se.truncate(i,{length:500})]})]}),!(j||i||n)&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"row row-cols-3 align-items-stretch",children:[e.jsxs("div",{className:"col p-1",children:[e.jsx(ea,{data:a.agedAnalysis}),e.jsx(aa,{data:a.debtorIntelligence,clientId:g}),e.jsx(ta,{data:a.contactDetails,clientId:g})]}),e.jsx("div",{className:"col p-1",children:e.jsx(na,{messages:a.communicationHistory,clientId:g,lease:b})}),e.jsxs("div",{className:"col p-1",children:[e.jsx(ra,{data:a.forecastInflows}),e.jsx(oa,{clientId:g,paymentPlans:a.paymentPlans,refreshClientViewData:h})]})]})})]})})]})})}function fa(){const[d,l]=m.useState(!1),[a,i]=m.useState(null),[j,g]=m.useState(""),[h,b]=m.useState(!1),[n,c]=m.useState(null);function s(t){c(t),l(!0),b(!0),g(""),ee(reverseUrl("client_details"),{params:{lease_id:t.lease_id}}).then(r=>{const o={tenantName:t.name,agedAnalysis:{oneTwentyDays:r.data.aged_analysis["120_days_plus"],ninetyDays:r.data.aged_analysis["90_days"],sixtyDays:r.data.aged_analysis["60_days"],thirtyDays:r.data.aged_analysis["30_days"],current:r.data.aged_analysis.current},contactDetails:{contactPerson:`${r.data.client.firstname} ${r.data.client.surname}`,smsNumber:r.data.client.sms_number,otherNumbers:r.data.other_numbers?r.data.client.other_numbers.join(", "):"",emailAddress:r.data.client.email,address:r.data.client.address},paymentPlans:r.data.payment_plans.map(y=>({id:y.id,person:y.spoke_with,date:y.expected_pay_date,amount:y.amount})),communicationHistory:r.data.communication_history.map(y=>({text:y.message,timestamp:y.created_at,user:y.user_name,actionDone:y.action_done?y.action_done:null,communicationType:y.type})),debtorIntelligence:Object.values(r.data.debtor_intelligence).length&&Object.values(r.data.debtor_intelligence).every(Boolean)?{text:r.data.debtor_intelligence.note,timestamp:r.data.debtor_intelligence.updated_at,user:r.data.debtor_intelligence.user_name}:null,forecastInflows:{zeroToSevenDays:r.data.forecast_inflows["0-7"],eightToFourteenDays:r.data.forecast_inflows["8-14"],fourteenToTwentyOneDays:r.data.forecast_inflows["14-21"],twentyOnePlusDays:r.data.forecast_inflows["21+"],total:r.data.forecast_inflows.total}};console.log({res:r,resData:o}),i(o),g(""),b(!1)}).catch(r=>{r instanceof ve?g(r.response.status===500?`Error: ${r.response.statusText}`:JSON.stringify(r.response.data)):g(r),i(null),b(!1)})}function O(){console.log("refreshing.."),b(!0),g(""),ee(reverseUrl("client_details"),{params:{lease_id:n.lease_id}}).then(t=>{const r={tenantName:n.name,agedAnalysis:{oneTwentyDays:t.data.aged_analysis["120_days_plus"],ninetyDays:t.data.aged_analysis["90_days"],sixtyDays:t.data.aged_analysis["60_days"],thirtyDays:t.data.aged_analysis["30_days"],current:t.data.aged_analysis.current},contactDetails:{contactPerson:`${t.data.client.firstname} ${t.data.client.surname}`,smsNumber:t.data.client.sms_number,otherNumbers:t.data.other_numbers?t.data.client.other_numbers.join(", "):"",emailAddress:t.data.client.email,address:t.data.client.address},paymentPlans:t.data.payment_plans.map(o=>({id:o.id,person:o.spoke_with,date:o.expected_pay_date,amount:o.amount})),communicationHistory:t.data.communication_history.map(o=>({text:o.message,timestamp:o.created_at,user:o.user_name,actionDone:o.action_done?o.action_done:null,communicationType:o.type})),debtorIntelligence:Object.values(t.data.debtor_intelligence).length&&Object.values(t.data.debtor_intelligence).every(Boolean)?{text:t.data.debtor_intelligence.note,timestamp:t.data.debtor_intelligence.updated_at,user:t.data.debtor_intelligence.user_name}:null,forecastInflows:{zeroToSevenDays:t.data.forecast_inflows["0-7"],eightToFourteenDays:t.data.forecast_inflows["8-14"],fourteenToTwentyOneDays:t.data.forecast_inflows["14-21"],twentyOnePlusDays:t.data.forecast_inflows["21+"],total:t.data.forecast_inflows.total}};i(r),g(""),b(!1)}).catch(t=>{t instanceof ve?g(t.response.status===500?`Error: ${t.response.statusText}`:JSON.stringify(t.response.data)):g(t),i(null),b(!1)})}function C(){l(!1)}return{showModal:d,openClientView:s,hideClientView:C,data:a,error:j,isLoading:h,clientId:n?n.id:null,refreshClientViewData:O,lease:n}}function ja(d){const{props:{error:l},url:a}=Re();let i=new URL(a).searchParams.get("color");const[j,g]=m.useState(!1),[h,b]=m.useState(!1),[n,c]=m.useState({}),[s,O]=m.useState([]),[C,t]=m.useState({}),[r,o]=m.useState(!1),[y,F]=m.useState(!1),[H,P]=m.useState(0),[R,L]=m.useState(!1),[B,S]=m.useState(!1),[v,W]=m.useState(""),[Z,D]=m.useState(!1),[X,k]=m.useState(!1),[K,u]=m.useState(""),[x,M]=m.useState(""),[Y,q]=m.useState(i?"rent-owing-des":"default"),U=fa(),Q=(T,w)=>{k(!0),M(w),u(T)},ae=()=>{k(!1),M(""),u("")};m.useEffect(()=>{ee.post(reverseUrl("open_subscription")).then(T=>{O(T.data)}).catch(T=>{})},[O]);const N=document.getElementById("hide-footer");switch(m.useEffect(()=>(N!==null&&document.getElementById("footer").classList.add("d-none"),()=>{N!==null&&document.getElementById("footer").classList.remove("d-none")}),[N]),i){case"orange":i="warning";break;case"black":i="black";break;case"red":i="red";break;case"green":i="success";break;case"#991b1b":i="danger";break}l&&_.error(l);function f(T){q(T.target.value)}let p=T=>T;function z(T){console.log(T),ee.post(reverseUrl("write-off"),{lease_id:T.lease_id}).then(w=>{console.log(w),Ge.Inertia.reload()}).catch(w=>{var A,ne;console.log(w);const V=(ne=(A=w==null?void 0:w.response)==null?void 0:A.data)!=null&&ne.errors?JSON.stringify(w.response.data.errors):JSON.stringify(w);_.error(`An error occured:
`+Se.truncate(V,{length:200}))})}switch(Y){case"rent-owing-asc":p=T=>{const w=[...T];return w.sort((V,A)=>V.owing_amount-A.owing_amount),w};break;case"rent-owing-des":p=T=>{const w=[...T];return w.sort((V,A)=>A.owing_amount-V.owing_amount),w};break;case"color-asc":p=T=>{const w={};T.forEach(A=>{A.color in w?w[A.color].push(A):w[A.color]=[A]});let V=[];return Object.keys(w).forEach(A=>{V=V.concat(w[A].sort((ne,me)=>ne.owing_amount-me.owing_amount))}),V};break;case"color-des":p=T=>{const w={};T.forEach(A=>{A.color in w?w[A.color].push(A):w[A.color]=[A]});let V=[];return Object.keys(w).forEach(A=>{V=V.concat(w[A].sort((ne,me)=>me.owing_amount-ne.owing_amount))}),V};break;default:p=T=>T;break}const[G,te]=m.useState({});m.useEffect(()=>{ee.get(reverseUrl("rate_setup")).then(T=>{var V;const w=(V=T==null?void 0:T.data)==null?void 0:V.currency_settings;if(!w)throw new Error("failed to fetch currency settings");te(w)}).catch(T=>{console.log(T)})},[]);const re=Object.keys(G).length===0,Ae=re?"":`${G==null?void 0:G.base_currency.toUpperCase()} ${ie(d?d.reduce((T,w)=>{let V=w.owing_amount;return w.currency.trim().toLowerCase()!==(G==null?void 0:G.base_currency.trim().toLowerCase())&&(V=w.owing_amount/(G==null?void 0:G.current_rate)),T+V},0):0).replace("$","")}`;return{rateText:!re&&d&&d.find(T=>T.currency.trim().toLowerCase()!=="usd")?`${G.base_currency.toUpperCase()} 1 = ${G.currency.toUpperCase()} ${G.current_rate}`:"",smartNavigationTotalFormated:Ae,totalColor:i,writeOff:z,btnAdd:j,setBtnAdd:g,editBtn:h,setEditBtn:b,details:n,setDetails:c,subscriptions:s,setSubscriptions:O,subscription:C,setSubscription:t,terminate:r,setTerminate:o,showReceipt:y,setShowReceipt:F,subLength:H,setSubLength:P,showVerify:R,setShowVerify:L,isVerified:B,setIsVerified:S,verificationType:v,setVerificationType:W,isVisible:Z,setIsVisible:D,showAlert:X,setShowAlert:k,message:K,setMessage:u,leaseeName:x,setLeaseeName:M,clientViewProps:U,handleShowAlert:Q,error:l,hideFooter:N,handleCloseAlert:ae,sort:Y,changeSort:f,sortFunc:p}}const ya=({show:d,handleClose:l,url:a,setVerified:i,verification_type:j,setCreditInfo:g})=>{const[h,b]=m.useState(!1),[n,c]=m.useState({}),{data:s,setData:O,post:C,reset:t}=ce({otp:"",verification_type:j}),[r,o]=m.useState(!1),[y,F]=m.useState(30);m.useEffect(()=>{const B=setInterval(()=>{F(S=>S<=1?(clearInterval(B),o(!0),0):S-1)},1e3);return()=>clearInterval(B)},[]);const H=()=>oe(void 0,null,function*(){o(!1);try{(yield ee.get(reverseUrl("new_otp"))).data.status==="success"?_.success("OTP sent successfully"):_.error("Something went wrong! Please try again")}catch(B){_.error("Something went wrong! Please try again")}}),P=B=>O(E(I({},s),{[B.target.id]:B.target.value})),R=()=>s.otp.length!==4?(c({otp:"otp must be four digits"}),!1):parseInt(s.otp,10)?!0:(c({otp:"otp must be a number"}),!1),L=B=>{console.log("indi"),B.preventDefault(),R()&&(C(reverseUrl(a),{onStart:()=>{b(!0)},onSuccess:S=>{l(),t(),_.success("Verification successful"),b(!1),typeof i=="function"&&i(!0)},onError:S=>{_.error("Something went wrong! Please try again"),c(S),console.log(erros),b(!1)}}),b(!1))};return e.jsx(e.Fragment,{children:e.jsx(J,{size:"lg",show:d,onHide:l,centered:!0,children:e.jsx("div",{children:e.jsxs("div",{className:"card card-raised",children:[e.jsx("div",{className:"card-header bg-info px-4",children:e.jsxs("div",{className:`d-flex justify-content-between
                                align-items-center`,children:[e.jsxs("div",{className:"me-4",children:[e.jsx("h2",{className:"display-6 mb-0 text-white",children:"Verify OTP"}),e.jsx("div",{className:"card-text"})]}),e.jsx("div",{className:"d-flex gap-2"})]})}),e.jsx("div",{className:"card-body p-4",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body p-4",style:{borderStyle:"solid",borderColor:"#26a69a"},children:[e.jsx(J.Body,{children:e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"col-md-12",children:[e.jsx("div",{children:e.jsx("p",{children:j==="individual"?"Enter the 4-digit code we sent to user's mobile number. This code will expire after 5 minutes":"Enter the 4-digit code we sent to user's email. This code will expire after 5 minutes"})}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Verification Code"}),e.jsx("input",{value:s.otp,onChange:P,type:"text",name:"otp",id:"otp",placeholder:"Enter your 4 digit otp",className:"form-control form-control-sm"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.otp})]})})]}),e.jsxs("div",{className:"mt-5 d-flex gap-4 align-items-center ",children:[e.jsxs("p",{children:["Didn't receive code?",e.jsx("button",{onClick:H,className:"ms-2 text-decoration-underline border-0 bg-transparent text-info",disabled:r===!1,children:"Resend Code"})]}),y>0&&e.jsx("p",{className:"text-success",children:`Resend code in ${y} seconds`})]})]})}),e.jsx(J.Footer,{children:e.jsx(he,{className:"text-white",variant:"info",onClick:B=>L(B),disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ml-2",children:"processing.."})]}):"Verify"})})]})})})]})})})})};function va({leases:d,total_pages:l,total_items:a,current_page:i}){const{rateText:j,smartNavigationTotalFormated:g,totalColor:h,writeOff:b,btnAdd:n,setBtnAdd:c,editBtn:s,setEditBtn:O,details:C,setDetails:t,subscriptions:r,subscription:o,setSubscription:y,terminate:F,setTerminate:H,showReceipt:P,setShowReceipt:R,subLength:L,setSubLength:B,showVerify:S,setShowVerify:v,setIsVerified:W,verificationType:Z,setVerificationType:D,isVisible:X,setIsVisible:k,showAlert:K,setShowAlert:u,message:x,setMessage:M,leaseeName:Y,clientViewProps:q,handleShowAlert:U,handleCloseAlert:Q,sort:ae,changeSort:N,sortFunc:f}=ja(d);return console.log(h),console.log({allState:{smartNavigationTotalFormated:g,leases:d,total_pages:l,total_items:a,current_page:i,btnAdd:n,editBtn:s,details:C,subscriptions:r,subscription:o,terminate:F,showReceipt:P,subLength:L,showVerify:S,verificationType:Z,isVisible:X,showAlert:K,message:x,leaseeName:Y,clientViewProps:q}}),e.jsxs(e.Fragment,{children:[e.jsxs(e.Fragment,{children:[e.jsx(Na,{clientViewProps:q}),e.jsxs(we,{onClose:Q,show:K&&!!x,delay:1e4,className:"w-100 shadow-none mb-3",style:{background:"#dcfce7"},autohide:!0,children:[e.jsxs(we.Header,{className:"w-100",children:[e.jsx("strong",{className:"me-auto",children:Y?`Following message has been sent to ${Y}`:""}),e.jsx("small",{className:"text-muted text-capitalize ms-auto",children:"just now"})]}),e.jsx("p",{className:"p-3 m-0",children:x||""})]}),(o==null?void 0:o.type)==="individual"&&n&&e.jsx(Te,{action:"add",show:n,handleClose:()=>{c(!1),t({})},setShowVerify:v,lesseeDetails:C,subscriptionPeriod:L,handleShowAlert:U}),(o==null?void 0:o.type)==="individual"&&s&&e.jsx(Te,{action:"edit",show:s,handleClose:()=>{O(!1),t({})},handleShowAlert:U,lesseeDetails:C,subscriptionPeriod:C.lease_period}),(o==null?void 0:o.type)==="company"&&n&&e.jsx(_e,{action:"add",show:n,handleClose:()=>{c(!1),t({})},lesseeDetails:C,subscriptionPeriod:L,handleShowAlert:U}),(o==null?void 0:o.type)==="company"&&s&&e.jsx(_e,{action:"edit",show:s,handleClose:()=>{O(!1),t({})},handleShowAlert:U,lesseeDetails:C,subscriptionPeriod:C.lease_period}),F&&e.jsx(ba,{show:F,handleClose:()=>{H(!1),t({})},handleShowAlert:U,leaseData:C}),P&&e.jsx(ge,{show:P,handleClose:p=>oe(this,null,function*(){M(p),R(!1),u(!0),t({})}),leaseDetails:C,myKey:"leases"}),S&&e.jsx(ya,{show:S,handleClose:()=>{v(!1)},url:"client-individual-verify-otp",setVerified:W,verification_type:Z})]}),e.jsxs("main",{id:"hide-footer",children:[e.jsxs("div",{className:"container-xl p-0 mb-5",children:[e.jsx("h5",{className:"bg-info text-center text-white p-2 rounded-2",children:"Lease Management"}),e.jsxs("div",{className:"row justify-content-between align-items-center my-3 g-2",children:[e.jsx("div",{className:"col-5",children:e.jsx(Qe,{searchBy:"name"})}),e.jsx("div",{className:"col-auto",children:e.jsxs("div",{className:"d-flex border c-bg-light align-items-center",children:[e.jsx("label",{htmlFor:"sort",className:"form-label bg-white c-bg-light d-block my-0 text-nowrap p-1",children:"Sort By:"}),e.jsxs("select",{className:"form-select c-select rounded-0 border",name:"sort",id:"sort",value:ae,onChange:N,children:[e.jsx("option",{value:"default",children:"default"}),e.jsx("option",{value:"rent-owing-asc",children:"Rent Owing asc"}),e.jsx("option",{value:"rent-owing-des",children:"Rent Owing des"}),e.jsx("option",{value:"color-asc",children:"color (rent asc)"}),e.jsx("option",{value:"color-des",children:"color (rent des)"})]})]})})]}),e.jsxs("div",{className:"position-relative bg-white rounded-2 border",children:[e.jsxs("h5",{className:"text-center py-2 mb-0 text-white border bg-info",children:["Active Leases - ",(d==null?void 0:d.length)||0]}),e.jsxs("table",{className:"table table-sm table-responsive table-bordered ",children:[e.jsx("thead",{className:"position-sticky bg-white shadow-sm c-table-top",children:e.jsxs("tr",{children:[e.jsx("th",{className:"ps-3",children:"Lease ID"}),e.jsx("th",{children:"Tenant"}),e.jsx("th",{children:"Customer Number"}),e.jsx("th",{className:"text-end",children:"Rent Owing"}),e.jsx("th",{colSpan:3,className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:d?f(d).map((p,z)=>e.jsxs("tr",{className:p.terminated?"c-terminated":"",children:[e.jsx("th",{className:"ps-3",children:p.lease_id||""}),e.jsx("td",{children:e.jsx("button",{title:"double click to view client",type:"button",onDoubleClick:()=>q.openClientView(p),className:`custom-btn text-decoration-underline ${p.terminated?"c-terminated":""}`,children:p.name})}),e.jsx("td",{children:p.customer_number}),e.jsx("td",{className:`bg-${p.color} text-white text-end`,style:{backgroundColor:p.color=="light-red"?"#f87171":""},children:`${p.currency} ${ie(p.owing_amount).replace("$","")}`}),e.jsx("td",{className:"bg-info text-white text-center c-pointer",onClick:()=>{t(p),R(!0)},children:"Receipt"}),p.terminated?e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"c-terminated text-center",children:"Terminated"}),e.jsx("td",{className:"bg-danger text-white text-center c-pointer",onClick:()=>b(p),children:"Write off"})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"bg-primary text-white text-center c-pointer",onClick:()=>{t(p),O(!0),c(!1),y({type:p.is_company?"company":"individual"})},children:"Adjust"}),e.jsx("td",{className:"bg-danger text-white text-center c-pointer",onClick:()=>{t(p),H(!0)},children:"Terminate"})]})]},p.lease_id+"-"+z)):""}),h&&(d!=null&&d.length)?e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"border-0 pt-5"}),e.jsxs("td",{className:"border-0 pt-5",children:["Total Debtors: ",d==null?void 0:d.length]}),e.jsx("td",{className:"border-0 pt-5",children:"Total mount"}),e.jsxs("td",{className:"border-0 pt-5 px-0",children:[e.jsx("span",{className:`bg-${h} text-end text-white p-2 w-100 d-inline-block`,style:{backgroundColor:h=="light-red"?"#f87171":h},children:g}),j?e.jsx("small",{className:"d-block text-end p-1 text-muted c-fs-smallest",children:j}):""]}),e.jsx("td",{className:"border-0 pt-5"})]})}):""]}),e.jsx(De,{currentPage:i,totalPages:l})]})]}),e.jsx("div",{className:"position-fixed w-100 bottom-0 start-0",children:e.jsx(Xe,{isVisible:X,setIsVisible:k,trigger:e.jsxs("button",{type:"button",className:"btn btn-lg c-bg-warning-light w-100 justify-content-center align-items-center text-capitalize gap-2 ",children:["Open Subscriptions",e.jsx("i",{className:"material-icons fs-3",children:"keyboard_arrow_up"})]}),children:e.jsx(Ke,{title:"Open Subscriptions",children:e.jsxs("table",{className:"table table-responsive table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Open Slots"}),e.jsx("th",{children:"Period (months)"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{colSpan:"2"})]})}),e.jsx("tbody",{children:r==null?void 0:r.map((p,z)=>e.jsx(Ve.Fragment,{children:p.open_slots>0&&e.jsxs("tr",{children:[e.jsx("th",{children:z+1}),e.jsx("td",{children:p.subscription_class}),e.jsx("td",{children:p.open_slots}),e.jsx("td",{children:p.period_length}),e.jsx("td",{children:p.start_date}),e.jsx("td",{children:p.end_date}),e.jsx("td",{colSpan:"2",className:`${p.open_slots===0?"bg-gray":"bg-success"} text-white text-center c-pointer`,onClick:()=>{p.open_slots!==0&&(c(!0),O(!1),k(!1),t({}),y({type:p.subscription_class}),D(p.subscription_class),B(p.period_left))},children:"Activate"})]},"subscription"+z)},z))})]})})})})]})]})}va.layout=d=>e.jsx(We,{children:d,title:"Leases"});export{va as default};
