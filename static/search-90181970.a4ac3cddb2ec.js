import{r as s,b as I,u as P,j as t,_ as T}from"./main-27bc9caa.js";import{_ as O}from"./lodash-8b63f6bf.js";import{u as Y}from"./index-3d918947.js";function H({delay:p=500,url:f,value:d,setValue:b,placeholder:D,type:R,setAddress:h,setClientId:L,setRegNumber:i,setClientName:g,setMobileNo:y,from:u="subs"}){var j,k,C;const[z,c]=s.useState(!1),[x,l]=s.useState(!1),[v,S]=s.useState(""),[w,n]=s.useState([]),[m,B]=s.useState([]);s.useEffect(()=>{if(!d){n([]);return}const a=O.debounce(o=>{l(!0),I.post(f,{searchParam:"guess",searchValue:o}).then(e=>{var E;((E=e.data)==null?void 0:E.status)!=="failed"?(R==="company"?(B([...e.data]),n(e.data.map(r=>({label:r.registration_name+"("+r.registration_number+")",value:r.id})))):n(e.data.map(r=>({label:r.firstname+" "+r.surname+"("+r.national_id+")",value:r.id}))),S(""),l(!1)):(n([]),l(!1),S(Y(e)))})},p);return a(d),l(!1),()=>{a.cancel()}},[p,f,d]);const _=(C=(k=(j=P().props)==null?void 0:j.Auth)==null?void 0:k.company)==null?void 0:C.company_id,F=a=>{const o=Number(a.value)===Number(_);if(console.log({selected_company_id:a.value,company_id:_,isSelfCompany:o}),o){T.error("Blocked, a company cannot create a lease on itself");return}L(a.value),b(a.label),g&&g(a.label.split("(")[0]),i&&u==="subs"&&i(a.label.split("(").at(-1).split(")")[0]),i&&u==="leases"&&i(m.find(e=>e.id===a.value).email),y&&u==="leases"&&y(m.find(e=>e.id===a.value).mobile),h&&h(m.find(e=>e.id===a.value).address),c(!1)};return t.jsxs("div",{style:{width:"100%",border:"1px solid gray",borderRadius:"0.5rem",position:"relative"},children:[t.jsx("input",{type:"text",placeholder:D,value:d,onChange:a=>b(a.target.value),onFocus:()=>c(!0),onBlur:()=>{setTimeout(()=>c(!1),200)},style:{width:"100%",padding:"0.2rem",fontSize:"1rem",border:"none",borderRadius:"0.5rem",backgroundColor:"#eee",color:"black",opacity:"0.8"},className:"form-control"}),z&&t.jsx("div",{style:{border:"2px #ccc solid",borderRadius:"0.5rem",backgroundColor:"#d9d9d9",padding:"1rem 0.2rem",height:"250px",overflowY:"scroll",width:"100%",marginTop:"0.1rem",position:"absolute",top:"100%",left:"0",zIndex:"100"},children:!x&&v?t.jsx("div",{style:{color:"red",margin:"auto"},children:v}):x&&w.length===0?t.jsx("div",{style:{color:"black",margin:"auto"},children:"Loading..."}):w.map((a,o)=>t.jsx("div",{onClick:()=>F(a),style:{cursor:"pointer",padding:"0.2rem 0.5rem",color:"black",opacity:"0.8",backgroundColor:"#d3d3d3",borderRadius:"0.5rem",margin:"0.5rem 0"},children:a.label},o))})]})}export{H as S};
