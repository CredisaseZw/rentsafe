var Ie=Object.defineProperty,Le=Object.defineProperties;var Re=Object.getOwnPropertyDescriptors;var ie=Object.getOwnPropertySymbols;var ge=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var we=Math.pow,ye=(r,l,a)=>l in r?Ie(r,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[l]=a,B=(r,l)=>{for(var a in l||(l={}))ge.call(l,a)&&ye(r,a,l[a]);if(ie)for(var a of ie(l))ve.call(l,a)&&ye(r,a,l[a]);return r},M=(r,l)=>Le(r,Re(l));var ce=(r,l)=>{var a={};for(var t in r)ge.call(r,t)&&l.indexOf(t)<0&&(a[t]=r[t]);if(r!=null&&ie)for(var t of ie(r))l.indexOf(t)<0&&ve.call(r,t)&&(a[t]=r[t]);return a};var de=(r,l,a)=>new Promise((t,x)=>{var u=o=>{try{d(a.next(o))}catch(h){x(h)}},p=o=>{try{d(a.throw(o))}catch(h){x(h)}},d=o=>o.done?t(o.value):Promise.resolve(o.value).then(u,p);d((a=a.apply(r,l)).next())});import{b as q,r as i,j as e,a as me,u as Pe,R as Fe}from"./main-66671e9f.js";import"./PageHeader-fbd4623e.js";import{L as De}from"./Layout-8e05a598.js";import{h as E}from"./moment-686b5dfa.js";import{_ as T,I as pe}from"./index-b99d0477.js";import{R as fe}from"./Receipt-3aac83ab.js";import{f as be}from"./formatting-345d2430.js";import{M as Ce}from"./MultipleUpload-8bd3d2c5.js";import{b as Ve,d as He,F as $e,u as je,a as Ue,c as Ne,C as Ge,M as k}from"./Modal-952b408f.js";import{B as V}from"./Button-aff10e2d.js";import{S as qe}from"./search-9633bbaf.js";import{B as ze,D as Je}from"./DrawerContent-28639fa4.js";import{E as We,e as Ze}from"./removeClass-95c06036.js";import{S as Xe,P as Ke}from"./PaginationControls-db9c194e.js";import{l as le}from"./lodash-ccce9e4b.js";import{f as ue,b as Be}from"./index-941ba0b5.js";import"./assertThisInitialized-3be3daa4.js";import"./index-cb773e7f.js";import"./Button-b6f7e9ec.js";const{Axios:Gt,AxiosError:he,CanceledError:qt,isCancel:zt,CancelToken:Jt,VERSION:Wt,all:Zt,Cancel:Xt,isAxiosError:Kt,spread:Qt,toFormData:ea,AxiosHeaders:ta,HttpStatusCode:aa,formToJSON:sa,getAdapter:na,mergeConfig:ra}=q,xe=we(2,31)-1;function Ee(r,l,a){const t=a-Date.now();r.current=t<=xe?setTimeout(l,t):setTimeout(()=>Ee(r,l,a),xe)}function Qe(){const r=Ve(),l=i.useRef();return He(()=>clearTimeout(l.current)),i.useMemo(()=>{const a=()=>clearTimeout(l.current);function t(x,u=0){r()&&(a(),u<=xe?l.current=setTimeout(x,u):Ee(l,x,Date.now()+u))}return{set:t,clear:a,handleRef:l}},[])}const et={[We]:"showing",[Ze]:"showing show"},Me=i.forwardRef((r,l)=>e.jsx($e,M(B({},r),{ref:l,transitionClasses:et})));Me.displayName="ToastFade";const tt=Me,at=i.createContext({onClose(){}}),ke=at,Oe=i.forwardRef((o,d)=>{var h=o,{bsPrefix:r,closeLabel:l="Close",closeVariant:a,closeButton:t=!0,className:x,children:u}=h,p=ce(h,["bsPrefix","closeLabel","closeVariant","closeButton","className","children"]);r=je(r,"toast-header");const b=i.useContext(ke),S=Ue(m=>{b==null||b.onClose==null||b.onClose(m)});return e.jsxs("div",M(B({ref:d},p),{className:Ne(r,x),children:[u,t&&e.jsx(Ge,{"aria-label":l,variant:a,onClick:S,"data-dismiss":"toast"})]}))});Oe.displayName="ToastHeader";const st=Oe,Ae=i.forwardRef((u,x)=>{var p=u,{className:r,bsPrefix:l,as:a="div"}=p,t=ce(p,["className","bsPrefix","as"]);return l=je(l,"toast-body"),e.jsx(a,B({ref:x,className:Ne(r,l)},t))});Ae.displayName="ToastBody";const nt=Ae,Ye=i.forwardRef((O,s)=>{var n=O,{bsPrefix:r,className:l,transition:a=tt,show:t=!0,animation:x=!0,delay:u=5e3,autohide:p=!1,onClose:d,onEntered:o,onExit:h,onExiting:b,onEnter:S,onEntering:m,onExited:c,bg:j}=n,f=ce(n,["bsPrefix","className","transition","show","animation","delay","autohide","onClose","onEntered","onExit","onExiting","onEnter","onEntering","onExited","bg"]);r=je(r,"toast");const A=i.useRef(u),F=i.useRef(d);i.useEffect(()=>{A.current=u,F.current=d},[u,d]);const U=Qe(),C=!!(p&&t),L=i.useCallback(()=>{C&&(F.current==null||F.current())},[C]);i.useEffect(()=>{U.set(L,A.current)},[U,L]);const Y=i.useMemo(()=>({onClose:d}),[d]),z=!!(a&&x),G=e.jsx("div",M(B({},f),{ref:s,className:Ne(r,l,j&&`bg-${j}`,!z&&(t?"show":"hide")),role:"alert","aria-live":"assertive","aria-atomic":"true"}));return e.jsx(ke.Provider,{value:Y,children:z&&a?e.jsx(a,{in:t,onEnter:S,onEntering:m,onEntered:o,onExit:h,onExiting:b,onExited:c,unmountOnExit:!0,children:G}):G})});Ye.displayName="Toast";const Se=Object.assign(Ye,{Body:nt,Header:st});function rt(r,l){const[a,t]=i.useState(r);return i.useEffect(()=>{const x=setTimeout(()=>{t(r)},l);return()=>{clearTimeout(x)}},[r,l]),a}const Te=({show:r,handleClose:l,action:a,lesseeDetails:t,subscriptionPeriod:x,handleShowAlert:u})=>{const[p,d]=i.useState(!1),[o,h]=i.useState(""),[b,S]=i.useState(!1),[m,c]=i.useState({}),[j,f]=i.useState(!1),[s,O]=i.useState(!0),{data:n,setData:A,post:F,reset:U}=me({identificationNumber:(t==null?void 0:t.reg_ID_Number)||"",lesseeName:(t==null?void 0:t.name)||"",lesseeAddress:(t==null?void 0:t.address)||"",lesseePhone:(t==null?void 0:t.mobile)||"",leaseDetails:(t==null?void 0:t.lease_details)||"",leaseStartDate:(t==null?void 0:t.start_date)||"",leaseEndDate:(t==null?void 0:t.end_date)||"",leaseCurrency:(t==null?void 0:t.currency)||"USD",depositAmount:(t==null?void 0:t.deposit_amount)||0,leasePeriod:x||(t==null?void 0:t.lease_period),rentVariable:(t==null?void 0:t.rent_variable)||!1,depositPeriod:(t==null?void 0:t.deposit_period)||0,monthlyRental:(t==null?void 0:t.monthly_rentals)||0,paymentPeriodStart:(t==null?void 0:t.payment_period_start)||"25",paymentPeriodEnd:(t==null?void 0:t.payment_period_end)||"7",isCompany:!1,leaseId:(t==null?void 0:t.lease_id)||-1,monthOneBalance:"",monthTwoBalance:"",monthThreeBalance:"",moreThanThreeMonthsBalance:"",currentBalance:""}),C=()=>{O(!0),f(!1)},L=()=>{f(!0),O(!1)},Y=E(),z=Y.clone().add(n.paymentPeriodEnd>=Y.date()?0:1,"months").date(n.paymentPeriodEnd).format("DD-MMM-YY"),G=Y.clone().subtract(n.paymentPeriodEnd>=Y.date()?1:0,"months").date(n.paymentPeriodEnd).format("DD-MMM-YY"),ee=Y.clone().subtract(n.paymentPeriodEnd>=Y.date()?2:1,"months").date(n.paymentPeriodEnd).format("DD-MMM-YY"),te=Y.clone().subtract(n.paymentPeriodEnd>=Y.date()?3:2,"months").date(n.paymentPeriodEnd).format("DD-MMM-YY"),J=rt(n.identificationNumber,500),X=i.useCallback(()=>{if(J&&J.length>=5)try{d(!0),q.post(reverseUrl("get-user"),n).then(N=>{var v,I,H,W,w,ne,re,P;(v=N.data)!=null&&v.props.name?(A(M(B({},n),{lesseeName:((I=N.data)==null?void 0:I.props.name)||"",lesseeAddress:((H=N.data)==null?void 0:H.props.address)||"",lesseePhone:((W=N.data)==null?void 0:W.props.phone)||""})),c((ne=(w=N.data)==null?void 0:w.props)==null?void 0:ne.openingBalances)):((n.identificationNumber.length===6||n.identificationNumber.length>7)&&T.error("User not found!",{duration:4e3,id:"error-toast",icon:"❌"}),h((P=(re=N.data)==null?void 0:re.props)==null?void 0:P.errors)),d(!1)}).catch(N=>{T.error("Something went wrong! Please try again"),h(N)}).finally(()=>{d(!1)})}catch(N){T.error("Something went wrong! Please try again"),h(N)}},[J]);i.useEffect(()=>{a==="add"&&X()},[a,X]),i.useEffect(()=>{if(n.leaseStartDate){const v=E(n.leaseStartDate);A(M(B({},n),{leaseEndDate:v}))}},[]);const _=N=>{N.target.id==="rentVariable"?A(M(B({},n),{[N.target.id]:N.target.checked})):N.target.id==="leasePeriod"?Number(N.target.value)>Number(x)?(T.error(`Lease period cannot be more than your subscription period (${x} months)`),A(M(B({},n),{[N.target.id]:x}))):A(M(B({},n),{[N.target.id]:N.target.value})):A(M(B({},n),{[N.target.id]:N.target.value}))},D=N=>de(void 0,null,function*(){if(N.preventDefault(),n.lesseeName===""){T.error("Please enter a valid lessee");return}n.leaseEndDate=E(n.leaseStartDate).add(n.leasePeriod,"months").format("YYYY-MM-DD"),n.leaseStartDate=E(n.leaseStartDate).format("YYYY-MM-DD"),n.monthOneBalance=Number(n.monthOneBalance),n.monthTwoBalance=Number(n.monthTwoBalance),n.monthThreeBalance=Number(n.monthThreeBalance),n.moreThanThreeMonthsBalance=Number(n.moreThanThreeMonthsBalance),n.currentBalance=Number(n.currentBalance),n.monthOneDate=E(G).format("YYYY-MM-DD"),n.monthTwoDate=E(ee).format("YYYY-MM-DD"),n.monthThreeDate=E(te).format("YYYY-MM-DD"),n.currentDate=E(z).format("YYYY-MM-DD"),n.monthlyRental=Number(n.monthlyRental),n.depositAmount=n.depositAmount,n.depositPeriod=Number(n.depositPeriod),n.leasePeriod=Number(n.leasePeriod),n.outStandingBalance=n.moreThanThreeMonthsBalance+n.monthThreeBalance+n.monthTwoBalance+n.monthOneBalance+n.currentBalance,F(reverseUrl("create-individual-lease"),{onStart:()=>{d(!0)},onSuccess:v=>{var H,W,w;const I=(H=v==null?void 0:v.props)==null?void 0:H.flash.message;I&&((W=v==null?void 0:v.props)==null?void 0:W.flash.type)==="success"?(l(),u(I,n.lesseeName)):I&&((w=v==null?void 0:v.props)==null?void 0:w.flash.type)==="error"&&T.error(I.message),U(),d(!1)},onError:v=>{T.error(N.message||"Something went wrong! Please try again"),h(N),d(!1)}})}),ae=N=>{N.preventDefault(),n.leaseStartDate=E(n.leaseStartDate).format("YYYY-MM-DD"),n.leaseEndDate=E(n.leaseStartDate).add(n.leasePeriod,"months").format("YYYY-MM-DD"),F(reverseUrl("client-edit-lease"),{onStart:()=>{d(!0)},onSuccess:v=>{var I,H;((I=v==null?void 0:v.props)==null?void 0:I.flash.type)==="success"?(l(),u("Lease updated successfully")):((H=v==null?void 0:v.props)==null?void 0:H.flash.type)==="error"&&T.error("An error occurred, please try again later"),d(!1)},onError:v=>{T.error("Something went wrong! Please try again"),h(v),d(!1)}})};return e.jsx(e.Fragment,{children:e.jsx(k,{size:"lg",show:r,onHide:l,children:e.jsxs("div",{children:[e.jsx(k.Header,{closeButton:!0,className:"card-header bg-transparent",style:{paddingLeft:"0px"},children:e.jsxs("div",{className:"",children:[e.jsx("button",{className:`btn  btn-sm ${s?"btn-info text-white":"btn-light"}`,onClick:C,children:"Single"}),e.jsx("button",{className:`btn  btn-sm ${j?"btn-info text-white":"btn-light"}`,onClick:L,children:"Multiple"})]})}),s?e.jsxs("div",{className:"card card-raised",children:[e.jsx("div",{className:"card-header bg-info",children:e.jsxs("div",{className:`d-flex justify-content-between
                      align-items-center`,children:[e.jsxs("div",{className:"me-4",children:[e.jsx("h2",{className:"display-6 mb-0 text-white",children:a==="view"?"View Lease - Individual":a==="edit"?"Edit Lease - Individual":"Add Lease - Individual"}),e.jsx("div",{className:"card-text"})]}),e.jsx("div",{className:"d-flex gap-2"})]})}),e.jsx("div",{className:"card-body p-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-info px-4",style:{paddingTop:"2px",paddingBottom:"2px"},children:e.jsx("div",{className:`d-flex justify-content-center
                            align-items-center`,children:e.jsxs("div",{className:"me-4",children:[e.jsx("h6",{className:"display-6 mb-0 text-white",children:"Lease details"}),e.jsx("div",{className:"card-text"})]})})}),e.jsx("div",{className:"card-body p-4",style:{borderStyle:"solid",borderColor:"#26a69a"},children:e.jsx(k.Body,{children:e.jsxs("form",{onSubmit:a==="add"?D:a==="edit"?ae:()=>{},children:[e.jsxs("div",{className:"row mb-4",children:[e.jsx(pe,{}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"National ID:"}),e.jsx("input",{value:n.identificationNumber,onChange:_,type:"text",required:!0,name:"identificationNumber",id:"identificationNumber",className:"form-control form-control-sm"}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.identificationNumber})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lessee Name:"}),e.jsx("input",{value:n.lesseeName,onChange:_,type:"text",name:"lesseeName",required:!0,id:"lesseeName",className:"form-control form-control-sm",readOnly:!0}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.lesseeName})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lessee Mobile Number"}),e.jsx("input",{value:n.lesseePhone,onChange:_,type:"text",name:"lesseePhone",id:"lesseePhone",required:!0,className:"form-control form-control-sm",readOnly:a==="view"}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.lesseePhone})]})]})]}),e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Address:"}),e.jsx("textarea",{value:n.lesseeAddress,onChange:_,type:"text",required:!!n.lesseeName,name:"lesseeAddress",id:"lesseeAddress",className:"form-control form-control-sm",readOnly:a==="view"}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.lesseeAddress})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Details:"}),e.jsx("textarea",{value:n.leaseDetails,onChange:_,name:"leaseDetails",id:"leaseDetails",className:"form-control form-control-sm",readOnly:a==="view"}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.leaseDetails})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Currency"}),e.jsxs("select",{value:n.leaseCurrency,onChange:_,id:"leaseCurrency",name:"leaseCurrency",className:"form-select form-select-sm",readOnly:a==="view",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"ZWG",children:"ZWG"})]}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.leaseCurrency})]})]})}),e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Monthly Rental:"}),e.jsx("input",{value:n.monthlyRental===0?"":n.monthlyRental,placeholder:"enter monthly rental",onChange:_,type:"text",required:!!n.lesseeName,id:"monthlyRental",name:"monthlyRental",className:"form-control form-control-sm",readOnly:a==="view"}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.monthlyRental})]}),e.jsxs("div",{className:"mt-1 col-lg-4 d-flex flex-column",children:[e.jsx("label",{className:"form-label",children:"Variable Rent:"}),e.jsx("input",{checked:n.rentVariable,onChange:_,type:"checkbox",id:"rentVariable",name:"rentVariable",className:"form-check-input border-1 p-2 border-black"}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.rentVariable})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Period(Months):"}),e.jsx("input",{value:n.depositPeriod===0?"":n.depositPeriod,placeholder:"enter deposit period",onChange:_,type:"text",id:"depositPeriod",name:"depositPeriod",className:"form-control form-control-sm",readOnly:a==="view"}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.depositPeriod})]})]})}),e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Amount:"}),e.jsx("input",{value:n.depositAmount===0?"":n.depositAmount,placeholder:"enter deposit amount",onChange:_,type:"text",name:"depositAmount",id:"depositAmount",className:"form-control form-control-sm",readOnly:a==="view"}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.depositAmount})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Subs Months Remaining:"}),e.jsx("input",{value:n.leasePeriod,onChange:_,type:"number",id:"leasePeriod",name:"leasePeriod",className:"form-control form-control-sm"}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.leasePeriod})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Start Date:"}),e.jsx("input",{value:n.leaseStartDate,onChange:_,type:"date",required:!!n.lesseeName,name:"leaseStartDate",id:"leaseStartDate",className:"form-control form-control-sm",readOnly:a==="view"}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.leaseStartDate})]})]})}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease End Date:"}),e.jsx("span",{className:"form-control form-control-sm",children:n.leaseStartDate?E(n.leaseStartDate).add(n.leasePeriod,"months").subtract(1,"days").format("DD / MM / YYYY"):""}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.leaseEndDate})]}),e.jsxs("div",{className:"col-lg-4 mt-1",children:[e.jsx("label",{className:"form-label",children:"Payment Period Start Date:"}),e.jsx("input",{value:n.paymentPeriodStart,type:"number",id:"paymentPeriodStart",name:"paymentPeriodStart",className:"form-control form-control-sm",readOnly:!0,disabled:!0}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.paymentPeriodStart})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Payment Period End Date:"}),e.jsx("input",{value:n.paymentPeriodEnd,onChange:_,type:"number",min:"1",max:"31",required:!!n.lesseeName,name:"paymentPeriodEnd",id:"paymentPeriodEnd",className:"form-control form-control-sm",readOnly:a==="view"}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.paymentPeriodEnd})]})]}),a==="add"&&e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"table-responsive table-bordered",children:[e.jsx("h3",{className:"text-center p-2 fw-bolder h6",style:{backgroundColor:"#a0a0af"},children:"Opening Rent Balances"}),e.jsx("table",{className:"table table-bordered",children:e.jsxs("tbody",{children:[e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",style:{lineHeight:"15px"},children:"Payment Date"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:"More than 3 months"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:te}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:ee}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:G}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:z}),e.jsx("td",{className:"fw-bold",style:{lineHeight:"15px"},children:"Outstanding Balance"})]}),e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",children:"Amount"}),e.jsx("td",{className:"bg-black text-white",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"moreThanThreeMonthsBalance",name:"moreThanThreeMonthsBalance",onChange:_,value:n.moreThanThreeMonthsBalance})}),e.jsx("td",{className:"text-white bg-danger",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthThreeBalance",name:"monthThreeBalance",onChange:_,value:n.monthThreeBalance})}),e.jsx("td",{className:"text-white",style:{backgroundColor:"#f87171"},children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthTwoBalance",name:"monthTwoBalance",onChange:_,value:n.monthTwoBalance})}),e.jsx("td",{className:"text-white bg-warning",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthOneBalance",name:"monthOneBalance",onChange:_,value:n.monthOneBalance})}),e.jsx("td",{className:"text-white bg-success",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"currentBalance",name:"currentBalance",onChange:_,value:n.currentBalance})}),e.jsx("td",{className:`text-white d-flex align-items-center justify-content-center py-4 my-auto ${Number(n.moreThanThreeMonthsBalance)>0?"bg-black":Number(n.monthThreeBalance)>0?"bg-danger":Number(n.monthTwoBalance)>0?"bg-transperant":Number(n.monthOneBalance)>0?"bg-warning":"bg-success"}`,style:{backgroundColor:Number(n.monthTwoBalance)>0?"#f87171":""},children:be(Number(n.moreThanThreeMonthsBalance)+Number(n.monthThreeBalance)+Number(n.monthTwoBalance)+Number(n.monthOneBalance)+Number(n.currentBalance)||0)})]})]})})]})}),e.jsx("div",{className:"w-100 mt-4 d-flex justify-content-end gap-3",children:a==="view"?e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"text-white",variant:"info",onClick:()=>{S(!0)},children:"Receipt"}),e.jsx(V,{className:"text-white",variant:"success",onClick:()=>{l()},children:"Edit"}),e.jsx(V,{className:"text-white",variant:"danger",onClick:()=>{l()},children:"Terminate"})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{variant:"secondary",onClick:l,children:"Cancel"}),e.jsx(V,{className:"text-white",variant:"info",type:"submit",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ml-2",children:"processing.."})]}):"Submit"})," "]})})]})})}),b&&e.jsx(fe,{show:b,handleClose:()=>{S(!1)}})]})})]}):e.jsx(Ce,{type:"individual",actionType:"lease"})]})})})},_e=({show:r,handleClose:l,action:a,lesseeDetails:t,subscriptionPeriod:x,handleShowAlert:u})=>{const[p,d]=i.useState(!1),[o,h]=i.useState(!1),[b,S]=i.useState(!0),[m,c]=i.useState(""),[j,f]=i.useState(!1),{data:s,setData:O,post:n,reset:A}=me({identificationNumber:(t==null?void 0:t.reg_ID_Number)||"",lesseeName:(t==null?void 0:t.name)||"",lesseeAddress:(t==null?void 0:t.address)||"",mobile:(t==null?void 0:t.mobile)||"",email:(t==null?void 0:t.email)||"",rentGuarantorId:(t==null?void 0:t.rent_guarantor_id)||"",rentGuarantorIdType:(t==null?void 0:t.rent_guarantor_id_type)||"",rentGuarantorName:(t==null?void 0:t.rent_guarantor_name)||"",leaseDetails:(t==null?void 0:t.lease_details)||"",leaseStartDate:(t==null?void 0:t.start_date)||"",rentVariable:(t==null?void 0:t.rent_variable)||!1,leaseEndDate:(t==null?void 0:t.end_date)||"",leaseCurrency:(t==null?void 0:t.currency)||"USD",depositAmount:(t==null?void 0:t.deposit_amount)||0,leasePeriod:x||(t==null?void 0:t.lease_period),depositPeriod:(t==null?void 0:t.deposit_period)||0,monthlyRental:(t==null?void 0:t.monthly_rentals)||0,paymentPeriodStart:(t==null?void 0:t.payment_period_start)||"25",paymentPeriodEnd:(t==null?void 0:t.payment_period_end)||"7",isCompany:!0,leaseId:(t==null?void 0:t.lease_id)||-1,monthOneBalance:"",monthTwoBalance:"",monthThreeBalance:"",moreThanThreeMonthsBalance:"",currentBalance:""}),[F,U]=i.useState(a==="edit"?s.lesseeName:""),[C,L]=i.useState(s.lesseeName),[Y,z]=i.useState(s.email),[G,ee]=i.useState(s.identificationNumber),[te,J]=i.useState(s.mobile),[X,_]=i.useState(s.lesseeAddress),D=E(),ae=D.clone().add(s.paymentPeriodEnd>=D.date()?0:1,"months").date(s.paymentPeriodEnd).format("DD-MMM-YY"),N=D.clone().subtract(s.paymentPeriodEnd>=D.date()?1:0,"months").date(s.paymentPeriodEnd).format("DD-MMM-YY"),v=D.clone().subtract(s.paymentPeriodEnd>=D.date()?2:1,"months").date(s.paymentPeriodEnd).format("DD-MMM-YY"),I=D.clone().subtract(s.paymentPeriodEnd>=D.date()?3:2,"months").date(s.paymentPeriodEnd).format("DD-MMM-YY");i.useEffect(()=>{O(M(B({},s),{lesseeName:C,email:Y,identificationNumber:String(G),mobile:te,lesseeAddress:X}))},[G,C,Y,te,X]),i.useEffect(()=>{a==="add"&&(()=>{if(s.rentGuarantorId&&/^[\d]{8,9}[A-Za-z]{1}[\d]{2}$/.test(s.rentGuarantorId))try{d(!0),q.post(reverseUrl("get-user"),{identificationNumber:s.rentGuarantorId}).then(y=>{var $,R,se,Z,oe;($=y.data)!=null&&$.props.name?O(M(B({},s),{rentGuarantorName:((R=y.data)==null?void 0:R.props.name)||"",rentGuarantorIdType:((se=y.data)==null?void 0:se.props.identification_type)||""})):(T.error("User not found!",{duration:4e3,icon:"❌"}),c((oe=(Z=y.data)==null?void 0:Z.props)==null?void 0:oe.errors)),d(!1)}).catch(y=>{T.error("Something went wrong! Please try again"),c(y)}).finally(()=>{d(!1)})}catch(y){T.error("Something went wrong! Please try again"),c(y)}})()},[s.rentGuarantorId]);const H=()=>{S(!0),h(!1)},W=()=>{h(!0),S(!1)},w=P=>{P.target.id==="rentVariable"?O(M(B({},s),{[P.target.id]:P.target.checked})):P.target.id==="leasePeriod"?Number(P.target.value)>Number(x)?(T.error(`Lease period cannot be more than your subscription period (${x} months)`),O(M(B({},s),{[P.target.id]:x}))):O(M(B({},s),{[P.target.id]:P.target.value})):O(M(B({},s),{[P.target.id]:P.target.value}))},ne=P=>de(void 0,null,function*(){if(P.preventDefault(),!s.lesseeName){T.error("Please add a valid lessee");return}d(!0),s.leaseEndDate=E(s.leaseStartDate).add(s.leasePeriod,"months").format("YYYY-MM-DD"),s.monthOneBalance=Number(s.monthOneBalance),s.monthTwoBalance=Number(s.monthTwoBalance),s.monthThreeBalance=Number(s.monthThreeBalance),s.moreThanThreeMonthsBalance=Number(s.moreThanThreeMonthsBalance),s.currentBalance=Number(s.currentBalance),s.monthOneDate=E(N).format("YYYY-MM-DD"),s.monthTwoDate=E(v).format("YYYY-MM-DD"),s.monthThreeDate=E(I).format("YYYY-MM-DD"),s.currentDate=E(ae).format("YYYY-MM-DD"),s.monthlyRental=Number(s.monthlyRental),s.depositAmount=s.depositAmount,s.depositPeriod=Number(s.depositPeriod),s.leasePeriod=Number(s.leasePeriod),s.outStandingBalance=s.moreThanThreeMonthsBalance+s.monthThreeBalance+s.monthTwoBalance+s.monthOneBalance+s.currentBalance,n(reverseUrl("create-company-lease"),{onStart:()=>{d(!0)},onSuccess:y=>{var R,se,Z;const $=(R=y==null?void 0:y.props)==null?void 0:R.flash.message;$&&((se=y==null?void 0:y.props)==null?void 0:se.flash.type)==="success"?(l(),A(),u($,s.lesseeName)):$&&((Z=y==null?void 0:y.props)==null?void 0:Z.flash.type)==="error"&&T.error($.message),d(!1)},onError:y=>{T.error(P.message||"Something went wrong! Please try again"),c(P),d(!1)}})}),re=P=>{P.preventDefault(),s.leaseStartDate=E(s.leaseStartDate).format("YYYY-MM-DD"),n(reverseUrl("client-edit-lease"),{onStart:()=>{d(!0)},onSuccess:y=>{var $,R;(($=y==null?void 0:y.props)==null?void 0:$.flash.type)==="success"?(l(),u("Lease updated successfully")):((R=y==null?void 0:y.props)==null?void 0:R.flash.type)==="error"&&T.error("An error occurred, please try again"),d(!1)},onError:y=>{T.error("Something went wrong! Please try again"),c(y),d(!1)}})};return e.jsx(e.Fragment,{children:e.jsx(k,{size:"lg",show:r,onHide:l,children:e.jsxs("div",{children:[e.jsx(k.Header,{closeButton:!0,className:"card-header bg-transparent",style:{paddingLeft:"0px"},children:e.jsxs("div",{className:"",children:[e.jsx("button",{className:`btn  btn-sm ${b?"btn-info text-white":"btn-light"}`,onClick:H,children:"Single"}),e.jsx("button",{className:`btn  btn-sm ${o?"btn-info text-white":"btn-light"}`,onClick:W,children:"Multiple"})]})}),b?e.jsxs("div",{className:"card card-raised",children:[e.jsx("div",{className:"card-header bg-info",children:e.jsxs("div",{className:`d-flex justify-content-between
                      align-items-center`,children:[e.jsxs("div",{className:"me-4",children:[e.jsx("h2",{className:"display-6 mb-0 text-white",children:a==="view"?"View Lease - Company":a==="edit"?"Edit Lease - Company":"Add Lease - Company"}),e.jsx("div",{className:"card-text"})]}),e.jsx("div",{className:"d-flex gap-2"})]})}),e.jsx("div",{className:"card-body p-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-info px-4",style:{paddingTop:"2px",paddingBottom:"2px"},children:e.jsx("div",{className:`d-flex justify-content-center
                            align-items-center`,children:e.jsxs("div",{className:"me-4",children:[e.jsx("h6",{className:"display-6 mb-0 text-white",children:"Lease details"}),e.jsx("div",{className:"card-text"})]})})}),e.jsx("div",{className:"card-body p-4",style:{borderStyle:"solid",borderColor:"#26a69a"},children:e.jsx(k.Body,{children:e.jsxs("form",{onSubmit:a==="add"?ne:a==="edit"?re:()=>{},children:[e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsx(pe,{}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Company Trading Name:"}),e.jsx(qe,{from:"leases",delay:500,placeholder:"Company Name",value:F,setValue:U,url:reverseUrl("get_searched_companies"),type:"company",setAddress:_,setClientName:L,setRegNumber:z,setClientId:ee,setMobileNo:J}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.identificationNumber})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lessee Name:"}),e.jsx("input",{value:s.lesseeName,onChange:w,type:"text",name:"lesseeName",readOnly:!0,required:!0,id:"lesseeName",className:"form-control form-control-sm"}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.lesseeName})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Email:"}),e.jsx("input",{value:s.email,onChange:w,type:"text",name:"email",required:!0,id:"email",className:"form-control form-control-sm",readOnly:a==="view"}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.email})]})]})}),e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Mobile:"}),e.jsx("input",{value:s.mobile,onChange:w,type:"text",name:"mobile",required:!0,id:"mobile",className:"form-control form-control-sm",readOnly:a==="view"}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.mobile})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Rent Guarantor ID:"}),e.jsx("input",{value:s.rentGuarantorId,onChange:w,type:"text",name:"rentGuarantorId",id:"rentGuarantorId",className:"form-control form-control-sm",readOnly:a==="view"}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.rentGuarantorId})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Rent Guarantor Name:"}),e.jsx("input",{value:s.rentGuarantorName,onChange:w,type:"text",name:"rentGuarantorName",id:"rentGuarantorName",className:"form-control form-control-sm",readOnly:!0}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.rentGuarantorName})]})]})}),e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Address:"}),e.jsx("textarea",{value:s.lesseeAddress,onChange:w,type:"text",required:!!s.lesseeName,name:"lesseeAddress",id:"lesseeAddress",className:"form-control form-control-sm",readOnly:a==="view"}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.lesseeAddress})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Details:"}),e.jsx("textarea",{value:s.leaseDetails,onChange:w,type:"text",name:"leaseDetails",id:"leaseDetails",className:"form-control form-control-sm",readOnly:a==="view"}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.leaseDetails})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Currency"}),e.jsxs("select",{value:s.leaseCurrency,onChange:w,id:"leaseCurrency",name:"leaseCurrency",className:"form-select form-select-sm",readOnly:a==="view",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"ZWG",children:"ZWG"})]}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.leaseCurrency})]})]})}),e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Monthly Rental:"}),e.jsx("input",{value:s.monthlyRental===0?"":s.monthlyRental,placeholder:"enter monthly rental",onChange:w,type:"text",required:!!s.lesseeName,id:"monthlyRental",name:"monthlyRental",className:"form-control form-control-sm",readOnly:a==="view"}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.monthlyRental})]}),e.jsxs("div",{className:"mt-1 col-lg-4 d-flex flex-column",children:[e.jsx("label",{className:"form-label",children:"Variable Rent:"}),e.jsx("input",{checked:s.rentVariable,onChange:w,type:"checkbox",id:"rentVariable",name:"rentVariable",className:"form-check-input border-1 p-2 border-black",readOnly:a==="view"}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.rentVariable})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Period(Months):"}),e.jsx("input",{value:s.depositPeriod===0?"":s.depositPeriod,placeholder:"enter deposit period",onChange:w,type:"text",id:"depositPeriod",name:"depositPeriod",className:"form-control form-control-sm",readOnly:a==="view"}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.depositPeriod})]})]})}),e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Amount:"}),e.jsx("input",{value:s.depositAmount===0?"":s.depositAmount,placeholder:"enter deposit amount",onChange:w,type:"text",name:"depositAmount",id:"depositAmount",className:"form-control form-control-sm",readOnly:a==="view"}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.depositAmount})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Subs Months Remaining:"}),e.jsx("input",{value:s.leasePeriod,onChange:w,type:"number",id:"leasePeriod",name:"leasePeriod",className:"form-control form-control-sm"}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.leasePeriod})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Start Date:"}),e.jsx("input",{value:s.leaseStartDate,onChange:w,type:"date",name:"leaseStartDate",required:!!s.lesseeName,id:"leaseStartDate",className:"form-control form-control-sm",readOnly:a==="view"}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.leaseStartDate})]})]})}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease End Date:"}),e.jsx("span",{className:"form-control form-control-sm",children:s.leaseStartDate?E(s.leaseStartDate).add(s.leasePeriod,"months").subtract(1,"days").format("DD / MM / YYYY"):""}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.leaseEndDate})]}),e.jsxs("div",{className:"col-lg-4 mt-1",children:[e.jsx("label",{className:"form-label",children:"Payment Period Start Date:"}),e.jsx("input",{value:s.paymentPeriodStart,onChange:w,type:"number",id:"paymentPeriodStart",name:"paymentPeriodStart",className:"form-control form-control-sm",readOnly:!0,disabled:!0}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.paymentPeriodStart})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Payment Period End Date:"}),e.jsx("input",{value:s.paymentPeriodEnd,onChange:w,min:"1",max:"31",type:"number",required:!!s.lesseeName,name:"paymentPeriodEnd",id:"paymentPeriodEnd",className:"form-control form-control-sm",readOnly:a==="view"}),m&&e.jsx("div",{className:"text-danger mt-1",children:m.paymentPeriodEnd})]})]}),a==="add"&&e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"table-responsive table-bordered",children:[e.jsx("h3",{className:"text-center p-2 fw-bolder h6",style:{backgroundColor:"#a0a0af"},children:"Opening Rent Balances"}),e.jsx("table",{className:"table table-bordered",children:e.jsxs("tbody",{children:[e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",style:{lineHeight:"15px"},children:"Payment Date"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:"More than 3 months"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:I}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:v}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:N}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:ae}),e.jsx("td",{className:"fw-bold",style:{lineHeight:"15px"},children:"Outstanding Balance"})]}),e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",children:"Amount"}),e.jsx("td",{className:"bg-black text-white",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"moreThanThreeMonthsBalance",name:"moreThanThreeMonthsBalance",onChange:w,value:s.moreThanThreeMonthsBalance})}),e.jsx("td",{className:"text-white bg-danger",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthThreeBalance",name:"monthThreeBalance",onChange:w,value:s.monthThreeBalance})}),e.jsx("td",{className:"text-white",style:{backgroundColor:"#f87171"},children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthTwoBalance",name:"monthTwoBalance",onChange:w,value:s.monthTwoBalance})}),e.jsx("td",{className:"text-white bg-warning",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthOneBalance",name:"monthOneBalance",onChange:w,value:s.monthOneBalance})}),e.jsx("td",{className:"text-white bg-success",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"currentBalance",name:"currentBalance",onChange:w,value:s.currentBalance})}),e.jsx("td",{className:`text-white text-end h-100 d-flex align-items-center justify-content-center py-4 my-auto ${Number(s.moreThanThreeMonthsBalance)>0?"bg-black":Number(s.monthThreeBalance)>0?"bg-danger":Number(s.monthTwoBalance)>0?"bg-transperant":Number(s.monthOneBalance)>0?"bg-warning":"bg-success"}`,style:{backgroundColor:Number(s.monthTwoBalance)>0?"#f87171":""},children:be(Number(s.moreThanThreeMonthsBalance)+Number(s.monthThreeBalance)+Number(s.monthTwoBalance)+Number(s.monthOneBalance)+Number(s.currentBalance)||0)})]})]})})]})}),e.jsx("div",{className:"w-100 d-flex justify-content-end gap-3",children:a==="view"?e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"text-white",variant:"info",onClick:()=>{f(!0)},children:"Receipt"}),e.jsx(V,{className:"text-white",variant:"success",onClick:()=>{l()},children:"Edit"}),e.jsx(V,{className:"text-white",variant:"danger",onClick:()=>{l()},children:"Terminate"})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{variant:"secondary",onClick:l,children:"Cancel"}),e.jsx(V,{className:"text-white",variant:"info",type:"submit",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ml-2",children:"processing.."})]}):"Submit"})," "]})})]})})}),j&&e.jsx(fe,{show:j,handleClose:()=>{f(!1)}})]})})]}):e.jsx(Ce,{type:"company",actionType:"lease"})]})})})},lt=({show:r,handleClose:l,handleShowAlert:a,leaseData:t})=>{const[x,u]=i.useState(!1),{data:p,post:d}=me({leaseId:t.lease_id}),o=()=>{d(reverseUrl("delete_lease"),{onStart:()=>{u(!0)},onSuccess:h=>{a("Lease terminated successfully"),u(!1)},onError:h=>{T.error("Something went wrong! Please try again"),u(!1)},onFinish:()=>{l()}})};return e.jsx("div",{className:"container-xl p-5",children:e.jsx("div",{className:"card card-raised",children:e.jsx("div",{className:"card-body p-4",children:e.jsxs(k,{show:r,onHide:l,size:"md",backdrop:"static",centered:!0,children:[e.jsx(k.Header,{closeButton:!0,className:"h4 bg-info text-white text-center text-uppercase",children:"Confirm Lease Termination"}),e.jsxs(k.Body,{className:"p-4 d-flex justify-content-between align-items-center gap-4",children:[e.jsx(pe,{}),e.jsxs("p",{className:"my-3 text-center",children:["Are you sure you want to terninate lease for ",t.name,"? This action cannot be undone."]})]}),e.jsxs(k.Footer,{className:"p-4 d-flex justify-content-end gap-4",children:[e.jsxs(V,{onClick:l,variant:"secondary",children:[e.jsx("i",{className:"material-icons",children:"cancel"}),"Cancel"]}),e.jsxs(V,{onClick:o,variant:"danger",children:[e.jsx("i",{className:"material-icons",children:"done"}),"Delete"]})]})]})})})})},ot=({show:r,handleClose:l,url:a,setVerified:t,verification_type:x,setCreditInfo:u})=>{const[p,d]=i.useState(!1),[o,h]=i.useState({}),{data:b,setData:S,post:m,reset:c}=me({otp:"",verification_type:x}),[j,f]=i.useState(!1),[s,O]=i.useState(30);i.useEffect(()=>{const C=setInterval(()=>{O(L=>L<=1?(clearInterval(C),f(!0),0):L-1)},1e3);return()=>clearInterval(C)},[]);const n=()=>de(void 0,null,function*(){f(!1);try{(yield q.get(reverseUrl("new_otp"))).data.status==="success"?T.success("OTP sent successfully"):T.error("Something went wrong! Please try again")}catch(C){T.error("Something went wrong! Please try again")}}),A=C=>S(M(B({},b),{[C.target.id]:C.target.value})),F=()=>b.otp.length!==4?(h({otp:"otp must be four digits"}),!1):parseInt(b.otp,10)?!0:(h({otp:"otp must be a number"}),!1),U=C=>{console.log("indi"),C.preventDefault(),F()&&(m(reverseUrl(a),{onStart:()=>{d(!0)},onSuccess:L=>{l(),c(),T.success("Verification successful"),d(!1),typeof t=="function"&&t(!0)},onError:L=>{T.error("Something went wrong! Please try again"),h(L),console.log(erros),d(!1)}}),d(!1))};return e.jsx(e.Fragment,{children:e.jsx(k,{size:"lg",show:r,onHide:l,centered:!0,children:e.jsx("div",{children:e.jsxs("div",{className:"card card-raised",children:[e.jsx("div",{className:"card-header bg-info px-4",children:e.jsxs("div",{className:`d-flex justify-content-between
                                align-items-center`,children:[e.jsxs("div",{className:"me-4",children:[e.jsx("h2",{className:"display-6 mb-0 text-white",children:"Verify OTP"}),e.jsx("div",{className:"card-text"})]}),e.jsx("div",{className:"d-flex gap-2"})]})}),e.jsx("div",{className:"card-body p-4",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body p-4",style:{borderStyle:"solid",borderColor:"#26a69a"},children:[e.jsx(k.Body,{children:e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"col-md-12",children:[e.jsx("div",{children:e.jsx("p",{children:x==="individual"?"Enter the 4-digit code we sent to user's mobile number. This code will expire after 5 minutes":"Enter the 4-digit code we sent to user's email. This code will expire after 5 minutes"})}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Verification Code"}),e.jsx("input",{value:b.otp,onChange:A,type:"text",name:"otp",id:"otp",placeholder:"Enter your 4 digit otp",className:"form-control form-control-sm"}),o&&e.jsx("div",{className:"text-danger mt-1",children:o.otp})]})})]}),e.jsxs("div",{className:"mt-5 d-flex gap-4 align-items-center ",children:[e.jsxs("p",{children:["Didn't receive code?",e.jsx("button",{onClick:n,className:"ms-2 text-decoration-underline border-0 bg-transparent text-info",disabled:j===!1,children:"Resend Code"})]}),s>0&&e.jsx("p",{className:"text-success",children:`Resend code in ${s} seconds`})]})]})}),e.jsx(k.Footer,{children:e.jsx(V,{className:"text-white",variant:"info",onClick:C=>U(C),disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ml-2",children:"processing.."})]}):"Verify"})})]})})})]})})})})};function Q({title:r,children:l,noBoundary:a}){const t=a?"bg-white mb-3":"bg-white rounded-2 border overflow-hidden border-dark shadow-sm mb-3";return e.jsxs("div",{className:t,children:[e.jsx("div",{className:"rounded-top-2 custom-bg-grey text-white text-center p-1",children:le.capitalize(r)}),l]})}function dt({data:r}){let l=0;return Object.keys(r).forEach(a=>l+=r[a]),e.jsx(Q,{title:"aged analysis",children:e.jsxs("table",{className:"table table-sm table-responsive table-bordered  mb-0",children:[e.jsx("thead",{className:"custom-bg-grey-2 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{children:"90+ Days"}),e.jsx("th",{children:"90 Days"}),e.jsx("th",{children:"60 Days"}),e.jsx("th",{children:"30 Days"}),e.jsx("th",{children:"Current"}),e.jsx("th",{children:"total"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{children:r.oneTwentyDays}),e.jsx("td",{children:r.ninetyDays}),e.jsx("td",{children:r.sixtyDays}),e.jsx("td",{children:r.thirtyDays}),e.jsx("td",{children:r.current}),e.jsxs("td",{children:["$",l]})]})})]})})}function it(r,l){const[a,t]=i.useState(!r),[x,u]=i.useState(r),[p,d]=i.useState(""),[o,h]=i.useState(!1),{Auth:b}=Pe().props,S=`${b.user_profile.first_name} ${b.user_profile.last_name}`;function m(c){c.preventDefault(),h(!0),d("");const j=Object.fromEntries(new FormData(c.target).entries());j.client_id=l.toString(),q.put(reverseUrl("debtor_intelligence"),j).then(f=>{const s={text:f.data.note,user:f.data.user_name,timestamp:f.data.updated_at||f.data.created_at};u(s),d(""),h(!1),t(!1)}).catch(f=>{f instanceof he?d(f.response.status===500?`Error: ${f.response.statusText}`:JSON.stringify(f.response.data)):d(f),h(!1),t(!x)})}return{data:x,isEditMode:a,handleSave:m,loggedInUser:S,setIsEditMode:t,error:p,setError:d,isLoading:o}}function ct({data:r,clientId:l}){const{data:a,isEditMode:t,handleSave:x,loggedInUser:u,setIsEditMode:p,error:d,setError:o,isLoading:h}=it(r,l);return e.jsx(Q,{title:"debtor intelligence",children:e.jsxs("div",{className:"px-3 py-2",children:[d&&e.jsxs("p",{className:"d-flex align-items-start gap-1 small text-danger",children:[e.jsx("button",{type:"button",onClick:()=>o(""),className:"btn-close btn-sm"}),le.truncate(d,{length:150})]}),t?e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"note",className:"form-label",children:a&&a.text?"Edit note":"No note found, create new note"}),e.jsx("textarea",{className:"form-control",name:"note",id:"note",rows:"2",defaultValue:a&&a.text?a.text:"",placeholder:"type here...",disabled:h})]}),e.jsx("b",{className:"d-block my-1",children:u}),e.jsx("div",{className:"small text-success",children:"today"}),e.jsx("button",{disabled:h,type:"submit",className:"d-block btn btn-info text-white w-100 mt-3",children:h?"Saving...":"Save"})]}):e.jsxs("div",{children:[e.jsx("small",{children:a.text}),e.jsx("b",{className:"d-block my-1",children:a.user}),e.jsx("div",{className:"small text-success",children:ue(a.timestamp)}),e.jsx("button",{onClick:()=>p(!0),type:"button",className:"d-block btn btn-info w-100 mt-4 text-white",children:"Edit"})]})]})})}function mt(r,l){const[a,t]=i.useState(!r),[x,u]=i.useState(r),[p,d]=i.useState(""),[o,h]=i.useState(!1);function b(S){S.preventDefault(),h(!0),d("");const m=Object.fromEntries(new FormData(S.target).entries());m.client_id=l.toString(),m.other_numbers=m.other_numbers.split(",").filter(Boolean).map(c=>c.trim()),q.put(reverseUrl("update_client_contact_details"),m).then(c=>{const j={contactPerson:`${c.data.firstname} ${c.data.surname}`,smsNumber:c.data.sms_number,otherNumbers:c.data.other_numbers?c.data.other_numbers.join(", "):"",emailAddress:c.data.email_address,address:c.data.address};u(j),d(""),h(!1),t(!1)}).catch(c=>{c instanceof he?d(c.response.status===500?`Error: ${c.response.statusText}`:JSON.stringify(c.response.data)):d(c),h(!1),t(!x)})}return{data:x,isEditMode:a,handleSave:b,setIsEditMode:t,error:p,setError:d,isLoading:o}}function ht({data:r,clientId:l}){const{data:a,isEditMode:t,handleSave:x,setIsEditMode:u,error:p,setError:d,isLoading:o}=mt(r,l);return e.jsx(Q,{title:"contact details",children:e.jsxs("div",{className:"py-2",children:[p&&e.jsxs("p",{className:"d-flex align-items-start px-2 gap-1 small text-danger",children:[e.jsx("button",{type:"button",onClick:()=>d(""),className:"btn-close btn-sm"}),le.truncate(p,{length:150})]}),t?e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center py-1 px-2 border-bottom custom-bg-whitesmoke",children:[e.jsx("label",{htmlFor:"firstname",className:"form-label small",children:"First Name"}),e.jsx("input",{type:"text",className:"form-control form-control-sm w-50 rounded-2",name:"firstname",id:"firstname",disabled:o,defaultValue:a&&a.contactPerson?a.contactPerson.trim().split(" ")[0]:""})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center py-1 px-2 border-bottom",children:[e.jsx("label",{htmlFor:"surname",className:"form-label small",children:"Surname"}),e.jsx("input",{type:"text",className:"form-control form-control-sm w-50 rounded-2",name:"surname",id:"surname",disabled:o,defaultValue:a&&a.contactPerson?a.contactPerson.trim().split(" ")[1]:""})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center py-1 px-2 border-bottom custom-bg-whitesmoke",children:[e.jsx("label",{htmlFor:"sms_number",className:"form-label small",children:"SMS Number"}),e.jsx("input",{type:"text",className:"form-control form-control-sm w-50 rounded-2",name:"sms_number",id:"sms_number",disabled:o,defaultValue:a&&a.smsNumber?a.smsNumber:""})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center py-1 px-2 border-bottom",children:[e.jsx("label",{htmlFor:"other_numbers",className:"form-label small",children:"Other Numbers (comma separated)"}),e.jsx("input",{type:"text",className:"form-control form-control-sm w-50 rounded-2",name:"other_numbers",id:"other_numbers",disabled:o,defaultValue:a&&a.other_numbers?a.other_numbers:"",placeholder:"(comma separated)"})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center py-1 px-2 border-bottom custom-bg-whitesmoke",children:[e.jsx("label",{htmlFor:"email_address",className:"form-label small",children:"Email Address"}),e.jsx("input",{type:"email",className:"form-control form-control-sm w-50 rounded-2",name:"email_address",id:"email_address",disabled:o,defaultValue:a&&a.emailAddress?a.emailAddress:""})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center py-1 px-2 border-bottom",children:[e.jsx("label",{htmlFor:"address",className:"form-label small",children:"Address"}),e.jsx("input",{type:"text",className:"form-control form-control-sm w-50 rounded-2",name:"address",id:"address",disabled:o,defaultValue:a&&a.address?a.address:""})]}),e.jsx("button",{disabled:o,type:"submit",className:"d-block btn btn-info text-white w-100 mt-3",children:o?"Saving...":"Save"})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex gap-2 py-1 px-2 border-bottom custom-bg-whitesmoke",children:[e.jsx("div",{children:"Contact Person: "}),e.jsx("div",{className:"flex-grow-1 text-center",children:a.contactPerson})]}),e.jsxs("div",{className:"d-flex gap-2 py-1 px-2 border-bottom",children:[e.jsx("div",{children:"SMS Number: "}),e.jsx("div",{className:"flex-grow-1 text-center",children:a.smsNumber})]}),e.jsxs("div",{className:"d-flex gap-2 py-1 px-2 border-bottom custom-bg-whitesmoke",children:[e.jsx("div",{children:"Other Numbers: "}),e.jsx("div",{className:"flex-grow-1 text-center",children:a.otherNumbers})]}),e.jsxs("div",{className:"d-flex gap-2 py-1 px-2 border-bottom",children:[e.jsx("div",{children:"Email Address: "}),e.jsx("div",{className:"flex-grow-1 text-center",children:a.emailAddress})]}),e.jsxs("div",{className:"d-flex gap-2 py-1 px-2 border-bottom custom-bg-whitesmoke",children:[e.jsx("div",{children:"Address: "}),e.jsx("div",{className:"flex-grow-1 text-center",children:a.address})]}),e.jsx("div",{className:"mt-4 px-2",children:e.jsx("button",{onClick:()=>u(!0),type:"button",className:"d-block btn btn-info w-100 text-white",children:"Edit"})})]})]})})}function ut({data:r}){return e.jsx(Q,{title:"forecast inflows",children:e.jsxs("table",{className:"table table-sm table-responsive table-bordered  mb-0",children:[e.jsx("thead",{className:"custom-bg-grey-2 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{children:"0-14 Days"}),e.jsx("th",{children:"15-30 Days"}),e.jsx("th",{children:"31-59 Days"}),e.jsx("th",{children:"60+ Days"}),e.jsx("th",{children:"total"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{children:r.zeroToFourteenDays}),e.jsx("td",{children:r.fifteenToThirtyDays}),e.jsx("td",{children:r.thirtyOneToFiftyNineDays}),e.jsx("td",{children:r.sixtyPlusDays}),e.jsxs("td",{children:["$",r.total]})]})})]})})}function xt(r,l){const[a,t]=i.useState(r),[x,u]=i.useState(""),[p,d]=i.useState(!1),[o,h]=i.useState("note");function b(S){S.preventDefault(),d(!0),u("");const m=Object.fromEntries(new FormData(S.target).entries());m.client_id=l.toString(),m.reminder_type=o.toUpperCase(),o==="note"&&(m.action_date=new Date().toISOString().split("T")[0]),q.post(reverseUrl("communication_history"),m).then(c=>{t(j=>[...j,{text:c.data.message,actionDone:c.data.action_done,user:c.data.user_name,communicationType:c.data.reminder_type.toLowerCase(),timestamp:c.data.created_at}]),u(""),d(!1)}).catch(c=>{c instanceof he?u(c.response.status===500?`Error: ${c.response.statusText}`:JSON.stringify(c.response.data)):u(c),d(!1)})}return{messages:a,handleSubmit:b,error:x,setError:u,isLoading:p,remainderType:o,setRemainderType:h}}function pt({messages:r,clientId:l}){const{handleSubmit:a,messages:t,error:x,setError:u,isLoading:p,remainderType:d,setRemainderType:o}=xt(r,l);return e.jsx(Q,{noBoundary:!0,title:"communication history",children:e.jsxs("div",{className:"custom-bg-whitesmoke px-5 py-3",children:[e.jsxs("div",{className:"custom-vh-50 custom-overflow-y-auto",children:[t.map((h,b)=>e.jsxs("div",{className:"custom-message py-2 px-3 border shadow-sm mb-3",children:[e.jsx("small",{children:h.text+(h.communicationType.toLowerCase().trim()!=="note"&&h.actionDone?` (action date: ${ue(h.actionDone)})`:"")}),e.jsxs("div",{className:"mt-2 d-flex justify-content-end align-items-center text-end gap-3",children:[e.jsx("small",{children:e.jsxs("b",{children:[h.user,h.communicationType&&" | "+h.communicationType.toLowerCase()]})}),e.jsx("small",{className:"text-success",children:ue(h.timestamp)})]})]},b)),t.length===0&&e.jsxs("small",{className:"h-100 text-grey d-flex justify-content-center align-items-center text-center",children:["No communication ",e.jsx("br",{})," history"]})]}),e.jsxs("form",{onSubmit:a,className:"border-top border-4 w-100 pt-3",children:[x&&e.jsxs("p",{className:"d-flex align-items-start gap-1 small text-danger",children:[e.jsx("button",{type:"button",onClick:()=>u(""),className:"btn-close btn-sm"}),le.truncate(x,{length:150})]}),e.jsx("textarea",{rows:2,name:"message",id:"message",placeholder:"Type message here...",className:"d-block w-100 p-2 custom-form-control border-0 border-bottom border-bottom-3 border-dark",required:!0,disabled:p}),e.jsxs("div",{className:"d-flex justify-content-center pt-2 gap-2 align-items-center",children:[e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"reminder_type",disabled:p,value:"note",id:"reminder_type-note",checked:d==="note",onChange:h=>o(h.target.value)}),e.jsx("label",{className:"form-check-label",htmlFor:"reminder_type-note",children:"Note"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"reminder_type",disabled:p,value:"email",id:"reminder_type-email",checked:d==="email",onChange:h=>o(h.target.value)}),e.jsx("label",{className:"form-check-label",htmlFor:"reminder_type-email",children:"Email"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"reminder_type",disabled:p,value:"sms",id:"reminder_type-sms",checked:d==="sms",onChange:h=>o(h.target.value)}),e.jsx("label",{className:"form-check-label",htmlFor:"reminder_type-sms",children:"SMS"})]})]}),d!=="note"&&e.jsxs("div",{className:"d-flex my-2 gap-2 align-items-center justify-content-center",children:[e.jsxs("label",{htmlFor:"action_date",className:"small d-block text-nowrap form-label",children:["Send ",d," on:"]}),e.jsx("input",{min:new Date().toISOString().split("T")[0],type:"date",className:"form-control form-control-sm rounded-4",name:"action_date",id:"action_date",required:!0})]}),e.jsx("button",{disabled:p,type:"submit",className:"d-block btn btn-info w-100 mt-4 text-white",children:p?"Submiting...":"Submit"})]})]})})}function ft(r,l){const[a,t]=i.useState(r),[x,u]=i.useState(""),[p,d]=i.useState(!1),[o,h]=i.useState([]);function b(){d(!0),u("");const c={plans:o.map(j=>M(B({},j),{client_id:l.toString()}))};q.post(reverseUrl("payment_plans"),c).then(j=>{h([]),t(f=>[...f,...j.data.plans.map(s=>({id:s.id,date:s.expected_pay_date,person:s.spoke_with,amount:s.amount}))]),u(""),d(!1)}).catch(j=>{j instanceof he?u(j.response.status===500?`Error: ${j.response.statusText}`:JSON.stringify(j.response.data)):u(j),d(!1)})}function S(c){h(j=>[...j,c])}function m(){h([])}return{paymentPlans:a,newPaymentPlans:o,addNewPaymentPlan:S,confirmNewPaymentPlans:b,clearNewPaymentPlans:m,error:x,setError:u,isLoading:p}}function bt({addNewPaymentPlan:r,tenantName:l}){function a(t){t.preventDefault();const x=Object.fromEntries(new FormData(t.target).entries());r(x)}return e.jsx(Q,{title:"payment plan",children:e.jsxs("form",{onSubmit:a,className:"p-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center gap-5 mb-2",children:[e.jsx("label",{htmlFor:"spoke_with",className:"text-nowrap",children:"Person spoken with:"}),e.jsx("input",{type:"text",name:"spoke_with",id:"spoke_with",placeholder:"Person spoken with here",className:"custom-form-control border-0 border-bottom border-bottom-3 border-dark",required:!0,value:l,readOnly:!0})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center gap-5 mb-2",children:[e.jsx("label",{htmlFor:"expected_pay_date",className:"text-nowrap",children:"Expected Pay Date:"}),e.jsx("input",{type:"date",name:"expected_pay_date",id:"expected_pay_date",className:"custom-form-control border-0 custom-pointer border-bottom border-bottom-3 border-dark",required:!0,defaultValue:new Date().toISOString().split("T")[0],min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center gap-5 mb-2",children:[e.jsx("label",{htmlFor:"amount",className:"text-nowrap",children:"Amount ($):"}),e.jsx("input",{min:0,type:"number",name:"amount",id:"amount",placeholder:"Amount in $",className:"custom-form-control border-0 border-bottom border-bottom-3 border-dark",required:!0})]}),e.jsx("button",{type:"submit",className:"d-block btn btn-info w-100 mt-4 text-white",children:"Add to payment plan"})]})})}function jt({paymentPlans:r}){return e.jsx(Q,{title:"payment plans",children:e.jsx("div",{className:"custom-mx-h-15 overflow-auto",children:e.jsxs("table",{className:"table table-sm table-responsive table-bordered mb-0",children:[e.jsx("thead",{className:"custom-bg-grey-2 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Plan ID"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Date"})]})}),e.jsxs("tbody",{children:[r.map((l,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:l.id||a}),e.jsx("td",{children:l.amount}),e.jsx("td",{children:Be(l.date)})]},l.id)),r.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center small text-grey py-3",children:"No payment plans"})})]})]})})})}function Nt({newPaymentPlans:r,confirmNewPaymentPlans:l,clearNewPaymentPlans:a,error:t,setError:x,isLoading:u}){return e.jsx(Q,{title:"plan details",children:e.jsxs("div",{className:"p-3 pb-2",children:[e.jsxs("div",{className:"custom-h-07 overflow-auto",children:[r.map((p,d)=>e.jsx("div",{className:"p-1 small border-bottom",children:`${p.spoke_with} promised to pay USD${p.amount} on ${Be(p.expected_pay_date)}`},d)),r.length===0&&e.jsx("div",{className:"text-center small text-grey py-3",children:"No new payment plans"})]}),e.jsxs("div",{className:"pt-2 bg-white",children:[t&&e.jsxs("p",{className:"d-flex align-items-start gap-1 small text-danger",children:[e.jsx("button",{type:"button",onClick:()=>x(""),className:"btn-close btn-sm"}),le.truncate(t,{length:150})]}),e.jsxs("div",{className:"d-flex gap-3",children:[e.jsx("button",{type:"button",onClick:l,className:"d-block btn btn-info w-100 text-white",disabled:u||!r.length,children:u?"Saving...":"Save plan"}),e.jsx("button",{type:"button",onClick:a,className:"d-block btn btn-dark w-100 text-white",disabled:u||!r.length,children:"Clear All"})]})]})]})})}function yt({paymentPlans:r,clientId:l,tenantName:a}){const{paymentPlans:t,newPaymentPlans:x,addNewPaymentPlan:u,confirmNewPaymentPlans:p,clearNewPaymentPlans:d,error:o,setError:h,isLoading:b}=ft(r,l);return e.jsxs(e.Fragment,{children:[e.jsx(bt,{addNewPaymentPlan:u,clientId:l,tenantName:a}),e.jsx(Nt,{newPaymentPlans:x,confirmNewPaymentPlans:p,clearNewPaymentPlans:d,error:o,setError:h,isLoading:b}),e.jsx(jt,{paymentPlans:t})]})}function gt({showModal:r,hideClientView:l,data:a,error:t,isLoading:x,clientId:u}){return e.jsx(e.Fragment,{children:e.jsxs(k,{show:r,onHide:l,fullscreen:!0,contentClassName:"custom-bg-whitesmoke",children:[e.jsx(k.Header,{className:"p-0",children:e.jsxs("div",{className:"w-100 p-2 text-center bg-info position-relative",children:[e.jsx("h4",{className:"text-white",children:x||t?"Client View":a.tenantName}),e.jsx("button",{type:"button",onClick:l,className:"btn position-absolute top-0 end-0 h-100 d-flex align-items-center text-white",children:e.jsx("i",{className:"material-icons fs-3 px-4",children:"close"})})]})}),e.jsx(k.Body,{children:e.jsxs("div",{className:"position-relative custom-mn-h-5",children:[x&&e.jsxs("div",{className:"text-center position-absolute top-50 start-50 translate-middle",children:[e.jsx("div",{className:"spinner-border text-info spinner-border-md",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{children:"Loading...please wait"})]}),t&&e.jsxs("div",{className:"text-center text-danger position-absolute top-50 start-50 translate-middle",children:[e.jsx("p",{children:e.jsx("i",{className:"material-icons fs-1",children:"warning"})}),e.jsxs("p",{children:["Error: ",le.truncate(t,{length:500})]})]}),!(x||t)&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"row row-cols-3 align-items-stretch",children:[e.jsxs("div",{className:"col p-1",children:[e.jsx(dt,{data:a.agedAnalysis}),e.jsx(ct,{data:a.debtorIntelligence,clientId:u}),e.jsx(ht,{data:a.contactDetails,clientId:u}),e.jsxs("div",{className:"d-flex align-content-center justify-content-center gap-2 p-2 rounded-2",children:[e.jsx("button",{type:"button",className:"btn btn-danger",children:"Red Flag"}),e.jsx("button",{type:"button",className:"btn btn-warning",children:"Orange Flag"})]})]}),e.jsx("div",{className:"col p-1",children:e.jsx(pt,{messages:a.communicationHistory,clientId:u})}),e.jsxs("div",{className:"col p-1",children:[e.jsx(ut,{data:a.forecastInflows}),e.jsx(yt,{clientId:u,paymentPlans:a.paymentPlans,tenantName:a.tenantName})]})]})})]})})]})})}const vt={tenantName:"[Acc No.] Company 8",agedAnalysis:{ninetyDays:100,sixtyDays:0,thirtyDays:20,current:200},debtorIntelligence:{text:"Lorem, ipsum dolor sit amet consectetur adipisicing elit. ipsa repellat consequatur",timestamp:"2022-03-04 02:00:00",user:"George59"},contactDetails:{contactPerson:"John Doe",smsNumber:"+263 71 882 2460",otherNumbers:"+263 71 882 2460",emailAddress:"email@example.com",address:"address 5"},communicationHistory:[{text:"Adipisicing elit. Dignissimos perspiciatis, ipsa repellat consequatur, nesciunt hic enim deserunt ",timestamp:"2022-01-01 12:00:00",user:"George59",communicationType:"SMS"},{text:"consectetur adipisicing elit. Dignissimos perspiciatis, ipsa repellat consequatur, nesciunt hic enim deserunt voluptatibus, voluptatum",timestamp:"2022-01-01 12:00:00",user:"George59",communicationType:"email"},{text:"Lorem, ipsum dolor sit amet consectetur.",timestamp:"2022-01-01 12:00:00",user:"John Doe",communicationType:"email"}],forecastInflows:{zeroToFourteenDays:0,fifteenToThirtyDays:5562.45,thirtyOneToFiftyNineDays:0,sixtyPlusDays:0},paymentPlans:[{person:"person11",id:11,date:"4 September 2024",amount:450},{person:"person12",id:12,date:"20 September 2024",amount:450},{person:"person13",id:13,date:"30 September 2024",amount:400}]};function wt(){const[r,l]=i.useState(!1),[a,t]=i.useState(vt),[x,u]=i.useState(""),[p,d]=i.useState(!1),[o,h]=i.useState(!1);function b(m){h(m.id),l(!0),d(!0),u(""),q(reverseUrl("client_details"),{params:{lease_id:m.lease_id}}).then(c=>{const j={tenantName:m.name,agedAnalysis:{oneTwentyDays:c.data.aged_analysis["120_days_plus"],ninetyDays:c.data.aged_analysis["90_days"],sixtyDays:c.data.aged_analysis["60_days"],thirtyDays:c.data.aged_analysis["30_days"],current:c.data.aged_analysis.current},contactDetails:{contactPerson:`${c.data.client.firstname} ${c.data.client.surname}`,smsNumber:c.data.client.sms_number,otherNumbers:c.data.other_numbers?c.data.client.other_numbers.join(", "):"",emailAddress:c.data.client.email,address:c.data.client.address},paymentPlans:c.data.payment_plans.map(f=>({id:f.id,person:f.spoke_with,date:f.expected_pay_date,amount:f.amount})),communicationHistory:c.data.communication_history.map(f=>({text:f.message,timestamp:f.created_at,user:f.user_name,actionDone:f.action_done?f.action_done:null,communicationType:f.type})),debtorIntelligence:Object.values(c.data.debtor_intelligence).length&&Object.values(c.data.debtor_intelligence).every(Boolean)?{text:c.data.debtor_intelligence.note,timestamp:c.data.debtor_intelligence.updated_at,user:c.data.debtor_intelligence.user_name}:null,forecastInflows:{zeroToFourteenDays:c.data.forecast_inflows["0-14"],fifteenToThirtyDays:c.data.forecast_inflows["15-30"],thirtyOneToFiftyNineDays:c.data.forecast_inflows["31-59"],sixtyPlusDays:c.data.forecast_inflows["60+"],totoal:c.data.forecast_inflows.total}};t(j),u(""),d(!1)}).catch(c=>{t(null),u(c.response.data.error),d(!1)})}function S(){l(!1)}return{showModal:r,openClientView:b,hideClientView:S,data:a,error:x,isLoading:p,clientId:o}}const St=({leases:r,total_pages:l,total_items:a,current_page:t})=>{const[x,u]=i.useState(!1),[p,d]=i.useState(!1),[o,h]=i.useState({}),[b,S]=i.useState([]),[m,c]=i.useState({}),[j,f]=i.useState(!1),[s,O]=i.useState(!1),[n,A]=i.useState(0),[F,U]=i.useState(!1),[C,L]=i.useState(!1),[Y,z]=i.useState(""),[G,ee]=i.useState(!1),[te,J]=i.useState(!1),[X,_]=i.useState(""),[D,ae]=i.useState(""),{showModal:N,openClientView:v,hideClientView:I,data:H,newPaymentPlans:W,addNewPaymentPlan:w,confirmNewPaymentPlans:ne,clearNewPaymentPlans:re,error:P,isLoading:y,clientId:$}=wt(),R=(g,K)=>{J(!0),ae(K),_(g)},se=()=>{J(!1),ae(""),_("")};i.useEffect(()=>{q.post(reverseUrl("open_subscription")).then(g=>{S(g.data)}).catch(g=>{})},[S]);const Z=document.getElementById("hide-footer");i.useEffect(()=>(Z!==null&&document.getElementById("footer").classList.add("d-none"),()=>{Z!==null&&document.getElementById("footer").classList.remove("d-none")}),[Z]);const oe=Pe().props.error;return oe&&T.error(oe),e.jsxs("main",{className:"position-relative",id:"hide-footer",style:{height:"100%"},children:[e.jsx(gt,{showModal:N,hideClientView:I,data:H,newPaymentPlans:W,addNewPaymentPlan:w,confirmNewPaymentPlans:ne,clearNewPaymentPlans:re,isLoading:y,error:P,clientId:$}),X&&e.jsxs(Se,{onClose:se,show:te,delay:1e4,className:"w-100 shadow-none ",style:{background:"#dcfce7"},autohide:!0,children:[e.jsxs(Se.Header,{className:"text-uppercase w-100",children:[e.jsx("strong",{className:"me-auto",children:D?`Following message has been sent to ${D}`:""}),e.jsx("small",{className:"text-muted text-capitalize ms-auto",children:"just now"})]}),e.jsx("p",{className:"p-4",children:X})]}),e.jsx("div",{className:"container-xl",children:e.jsxs("div",{className:"card card-raised mb-5",children:[e.jsx("div",{className:"card-header px-4",style:{height:"50px",backgroundColor:"#32a4a8"},children:e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx("div",{className:"",children:e.jsx("h2",{className:"display-6 tf-color",children:"Lease Management"})})})}),e.jsxs("div",{className:"card-body p-4 position-relative ",children:[e.jsx("div",{className:"row mb-2",children:e.jsx("div",{className:"col-md-4",children:e.jsx(Xe,{searchBy:"name"})})}),e.jsx("div",{className:"",style:{backgroundColor:"#428f38"},children:e.jsx("h5",{className:"text-center tf-color",children:"Active Lease"})}),e.jsx("div",{className:"table-responsive tableFixHead",children:e.jsxs("table",{className:"table-responsive table table-bordered",children:[e.jsx("thead",{className:"bg-white",children:e.jsxs("tr",{style:{borderTop:"0px"},children:[e.jsx("th",{scope:"col",style:{width:"100px"},children:"No."}),e.jsx("th",{scope:"col",style:{},children:"Tenant"}),e.jsx("th",{scope:"col",style:{},children:"Customer Number"}),e.jsx("th",{scope:"col",className:"text-end",children:"Rent Owing"}),e.jsx("th",{scope:"col",colSpan:3,className:"tf-borderRight",children:e.jsx("span",{style:{visibility:"hidden"},children:"Actions to be done"})})]})}),e.jsx("tbody",{children:r==null?void 0:r.map((g,K)=>e.jsxs("tr",{className:"w-100 py-2",children:[e.jsx("th",{scope:"row",children:K+1}),e.jsx("td",{children:e.jsx("button",{title:"double click to view client",type:"button",onDoubleClick:()=>v(g),className:"custom-btn text-decoration-underline",children:g.name})}),e.jsx("td",{children:g.mobile_number}),e.jsxs("td",{className:`bg-${g.color} text-white text-end`,style:{backgroundColor:g.color=="light-red"?"#f87171":""},children:[g.currency,be(g.owing_amount)]}),e.jsx("td",{className:"bg-info text-white text-center tfRow",onClick:()=>{O(!0),h(g)},children:"Receipt"}),e.jsx("td",{className:"bg-primary text-white text-center tfRow",onClick:()=>{d(!0),u(!1),h(g),c({type:g.is_company?"company":"individual"})},children:"Adjust"}),e.jsx("td",{className:"bg-danger text-white text-center tfRow",onClick:()=>{f(!0),h(g)},children:"Terminate"})]},"lease"+K))})]})}),e.jsx(Ke,{currentPage:t,totalPages:l}),(m==null?void 0:m.type)==="individual"&&x&&e.jsx(Te,{action:"add",show:x,handleClose:()=>{u(!1),h({})},setShowVerify:U,lesseeDetails:o,subscriptionPeriod:n,handleShowAlert:R}),(m==null?void 0:m.type)==="individual"&&p&&e.jsx(Te,{action:"edit",show:p,handleClose:()=>{d(!1),h({})},handleShowAlert:R,lesseeDetails:o,subscriptionPeriod:o.lease_period}),(m==null?void 0:m.type)==="company"&&x&&e.jsx(_e,{action:"add",show:x,handleClose:()=>{u(!1),h({})},lesseeDetails:o,subscriptionPeriod:n,handleShowAlert:R}),(m==null?void 0:m.type)==="company"&&p&&e.jsx(_e,{action:"edit",show:p,handleClose:()=>{d(!1),h({})},handleShowAlert:R,lesseeDetails:o,subscriptionPeriod:o.lease_period}),j&&e.jsx(lt,{show:j,handleClose:()=>{f(!1),h({})},handleShowAlert:R,leaseData:o}),s&&e.jsx(fe,{show:s,handleClose:g=>de(void 0,null,function*(){_(g),O(!1),J(!0),h({})}),leaseDetails:o,myKey:"leases"}),F&&e.jsx(ot,{show:F,handleClose:()=>{U(!1)},url:"client-individual-verify-otp",setVerified:L,verification_type:Y})]})]})}),e.jsx("div",{className:"w-100 ",style:{backgroundColor:"#e3d329",position:"fixed",bottom:"0",right:"0",width:"100%"},children:e.jsx(ze,{isVisible:G,setIsVisible:ee,trigger:e.jsxs("div",{style:{backgroundColor:"#e3d329"},className:"position-relative tf-color",children:[e.jsx("h5",{className:"text-center tf-color py-2",children:"Open Subscriptions"}),e.jsx("i",{className:"icon material-icons position-absolute top-50 translate-middle",style:{right:"35%",fontSize:"50px",transform:"translateY(-50%)"},children:"keyboard_arrow_up"})]}),children:e.jsx(Je,{title:"Open Subscriptions",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderTop:"0px"},children:[e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"No."}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Type"}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Open Slots"}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Period (months)"}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Start Date"}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"End Date"}),e.jsx("th",{scope:"col",colSpan:"2",className:"tf-borderRight"})]})}),e.jsx("tbody",{children:b==null?void 0:b.map((g,K)=>e.jsx(Fe.Fragment,{children:g.open_slots>0&&e.jsxs("tr",{children:[e.jsx("th",{scope:"row",children:K+1}),e.jsx("td",{children:g.subscription_class}),e.jsx("td",{children:g.open_slots}),e.jsx("td",{children:g.period_length}),e.jsx("td",{children:g.start_date}),e.jsx("td",{children:g.end_date}),e.jsx("td",{colSpan:"2",className:`${g.open_slots===0?"bg-gray":"bg-success"} text-white text-center tfRow`,onClick:()=>{g.open_slots!==0&&(u(!0),d(!1),ee(!1),h({}),c({type:g.subscription_class}),z(g.subscription_class),A(g.period_length))},children:"Activate"})]},"subscription"+K)},K))})]})})})})})]})};St.layout=r=>e.jsx(De,{children:r,title:"Leases"});export{St as default};
