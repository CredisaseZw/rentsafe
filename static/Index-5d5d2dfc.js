var Me=Object.defineProperty,Ae=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var Ne=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var ye=Math.pow,fe=(o,d,t)=>d in o?Me(o,d,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[d]=t,k=(o,d)=>{for(var t in d||(d={}))Ne.call(d,t)&&fe(o,t,d[t]);if(se)for(var t of se(d))je.call(d,t)&&fe(o,t,d[t]);return o},I=(o,d)=>Ae(o,Le(d));var oe=(o,d)=>{var t={};for(var i in o)Ne.call(o,i)&&d.indexOf(i)<0&&(t[i]=o[i]);if(o!=null&&se)for(var i of se(o))d.indexOf(i)<0&&je.call(o,i)&&(t[i]=o[i]);return t};var re=(o,d,t)=>new Promise((i,b)=>{var x=n=>{try{u(t.next(n))}catch(c){b(c)}},m=n=>{try{u(t.throw(n))}catch(c){b(c)}},u=n=>n.done?i(n.value):Promise.resolve(n.value).then(x,m);u((t=t.apply(o,d)).next())});import{r as h,j as e,a as ce,b as X,u as Se,d as Re,R as Ye}from"./main-cecc6bb7.js";import{b as Fe,d as Ve,F as Ge,u as xe,a as $e,c as pe,C as Ue,M as $}from"./Modal-f4f0c70d.js";import{E as He,e as qe}from"./removeClass-60541855.js";import{a as le,R as be,W as ze,L as Je}from"./Layout-5242a342.js";import{h as G}from"./moment-686b5dfa.js";import{_ as T,I as ge}from"./index-43a92dce.js";import{f as de}from"./formatting-345d2430.js";import{M as Te}from"./MultipleUpload-d4ffc7f9.js";import{S as We}from"./search-d01cbadb.js";import{B as me}from"./Button-8d3d904d.js";import{B as Ze,D as Xe}from"./DrawerContent-b13dd4d2.js";import{S as Ke,P as Qe}from"./PaginationControls-b1fbb6cd.js";import{l as te}from"./lodash-a6dd6483.js";import{b as he,f as Ce}from"./index-fe327e9d.js";import{A as ne}from"./index-63d7ee01.js";import"./index-388cb073.js";import"./assertThisInitialized-3be3daa4.js";import"./Button-bd86c829.js";const ue=ye(2,31)-1;function Pe(o,d,t){const i=t-Date.now();o.current=i<=ue?setTimeout(d,i):setTimeout(()=>Pe(o,d,t),ue)}function De(){const o=Fe(),d=h.useRef();return Ve(()=>clearTimeout(d.current)),h.useMemo(()=>{const t=()=>clearTimeout(d.current);function i(b,x=0){o()&&(t(),x<=ue?d.current=setTimeout(b,x):Pe(d,b,Date.now()+x))}return{set:i,clear:t,handleRef:d}},[])}const et={[He]:"showing",[qe]:"showing show"},Be=h.forwardRef((o,d)=>e.jsx(Ge,I(k({},o),{ref:d,transitionClasses:et})));Be.displayName="ToastFade";const tt=Be,at=h.createContext({onClose(){}}),ke=at,Ee=h.forwardRef((n,u)=>{var c=n,{bsPrefix:o,closeLabel:d="Close",closeVariant:t,closeButton:i=!0,className:b,children:x}=c,m=oe(c,["bsPrefix","closeLabel","closeVariant","closeButton","className","children"]);o=xe(o,"toast-header");const r=h.useContext(ke),j=$e(v=>{r==null||r.onClose==null||r.onClose(v)});return e.jsxs("div",I(k({ref:u},m),{className:pe(o,b),children:[x,i&&e.jsx(Ue,{"aria-label":d,variant:t,onClick:j,"data-dismiss":"toast"})]}))});Ee.displayName="ToastHeader";const nt=Ee,Ie=h.forwardRef((x,b)=>{var m=x,{className:o,bsPrefix:d,as:t="div"}=m,i=oe(m,["className","bsPrefix","as"]);return d=xe(d,"toast-body"),e.jsx(t,k({ref:b,className:pe(o,d)},i))});Ie.displayName="ToastBody";const rt=Ie,Oe=h.forwardRef((R,y)=>{var F=R,{bsPrefix:o,className:d,transition:t=tt,show:i=!0,animation:b=!0,delay:x=5e3,autohide:m=!1,onClose:u,onEntered:n,onExit:c,onExiting:r,onEnter:j,onEntering:v,onExited:a,bg:s}=F,l=oe(F,["bsPrefix","className","transition","show","animation","delay","autohide","onClose","onEntered","onExit","onExiting","onEnter","onEntering","onExited","bg"]);o=xe(o,"toast");const P=h.useRef(x),Y=h.useRef(u);h.useEffect(()=>{P.current=x,Y.current=u},[x,u]);const A=De(),C=!!(m&&i),B=h.useCallback(()=>{C&&(Y.current==null||Y.current())},[C]);h.useEffect(()=>{A.set(B,P.current)},[A,B]);const w=h.useMemo(()=>({onClose:u}),[u]),U=!!(t&&b),J=e.jsx("div",I(k({},l),{ref:y,className:pe(o,d,s&&`bg-${s}`,!U&&(i?"show":"hide")),role:"alert","aria-live":"assertive","aria-atomic":"true"}));return e.jsx(ke.Provider,{value:w,children:U&&t?e.jsx(t,{in:i,onEnter:j,onEntering:v,onEntered:n,onExit:c,onExiting:r,onExited:a,unmountOnExit:!0,children:J}):J})});Oe.displayName="Toast";const ve=Object.assign(Oe,{Body:rt,Header:nt});function ee({title:o,children:d,noBoundary:t,noOuterStyles:i}){const b=i?"":t?"bg-white mb-3":"bg-white rounded-2 border overflow-hidden border-dark shadow-sm mb-3";return e.jsxs("div",{className:b,children:[e.jsx("div",{className:"rounded-top-2 custom-bg-grey text-white text-center p-1",children:te.capitalize(o)}),d]})}function st(o,d){const[t,i]=h.useState(o);return h.useEffect(()=>{const b=setTimeout(()=>{i(o)},d);return()=>{clearTimeout(b)}},[o,d]),t}function ot(o,d,t,i,b){const[x,m]=h.useState(!1),[u,n]=h.useState(""),[c,r]=h.useState(!1),[j,v]=h.useState({}),[a,s]=h.useState("single"),{data:l,setData:y,post:R,reset:F}=ce({identificationNumber:(t==null?void 0:t.reg_ID_Number)||"",lesseeName:(t==null?void 0:t.name)||"",lesseeAddress:(t==null?void 0:t.address)||"",rentGuarantorId:(t==null?void 0:t.rent_guarantor_id)||"",rentGuarantorIdType:(t==null?void 0:t.rent_guarantor_id_type)||"",rentGuarantorName:(t==null?void 0:t.rent_guarantor_name)||"",lesseePhone:(t==null?void 0:t.mobile)||"",leaseDetails:(t==null?void 0:t.lease_details)||"",leaseStartDate:(t==null?void 0:t.start_date)||"",leaseEndDate:(t==null?void 0:t.end_date)||"",leaseCurrency:(t==null?void 0:t.currency)||"USD",depositAmount:(t==null?void 0:t.deposit_amount)||0,leasePeriod:i||(t==null?void 0:t.lease_period),rentVariable:(t==null?void 0:t.rent_variable)||!1,depositPeriod:(t==null?void 0:t.deposit_period)||0,monthlyRental:(t==null?void 0:t.monthly_rentals)||0,paymentPeriodStart:(t==null?void 0:t.payment_period_start)||"25",paymentPeriodEnd:(t==null?void 0:t.payment_period_end)||"7",isCompany:!1,leaseId:(t==null?void 0:t.lease_id)||-1,monthOneBalance:"",monthTwoBalance:"",monthThreeBalance:"",moreThanThreeMonthsBalance:"",currentBalance:"",landlordType:t!=null&&t.agent_reg_number?"COMPANY":"INDIVIDUAL",regIdNumber:(t==null?void 0:t.agent_reg_number)||(t==null?void 0:t.agent_id),landlordName:(t==null?void 0:t.agent_name)||"",commission:Number(t!=null&&t.commission_amount&&(t==null?void 0:t.commission_amount)!=="N/A"?t==null?void 0:t.commission_amount:0),openingBalance:Number(t!=null&&t.agent_opening_balance&&(t==null?void 0:t.agent_opening_balance)!=="N/A"?t==null?void 0:t.agent_opening_balance:0)}),P=G(),Y=P.clone().add(l.paymentPeriodEnd>=P.date()?0:1,"months").date(l.paymentPeriodEnd).format("DD-MMM-YY"),A=P.clone().subtract(l.paymentPeriodEnd>=P.date()?1:0,"months").date(l.paymentPeriodEnd).format("DD-MMM-YY"),C=P.clone().subtract(l.paymentPeriodEnd>=P.date()?2:1,"months").date(l.paymentPeriodEnd).format("DD-MMM-YY"),B=P.clone().subtract(l.paymentPeriodEnd>=P.date()?3:2,"months").date(l.paymentPeriodEnd).format("DD-MMM-YY"),w=st(l.identificationNumber,500),U=h.useCallback(()=>{if(w&&w.length>=5)try{m(!0),X.post(reverseUrl("get-user"),{identificationNumber:l.identificationNumber}).then(g=>{var N,O,M,q,z,Q,D,p;(N=g.data)!=null&&N.props.name?(y(I(k({},l),{lesseeName:((O=g.data)==null?void 0:O.props.name)||"",lesseeAddress:((M=g.data)==null?void 0:M.props.address)||"",lesseePhone:((q=g.data)==null?void 0:q.props.phone)||""})),v((Q=(z=g.data)==null?void 0:z.props)==null?void 0:Q.openingBalances)):((l.identificationNumber.length===6||l.identificationNumber.length>7)&&T.error("User not found!",{duration:4e3,id:"error-toast",icon:"❌"}),n((p=(D=g.data)==null?void 0:D.props)==null?void 0:p.errors)),m(!1)}).catch(g=>{T.error("Something went wrong! Please try again"),n(g)}).finally(()=>{m(!1)})}catch(g){T.error("Something went wrong! Please try again"),n(g)}},[w]);h.useEffect(()=>{d==="add"&&U()},[d,U]),h.useEffect(()=>{d==="add"&&(()=>{if(l.rentGuarantorId&&/^[\d]{8,9}[A-Za-z]{1}[\d]{2}$/.test(l.rentGuarantorId))try{m(!0),X.post(reverseUrl("get-user"),{identificationNumber:l.rentGuarantorId}).then(N=>{var O,M,q,z,Q;(O=N.data)!=null&&O.props.name?y(I(k({},l),{rentGuarantorName:((M=N.data)==null?void 0:M.props.name)||"",rentGuarantorIdType:((q=N.data)==null?void 0:q.props.identification_type)||""})):(T.error("User not found!",{duration:4e3,icon:"❌"}),n((Q=(z=N.data)==null?void 0:z.props)==null?void 0:Q.errors)),m(!1)}).catch(N=>{T.error("Something went wrong! Please try again"),n(N)}).finally(()=>{m(!1)})}catch(N){T.error("Something went wrong! Please try again"),n(N)}})()},[l.rentGuarantorId]);function J(g){y(N=>I(k({},N),{rentGuarantorId:g.label.split(" - ")[1]}))}const K=g=>{g.target.id==="rentVariable"?y(I(k({},l),{[g.target.id]:g.target.checked})):g.target.id==="leasePeriod"?Number(g.target.value)>Number(i)?(T.error(`Lease period cannot be more than your subscription period (${i} months)`),y(I(k({},l),{[g.target.id]:i}))):y(I(k({},l),{[g.target.id]:g.target.value})):y(I(k({},l),{[g.target.id]:g.target.value}))},W=g=>re(this,null,function*(){if(g.preventDefault(),l.lesseeName===""){T.error("Please enter a valid lessee");return}l.leaseEndDate=G(l.leaseEndDate).format("YYYY-MM-DD"),l.leaseStartDate=G(l.leaseStartDate).format("YYYY-MM-DD"),l.monthOneBalance=Number(l.monthOneBalance),l.monthTwoBalance=Number(l.monthTwoBalance),l.monthThreeBalance=Number(l.monthThreeBalance),l.moreThanThreeMonthsBalance=Number(l.moreThanThreeMonthsBalance),l.currentBalance=Number(l.currentBalance),l.monthOneDate=G(A).format("YYYY-MM-DD"),l.monthTwoDate=G(C).format("YYYY-MM-DD"),l.monthThreeDate=G(B).format("YYYY-MM-DD"),l.currentDate=G(Y).format("YYYY-MM-DD"),l.monthlyRental=Number(l.monthlyRental),l.depositAmount=l.depositAmount,l.depositPeriod=Number(l.depositPeriod),l.leasePeriod=Number(l.leasePeriod),l.outStandingBalance=l.moreThanThreeMonthsBalance+l.monthThreeBalance+l.monthTwoBalance+l.monthOneBalance+l.currentBalance,R(reverseUrl("create-individual-lease"),{onStart:()=>{m(!0)},onSuccess:N=>{var M,q,z;const O=(M=N==null?void 0:N.props)==null?void 0:M.flash.message;O&&((q=N==null?void 0:N.props)==null?void 0:q.flash.type)==="success"?(o(),b(O,l.lesseeName)):O&&((z=N==null?void 0:N.props)==null?void 0:z.flash.type)==="error"&&T.error(O.message),F(),m(!1)},onError:N=>{T.error(JSON.stringify(N)),n(N),m(!1)}})}),V=g=>{g.preventDefault(),l.leaseStartDate=G(l.leaseStartDate).format("YYYY-MM-DD"),l.leaseEndDate=G(l.leaseEndDate).format("YYYY-MM-DD"),R(reverseUrl("client-edit-lease"),{onStart:()=>{console.log(l),m(!0)},onSuccess:N=>{var O,M;((O=N==null?void 0:N.props)==null?void 0:O.flash.type)==="success"?(o(),b("Lease updated successfully")):((M=N==null?void 0:N.props)==null?void 0:M.flash.type)==="error"&&T.error("An error occurred, please try again later"),m(!1)},onError:N=>{T.error(JSON.stringify(N)),n(N),m(!1)}})};function H(g){if(g.preventDefault,d==="add")W(g);else if(d==="edit")V(g);else throw new Error("Invalid action: "+d)}return{isSingleTab:a==="single",toggleTab:()=>{s(g=>g==="single"?"multiple":"single")},handleAddLease:W,handleUpdateLease:V,changeHandler:K,errors:u,monthThree:B,monthTwo:C,monthOne:A,currentDate:Y,data:l,isLoading:x,showReceipt:c,viewReceipt:()=>r(!0),closeReceipt:()=>r(!1),handleSubmit:H,changeRentGuarantorId:J,changeLandlordType:g=>y(N=>I(k({},N),{landlordType:g,regIdNumber:"",landlordName:""})),changeLandlord:g=>y(N=>I(k({},N),{landlordName:g.label.split(" - ")[0],regIdNumber:g.label.split(" - ")[1],landlordName:g.label.split(" - ")[0]}))}}function we({show:o,handleClose:d,action:t,lesseeDetails:i,subscriptionPeriod:b,handleShowAlert:x}){const{isSingleTab:m,toggleTab:u,changeHandler:n,errors:c,monthThree:r,monthTwo:j,monthOne:v,currentDate:a,data:s,isLoading:l,showReceipt:y,viewReceipt:R,closeReceipt:F,handleSubmit:P,changeLandlordType:Y,changeLandlord:A,changeRentGuarantorId:C}=ot(d,t,i,b,x);return e.jsxs($,{size:"lg",show:o,onHide:d,centered:!0,children:[e.jsxs($.Header,{closeButton:!0,className:"card-header bg-transparent ps-0",children:[e.jsx("button",{className:`btn btn-sm ${m?"btn-info text-white":"btn-light"}`,onClick:u,children:"Single"}),e.jsx("button",{className:`btn btn-sm ${m?"btn-light":"btn-info text-white"}`,onClick:u,children:"Multiple"})]}),e.jsx($.Body,{className:"p-0",children:m?e.jsxs("div",{className:"card card-raised",children:[e.jsx("div",{className:"card-header bg-info",children:e.jsx("h2",{className:"display-6 mb-0 text-white",children:t==="view"?"View Lease - Individual":t==="edit"?"Edit Lease - Individual":"Add Lease - Individual"})}),e.jsxs("div",{className:"card-body p-4",children:[e.jsx("h6",{className:"bg-info p-1 display-6 m-0 text-center text-white",children:"Lease details"}),e.jsxs("form",{className:"p-5 border border-2 border-info",onSubmit:P,children:[e.jsxs("div",{className:"row mb-4",children:[e.jsx(ge,{}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"National ID:"}),e.jsx("input",{value:s.identificationNumber,onChange:n,type:"text",required:!0,name:"identificationNumber",id:"identificationNumber",className:"form-control form-control-sm"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.identificationNumber})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lessee Name:"}),e.jsx("input",{value:s.lesseeName,onChange:n,type:"text",name:"lesseeName",required:!0,id:"lesseeName",className:"form-control form-control-sm",readOnly:!0}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.lesseeName})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lessee Mobile Number"}),e.jsx("input",{value:s.lesseePhone,onChange:n,type:"text",name:"lesseePhone",id:"lesseePhone",required:!0,className:"form-control form-control-sm",readOnly:t==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.lesseePhone})]})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Address:"}),e.jsx("textarea",{value:s.lesseeAddress,onChange:n,type:"text",required:!!s.lesseeName,name:"lesseeAddress",id:"lesseeAddress",className:"form-control form-control-sm",readOnly:t==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.lesseeAddress})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Rent Guarantor ID:"}),e.jsx(le,{onChange:B=>C(B),extraProps:{required:!1,className:"w-100",name:"rentGuarantorId",id:"rentGuarantorId",placeholder:s.rentGuarantorId||void 0},isDisabled:t==="view",defaultValue:t==="view"?s.rentGuarantorId:"",useAlternateFetchOptions:{type:"individual"}}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.rentGuarantorId})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Rent Guarantor Name:"}),e.jsx("input",{value:s.rentGuarantorName,onChange:n,type:"text",name:"rentGuarantorName",id:"rentGuarantorName",className:"form-control form-control-sm",readOnly:!0}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.rentGuarantorName})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Details:"}),e.jsx("textarea",{value:s.leaseDetails,onChange:n,name:"leaseDetails",id:"leaseDetails",className:"form-control form-control-sm",readOnly:t==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leaseDetails})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Currency"}),e.jsxs("select",{value:s.leaseCurrency,onChange:n,id:"leaseCurrency",name:"leaseCurrency",className:"form-select form-select-sm",readOnly:t==="view",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"ZWG",children:"ZWG"})]}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leaseCurrency})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Monthly Rental:"}),e.jsx("input",{value:s.monthlyRental===0?"":s.monthlyRental,placeholder:"enter monthly rental",onChange:n,type:"text",required:!!s.lesseeName,id:"monthlyRental",name:"monthlyRental",className:"form-control form-control-sm",readOnly:t==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.monthlyRental})]}),e.jsxs("div",{className:"mt-1 col-lg-4 d-flex flex-column",children:[e.jsx("label",{className:"form-label",children:"Variable Rent:"}),e.jsx("input",{checked:s.rentVariable,onChange:n,type:"checkbox",id:"rentVariable",name:"rentVariable",className:"form-check-input border-1 p-2 border-black"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.rentVariable})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Period(Months):"}),e.jsx("input",{value:s.depositPeriod===0?"":s.depositPeriod,placeholder:"enter deposit period",onChange:n,type:"text",id:"depositPeriod",name:"depositPeriod",className:"form-control form-control-sm",readOnly:t==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.depositPeriod})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Amount:"}),e.jsx("input",{value:s.depositAmount===0?"":s.depositAmount,placeholder:"enter deposit amount",onChange:n,type:"text",name:"depositAmount",id:"depositAmount",className:"form-control form-control-sm",readOnly:t==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.depositAmount})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Subscription period left (months):"}),e.jsx("input",{value:s.leasePeriod,onChange:n,type:"number",id:"leasePeriod",name:"leasePeriod",className:"form-control form-control-sm"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leasePeriod})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Start Date:"}),e.jsx("input",{value:s.leaseStartDate,onChange:n,type:"date",required:!!s.lesseeName,name:"leaseStartDate",id:"leaseStartDate",className:"form-control form-control-sm",readOnly:t==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leaseStartDate})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease End Date:"}),e.jsx("input",{value:s.leaseEndDate,onChange:n,type:"date",name:"leaseEndDate",id:"leaseEndDate",className:"form-control form-control-sm",readOnly:t==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leaseEndDate})]}),e.jsxs("div",{className:"col-lg-4 mt-1",children:[e.jsx("label",{className:"form-label",children:"Payment Period Start Date:"}),e.jsx("input",{value:s.paymentPeriodStart,type:"number",id:"paymentPeriodStart",name:"paymentPeriodStart",className:"form-control form-control-sm",readOnly:!0,disabled:!0}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.paymentPeriodStart})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Payment Period End Date:"}),e.jsx("input",{value:s.paymentPeriodEnd,onChange:n,type:"number",min:"1",max:"31",required:!!s.lesseeName,name:"paymentPeriodEnd",id:"paymentPeriodEnd",className:"form-control form-control-sm",readOnly:t==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.paymentPeriodEnd})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-center p-2 fw-bolder h6 custom-bg-grey",children:"Estate Agents Section"}),e.jsxs("div",{className:"row align-items-center",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Landlord Type:"}),e.jsxs("select",{className:"form-select form-select-md",name:"landlordType",id:"landlordType",value:s.landlordType,disabled:t==="view"||t==="edit",onChange:B=>Y(B.target.value),children:[e.jsx("option",{value:"INDIVIDUAL",children:"Individual"}),e.jsx("option",{value:"COMPANY",children:"Company"})]}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.landlordType})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsxs("label",{htmlFor:"regIdNumber",className:"form-label",children:[s.landlordType==="COMPANY"?"Reg Number":"ID"," (or Name)",":"]}),e.jsx(le,{onChange:B=>A(B),extraProps:{required:!1,id:"regIdNumber",className:"w-100",name:"regIdNumber",placeholder:(s.regIdNumber||s.landlordName)&&(s.regIdNumber||" - "+s.landlordName)||""},defaultValue:s.regIdNumber?s.regIdNumber:"",isDisabled:t==="view"||t==="edit"||s.landlordType==="",useAlternateFetchOptions:{type:s.landlordType.toLowerCase()}},s.landlordType),c&&e.jsx("div",{className:"text-danger mt-1",children:c.idRegOrName})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{htmlFor:"landlordName",className:"form-label",children:"Landlord Name"}),e.jsx("input",{value:s.landlordName,name:"landlordName",id:"landlordName",className:"form-control form-control-md custom-no-pointer-events border border-2",readOnly:!0}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.landlordName})]}),e.jsxs("div",{className:"mt-2 col-lg-4",children:[e.jsx("label",{htmlFor:"commission",className:"form-label",children:"Commission %"}),e.jsx("input",{value:s.commission,onChange:n,type:"number",min:0,max:100,name:"commission",id:"commission",className:"form-control form-control-sm",disabled:t==="view"||t==="edit"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.commission})]}),e.jsxs("div",{className:"mt-2 col-lg-4",children:[e.jsx("label",{htmlFor:"openingBalance",className:"form-label",children:"Landlord Opening Balance"}),e.jsx("input",{value:s.openingBalance,onChange:n,type:"number",min:0,name:"openingBalance",id:"openingBalance",className:"form-control form-control-sm",disabled:t==="view"||t==="edit"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.openingBalance})]})]})]}),t==="add"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-center p-2 fw-bolder h6 custom-bg-grey",children:"Tenant Opening Rent Balances"}),e.jsx("table",{className:"table table-responsive table-bordered",children:e.jsxs("tbody",{children:[e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",style:{lineHeight:"15px"},children:"Payment Date"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:"More than 3 months"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:r}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:j}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:v}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:a}),e.jsx("td",{className:"fw-bold",style:{lineHeight:"15px"},children:"Outstanding Balance"})]}),e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",children:"Amount"}),e.jsx("td",{className:"bg-black text-white",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"moreThanThreeMonthsBalance",name:"moreThanThreeMonthsBalance",onChange:n,value:s.moreThanThreeMonthsBalance})}),e.jsx("td",{className:"text-white bg-danger",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthThreeBalance",name:"monthThreeBalance",onChange:n,value:s.monthThreeBalance})}),e.jsx("td",{className:"text-white custom-bg-pink",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthTwoBalance",name:"monthTwoBalance",onChange:n,value:s.monthTwoBalance})}),e.jsx("td",{className:"text-white bg-warning",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthOneBalance",name:"monthOneBalance",onChange:n,value:s.monthOneBalance})}),e.jsx("td",{className:"text-white bg-success",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"currentBalance",name:"currentBalance",onChange:n,value:s.currentBalance})}),e.jsx("td",{className:`text-white d-flex align-items-center justify-content-center py-4 my-auto ${Number(s.moreThanThreeMonthsBalance)>0?"bg-black":Number(s.monthThreeBalance)>0?"bg-danger":Number(s.monthTwoBalance)>0?"custom-bg-pink":Number(s.monthOneBalance)>0?"bg-warning":"bg-success"}`,style:{backgroundColor:Number(s.monthTwoBalance)>0?"#f87171":""},children:de(Number(s.moreThanThreeMonthsBalance)+Number(s.monthThreeBalance)+Number(s.monthTwoBalance)+Number(s.monthOneBalance)+Number(s.currentBalance)||0)})]})]})})]}),e.jsx("div",{className:"d-flex justify-content-end align-items-center gap-3",children:t==="view"?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-info text-white",onClick:R,children:"Receipt"}),e.jsx("button",{className:"btn btn-success",onClick:d,children:"Edit"}),e.jsx("button",{className:"btn btn-danger",onClick:d,children:"Terminate"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",onClick:d,children:"Cancel"}),e.jsx("button",{className:"btn btn-info text-white",type:"submit",disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"d-inline-block ml-2",children:"processing.."})]}):"Submit"})]})})]}),e.jsx(be,{show:y,handleClose:F})]})]}):e.jsx(Te,{type:"individual",actionType:"lease"})})]})}function lt(o,d,t,i,b){const[x,m]=h.useState(!1),[u,n]=h.useState("single"),[c,r]=h.useState(""),[j,v]=h.useState(!1),{data:a,setData:s,post:l,reset:y}=ce({identificationNumber:(t==null?void 0:t.reg_ID_Number)||"",lesseeName:(t==null?void 0:t.name)||"",lesseeAddress:(t==null?void 0:t.address)||"",mobile:(t==null?void 0:t.mobile)||"",email:(t==null?void 0:t.email)||"",rentGuarantorId:(t==null?void 0:t.rent_guarantor_id)||"",rentGuarantorIdType:(t==null?void 0:t.rent_guarantor_id_type)||"",rentGuarantorName:(t==null?void 0:t.rent_guarantor_name)||"",leaseDetails:(t==null?void 0:t.lease_details)||"",leaseStartDate:(t==null?void 0:t.start_date)||"",rentVariable:(t==null?void 0:t.rent_variable)||!1,leaseEndDate:(t==null?void 0:t.end_date)||"",leaseCurrency:(t==null?void 0:t.currency)||"USD",depositAmount:(t==null?void 0:t.deposit_amount)||0,leasePeriod:i||(t==null?void 0:t.lease_period),depositPeriod:(t==null?void 0:t.deposit_period)||0,monthlyRental:(t==null?void 0:t.monthly_rentals)||0,paymentPeriodStart:(t==null?void 0:t.payment_period_start)||"25",paymentPeriodEnd:(t==null?void 0:t.payment_period_end)||"7",isCompany:!0,leaseId:(t==null?void 0:t.lease_id)||-1,monthOneBalance:"",monthTwoBalance:"",monthThreeBalance:"",moreThanThreeMonthsBalance:"",currentBalance:"",isGovernment:!1,accountNumber:t.customer_number||"",landlordType:t!=null&&t.agent_reg_number?"COMPANY":"INDIVIDUAL",regIdNumber:(t==null?void 0:t.agent_reg_number)||(t==null?void 0:t.agent_id),landlordName:(t==null?void 0:t.agent_name)||"",commission:Number(t!=null&&t.commission_amount&&(t==null?void 0:t.commission_amount)!=="N/A"?t==null?void 0:t.commission_amount:0),openingBalance:Number(t!=null&&t.agent_opening_balance&&(t==null?void 0:t.agent_opening_balance)!=="N/A"?t==null?void 0:t.agent_opening_balance:0)}),[R,F]=h.useState(d==="edit"?a.lesseeName:""),[P,Y]=h.useState(a.lesseeName),[A,C]=h.useState(a.email),[B,w]=h.useState(a.identificationNumber),[U,J]=h.useState(a.mobile),[K,W]=h.useState(a.lesseeAddress),V=G(),H=V.clone().add(a.paymentPeriodEnd>=V.date()?0:1,"months").date(a.paymentPeriodEnd).format("DD-MMM-YY"),g=V.clone().subtract(a.paymentPeriodEnd>=V.date()?1:0,"months").date(a.paymentPeriodEnd).format("DD-MMM-YY"),N=V.clone().subtract(a.paymentPeriodEnd>=V.date()?2:1,"months").date(a.paymentPeriodEnd).format("DD-MMM-YY"),O=V.clone().subtract(a.paymentPeriodEnd>=V.date()?3:2,"months").date(a.paymentPeriodEnd).format("DD-MMM-YY");h.useEffect(()=>{s(I(k({},a),{lesseeName:P,email:A,identificationNumber:String(B),mobile:U,lesseeAddress:K}))},[B,P,A,U,K]),h.useEffect(()=>{d==="add"&&(()=>{if(a.rentGuarantorId&&/^[\d]{8,9}[A-Za-z]{1}[\d]{2}$/.test(a.rentGuarantorId))try{m(!0),X.post(reverseUrl("get-user"),{identificationNumber:a.rentGuarantorId}).then(f=>{var Z,S,_,L,E;(Z=f.data)!=null&&Z.props.name?s(I(k({},a),{rentGuarantorName:((S=f.data)==null?void 0:S.props.name)||"",rentGuarantorIdType:((_=f.data)==null?void 0:_.props.identification_type)||""})):(T.error("User not found!",{duration:4e3,icon:"❌"}),r((E=(L=f.data)==null?void 0:L.props)==null?void 0:E.errors)),m(!1)}).catch(f=>{T.error("Something went wrong! Please try again"),r(f)}).finally(()=>{m(!1)})}catch(f){T.error("Something went wrong! Please try again"),r(f)}})()},[a.rentGuarantorId]);const M=p=>{p.target.id==="rentVariable"?s(I(k({},a),{[p.target.id]:p.target.checked})):p.target.id==="leasePeriod"?Number(p.target.value)>Number(i)?(T.error(`Lease period cannot be more than your subscription period (${i} months)`),s(I(k({},a),{[p.target.id]:i}))):s(I(k({},a),{[p.target.id]:p.target.value})):s(I(k({},a),{[p.target.id]:p.target.value}))},q=p=>re(this,null,function*(){if(p.preventDefault(),!a.lesseeName){T.error("Please add a valid lessee");return}m(!0),a.leaseEndDate=G(a.leaseEndDate).format("YYYY-MM-DD"),a.monthOneBalance=Number(a.monthOneBalance),a.monthTwoBalance=Number(a.monthTwoBalance),a.monthThreeBalance=Number(a.monthThreeBalance),a.moreThanThreeMonthsBalance=Number(a.moreThanThreeMonthsBalance),a.currentBalance=Number(a.currentBalance),a.monthOneDate=G(g).format("YYYY-MM-DD"),a.monthTwoDate=G(N).format("YYYY-MM-DD"),a.monthThreeDate=G(O).format("YYYY-MM-DD"),a.currentDate=G(H).format("YYYY-MM-DD"),a.monthlyRental=Number(a.monthlyRental),a.depositAmount=a.depositAmount,a.depositPeriod=Number(a.depositPeriod),a.leasePeriod=Number(a.leasePeriod),a.outStandingBalance=a.moreThanThreeMonthsBalance+a.monthThreeBalance+a.monthTwoBalance+a.monthOneBalance+a.currentBalance,l(reverseUrl("create-company-lease"),{onStart:()=>{m(!0)},onSuccess:f=>{var S,_,L;const Z=(S=f==null?void 0:f.props)==null?void 0:S.flash.message;Z&&((_=f==null?void 0:f.props)==null?void 0:_.flash.type)==="success"?(o(),y(),b(Z,a.lesseeName)):Z&&((L=f==null?void 0:f.props)==null?void 0:L.flash.type)==="error"&&T.error(Z.message),m(!1)},onError:f=>{T.error(JSON.stringify(f)),r(f),m(!1)}})}),z=p=>{p.preventDefault(),a.leaseStartDate=G(a.leaseStartDate).format("YYYY-MM-DD"),a.leaseEndDate=G(a.leaseEndDate).format("YYYY-MM-DD"),l(reverseUrl("client-edit-lease"),{onStart:()=>{console.log(a),m(!0)},onSuccess:f=>{var Z,S;((Z=f==null?void 0:f.props)==null?void 0:Z.flash.type)==="success"?(o(),b("Lease updated successfully")):((S=f==null?void 0:f.props)==null?void 0:S.flash.type)==="error"&&T.error("An error occurred, please try again"),m(!1)},onError:f=>{T.error(JSON.stringify(f)),r(f),m(!1)}})};function Q(p){if(p.preventDefault,d==="add")q(p);else if(d==="edit")z(p);else throw new Error("Invalid action: "+d)}function D(p){s(f=>I(k({},f),{rentGuarantorId:p.label.split(" - ")[1]}))}return{isSingleTab:u==="single",isLoading:x,errors:c,showReceipt:j,data:a,value:R,currentDate:H,monthOne:g,monthTwo:N,monthThree:O,handleSubmit:Q,toggleTab:()=>{n(p=>p==="single"?"multiple":"single")},viewReceipt:()=>v(!0),closeReceipt:()=>v(!1),setValue:F,setClientName:Y,setClientId:w,setMobileNo:J,setRegNumber:C,setAddress:W,changeHandler:M,changeLandlordType:p=>s(f=>I(k({},f),{landlordType:p,regIdNumber:"",landlordName:""})),changeLandlord:p=>s(f=>I(k({},f),{landlordName:p.label.split(" - ")[0],regIdNumber:p.label.split(" - ")[1],landlordName:p.label.split(" - ")[0]})),changeRentGuarantorId:D,toggleIsGovernment:()=>s(p=>I(k({},p),{isGovernment:!p.isGovernment}))}}const dt=({show:o,handleClose:d,action:t,lesseeDetails:i,subscriptionPeriod:b,handleShowAlert:x})=>{const{isLoading:m,isSingleTab:u,errors:n,showReceipt:c,data:r,value:j,currentDate:v,monthOne:a,monthTwo:s,monthThree:l,handleSubmit:y,toggleTab:R,setValue:F,setClientName:P,setClientId:Y,setMobileNo:A,setRegNumber:C,setAddress:B,changeHandler:w,viewReceipt:U,closeReceipt:J,changeLandlordType:K,changeLandlord:W,toggleIsGovernment:V,changeRentGuarantorId:H}=lt(d,t,i,b,x);return e.jsxs($,{size:"lg",show:o,onHide:d,centered:!0,children:[e.jsxs($.Header,{closeButton:!0,className:"card-header bg-transparent ps-0",children:[e.jsx("button",{className:`btn btn-sm ${u?"btn-info text-white":"btn-light"}`,onClick:R,children:"Single"}),e.jsx("button",{className:`btn btn-sm ${u?"btn-light":"btn-info text-white"}`,onClick:R,children:"Multiple"})]}),e.jsx($.Body,{className:"p-0",children:u?e.jsxs("div",{className:"card card-raised",children:[e.jsx("div",{className:"card-header bg-info",children:e.jsx("h2",{className:"display-6 mb-0 text-white",children:t==="view"?"View Lease - Company":t==="edit"?"Edit Lease - Company":"Add Lease - Company"})}),e.jsxs("div",{className:"card-body p-4",children:[e.jsx("h6",{className:"bg-info p-1 display-6 m-0 text-center text-white",children:"Lease details"}),e.jsxs("form",{className:"p-5 border border-2 border-info",onSubmit:y,children:[e.jsxs("div",{className:"row mb-4",children:[e.jsx(ge,{}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Company Name:"}),e.jsx(We,{from:"leases",delay:500,placeholder:"Company Name",value:j,setValue:F,url:reverseUrl("get_searched_companies"),type:"company",setAddress:B,setClientName:P,setRegNumber:C,setClientId:Y,setMobileNo:A}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.identificationNumber})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Account Number:"}),e.jsx("input",{value:r.accountNumber,onChange:w,type:"text",name:"accountNumber",id:"accountNumber",className:"form-control form-control-sm",readOnly:t==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.accountNumber})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lessee Name:"}),e.jsx("input",{value:r.lesseeName,onChange:w,type:"text",name:"lesseeName",readOnly:!0,required:!0,id:"lesseeName",className:"form-control form-control-sm"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.lesseeName})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Email:"}),e.jsx("input",{value:r.email,onChange:w,type:"text",name:"email",required:!0,id:"email",className:"form-control form-control-sm",readOnly:t==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.email})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Mobile:"}),e.jsx("input",{value:r.mobile,onChange:w,type:"text",name:"mobile",required:!0,id:"mobile",className:"form-control form-control-sm",readOnly:t==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.mobile})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Rent Guarantor ID:"}),e.jsx(le,{onChange:g=>H(g),extraProps:{required:!1,className:"w-100",name:"rentGuarantorId",id:"rentGuarantorId",placeholder:r.rentGuarantorId||void 0},isDisabled:t==="view",defaultValue:t==="view"?r.rentGuarantorId:"",useAlternateFetchOptions:{type:"individual"}}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.rentGuarantorId})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Rent Guarantor Name:"}),e.jsx("input",{value:r.rentGuarantorName,onChange:w,type:"text",name:"rentGuarantorName",id:"rentGuarantorName",className:"form-control form-control-sm",readOnly:!0}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.rentGuarantorName})]}),e.jsxs("div",{className:"mt-1 col-lg-4 d-flex flex-column",children:[e.jsx("label",{htmlFor:"isGovernment",className:"form-label",children:"Government:"}),e.jsx("input",{checked:r.isGovernment,onChange:V,type:"checkbox",id:"isGovernment",name:"isGovernment",className:"form-check-input border-1 p-2 border-black",readOnly:t==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.isGovernment})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Address:"}),e.jsx("textarea",{value:r.lesseeAddress,onChange:w,type:"text",required:!!r.lesseeName,name:"lesseeAddress",id:"lesseeAddress",className:"form-control form-control-sm",readOnly:t==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.lesseeAddress})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Details:"}),e.jsx("textarea",{value:r.leaseDetails,onChange:w,type:"text",name:"leaseDetails",id:"leaseDetails",className:"form-control form-control-sm",readOnly:t==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.leaseDetails})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Currency"}),e.jsxs("select",{value:r.leaseCurrency,onChange:w,id:"leaseCurrency",name:"leaseCurrency",className:"form-select form-select-sm",readOnly:t==="view",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"ZWG",children:"ZWG"})]}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.leaseCurrency})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Monthly Rental:"}),e.jsx("input",{value:r.monthlyRental===0?"":r.monthlyRental,placeholder:"enter monthly rental",onChange:w,type:"text",required:!!r.lesseeName,id:"monthlyRental",name:"monthlyRental",className:"form-control form-control-sm",readOnly:t==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.monthlyRental})]}),e.jsxs("div",{className:"mt-1 col-lg-4 d-flex flex-column",children:[e.jsx("label",{className:"form-label",children:"Variable Rent:"}),e.jsx("input",{checked:r.rentVariable,onChange:w,type:"checkbox",id:"rentVariable",name:"rentVariable",className:"form-check-input border-1 p-2 border-black",readOnly:t==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.rentVariable})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Period(Months):"}),e.jsx("input",{value:r.depositPeriod===0?"":r.depositPeriod,placeholder:"enter deposit period",onChange:w,type:"text",id:"depositPeriod",name:"depositPeriod",className:"form-control form-control-sm",readOnly:t==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.depositPeriod})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Amount:"}),e.jsx("input",{value:r.depositAmount===0?"":r.depositAmount,placeholder:"enter deposit amount",onChange:w,type:"text",name:"depositAmount",id:"depositAmount",className:"form-control form-control-sm",readOnly:t==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.depositAmount})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Subscription period left (months):"}),e.jsx("input",{value:r.leasePeriod,onChange:w,type:"number",id:"leasePeriod",name:"leasePeriod",className:"form-control form-control-sm"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.leasePeriod})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Start Date:"}),e.jsx("input",{value:r.leaseStartDate,onChange:w,type:"date",name:"leaseStartDate",required:!!r.lesseeName,id:"leaseStartDate",className:"form-control form-control-sm",readOnly:t==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.leaseStartDate})]})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease End Date:"}),e.jsx("input",{value:r.leaseEndDate,onChange:w,type:"date",name:"leaseEndDate",id:"leaseEndDate",className:"form-control form-control-sm",readOnly:t==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.leaseEndDate})]}),e.jsxs("div",{className:"col-lg-4 mt-1",children:[e.jsx("label",{className:"form-label",children:"Payment Period Start Date:"}),e.jsx("input",{value:r.paymentPeriodStart,onChange:w,type:"number",id:"paymentPeriodStart",name:"paymentPeriodStart",className:"form-control form-control-sm",readOnly:!0,disabled:!0}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.paymentPeriodStart})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Payment Period End Date:"}),e.jsx("input",{value:r.paymentPeriodEnd,onChange:w,min:"1",max:"31",type:"number",required:!!r.lesseeName,name:"paymentPeriodEnd",id:"paymentPeriodEnd",className:"form-control form-control-sm",readOnly:t==="view"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.paymentPeriodEnd})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-center p-2 fw-bolder h6 custom-bg-grey",children:"Estate Agents Section"}),e.jsxs("div",{className:"row align-items-center",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Landlord Type:"}),e.jsxs("select",{className:"form-select form-select-md",name:"landlordType",id:"landlordType",value:r.landlordType,disabled:t==="view"||t==="edit",onChange:g=>K(g.target.value),children:[e.jsx("option",{value:"INDIVIDUAL",children:"Individual"}),e.jsx("option",{value:"COMPANY",children:"Company"})]}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.landlordType})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsxs("label",{htmlFor:"regIdNumber",className:"form-label",children:[r.landlordType==="COMPANY"?"Reg Number":"ID"," (or Name)",":"]}),e.jsx(le,{onChange:g=>W(g),extraProps:{required:!1,id:"regIdNumber",className:"w-100",name:"regIdNumber",placeholder:(r.regIdNumber||r.landlordName)&&(r.regIdNumber||" - "+r.landlordName)||""},defaultValue:r.regIdNumber?r.regIdNumber:"",isDisabled:t==="view"||t==="edit"||r.landlordType==="",useAlternateFetchOptions:{type:r.landlordType.toLowerCase()}},r.landlordType),n&&e.jsx("div",{className:"text-danger mt-1",children:n.regIdNumber})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{htmlFor:"landlordName",className:"form-label",children:"Landlord Name"}),e.jsx("input",{value:r.landlordName,name:"landlordName",id:"landlordName",className:"form-control form-control-md custom-no-pointer-events border border-2",readOnly:!0}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.landlordName})]}),e.jsxs("div",{className:"mt-2 col-lg-4",children:[e.jsx("label",{htmlFor:"commission",className:"form-label",children:"Commission %"}),e.jsx("input",{value:r.commission,onChange:w,type:"number",min:0,max:100,name:"commission",id:"commission",className:"form-control form-control-sm",disabled:t==="view"||t==="edit"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.commission})]}),e.jsxs("div",{className:"mt-2 col-lg-4",children:[e.jsx("label",{htmlFor:"openingBalance",className:"form-label",children:"Landlord Opening Balance"}),e.jsx("input",{value:r.openingBalance,onChange:w,type:"number",min:0,name:"openingBalance",id:"openingBalance",className:"form-control form-control-sm",disabled:t==="view"||t==="edit"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.openingBalance})]})]})]}),t==="add"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-center p-2 fw-bolder h6 custom-bg-grey",children:"Tenant Opening Rent Balances"}),e.jsx("table",{className:"table table-responsive table-bordered",children:e.jsxs("tbody",{children:[e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",style:{lineHeight:"15px"},children:"Payment Date"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:"More than 3 months"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:l}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:s}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:a}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:v}),e.jsx("td",{className:"fw-bold",style:{lineHeight:"15px"},children:"Outstanding Balance"})]}),e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",children:"Amount"}),e.jsx("td",{className:"bg-black text-white",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"moreThanThreeMonthsBalance",name:"moreThanThreeMonthsBalance",onChange:w,value:r.moreThanThreeMonthsBalance})}),e.jsx("td",{className:"text-white bg-danger",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthThreeBalance",name:"monthThreeBalance",onChange:w,value:r.monthThreeBalance})}),e.jsx("td",{className:"text-white custom-bg-pink",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthTwoBalance",name:"monthTwoBalance",onChange:w,value:r.monthTwoBalance})}),e.jsx("td",{className:"text-white bg-warning",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthOneBalance",name:"monthOneBalance",onChange:w,value:r.monthOneBalance})}),e.jsx("td",{className:"text-white bg-success",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"currentBalance",name:"currentBalance",onChange:w,value:r.currentBalance})}),e.jsx("td",{className:`text-white text-end h-100 d-flex align-items-center justify-content-center py-4 my-auto ${Number(r.moreThanThreeMonthsBalance)>0?"bg-black":Number(r.monthThreeBalance)>0?"bg-danger":Number(r.monthTwoBalance)>0?"custom-bg-pink":Number(r.monthOneBalance)>0?"bg-warning":"bg-success"}`,style:{backgroundColor:Number(r.monthTwoBalance)>0?"#f87171":""},children:de(Number(r.moreThanThreeMonthsBalance)+Number(r.monthThreeBalance)+Number(r.monthTwoBalance)+Number(r.monthOneBalance)+Number(r.currentBalance)||0)})]})]})})]}),e.jsx("div",{className:"d-flex justify-content-end align-items-center gap-3",children:t==="view"?e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-info text-white",onClick:U,children:"Receipt"}),e.jsx("button",{className:"btn btn-success",onClick:d,children:"Edit"}),e.jsx("button",{className:"btn btn-danger",onClick:d,children:"Terminate"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",onClick:d,children:"Cancel"}),e.jsx("button",{className:"btn btn-info text-white",type:"submit",disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"d-inline-block ml-2",children:"processing.."})]}):"Submit"})]})})]}),e.jsx(be,{show:c,handleClose:J})]})]}):e.jsx(Te,{type:"company",actionType:"lease"})})]})},_e=dt,ct=({show:o,handleClose:d,handleShowAlert:t,leaseData:i})=>{const[b,x]=h.useState(!1),{data:m,post:u}=ce({leaseId:i.lease_id}),n=()=>{u(reverseUrl("delete_lease"),{onStart:()=>{x(!0)},onSuccess:c=>{t("Lease terminated successfully"),x(!1)},onError:c=>{T.error("Something went wrong! Please try again"),x(!1)},onFinish:()=>{d()}})};return e.jsxs($,{show:o,onHide:d,size:"md",backdrop:"static",centered:!0,children:[e.jsx($.Header,{closeButton:!0,className:"h4 bg-info text-white text-center text-uppercase",children:"Confirm Lease Termination"}),e.jsxs($.Body,{className:"p-4 d-flex justify-content-between align-items-center gap-4",children:[e.jsx(ge,{}),e.jsxs("p",{className:"my-3 text-center",children:["Are you sure you want to terninate lease for ",i.name,"? This action cannot be undone."]})]}),e.jsxs($.Footer,{className:"p-4 d-flex justify-content-end gap-4",children:[e.jsxs(me,{onClick:d,variant:"secondary",children:[e.jsx("i",{className:"material-icons",children:"cancel"}),"Cancel"]}),e.jsxs(me,{onClick:n,variant:"danger",children:[e.jsx("i",{className:"material-icons",children:"done"}),"Delete"]})]})]})},it=ct;function mt({data:o}){let d=0;return Object.keys(o).forEach(t=>d+=o[t]),e.jsx(ee,{title:"aged analysis",children:e.jsxs("table",{className:"table table-sm table-responsive table-bordered  mb-0",children:[e.jsx("thead",{className:"custom-bg-grey-2 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{children:"90+ Days"}),e.jsx("th",{children:"90 Days"}),e.jsx("th",{children:"60 Days"}),e.jsx("th",{children:"30 Days"}),e.jsx("th",{children:"Current"}),e.jsx("th",{children:"total"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{children:o.oneTwentyDays}),e.jsx("td",{children:o.ninetyDays}),e.jsx("td",{children:o.sixtyDays}),e.jsx("td",{children:o.thirtyDays}),e.jsx("td",{children:o.current}),e.jsxs("td",{children:["$",d]})]})})]})})}function ht(o,d){const[t,i]=h.useState(!o),[b,x]=h.useState(o),[m,u]=h.useState(""),[n,c]=h.useState(!1),{Auth:r}=Se().props,j=`${r.user_profile.first_name} ${r.user_profile.last_name}`;function v(a){a.preventDefault(),c(!0),u("");const s=Object.fromEntries(new FormData(a.target).entries());s.client_id=d.toString(),X.put(reverseUrl("debtor_intelligence"),s).then(l=>{const y={text:l.data.note,user:l.data.user_name,timestamp:l.data.updated_at||l.data.created_at};x(y),u(""),c(!1),i(!1)}).catch(l=>{l instanceof ne?u(l.response.status===500?`Error: ${l.response.statusText}`:JSON.stringify(l.response.data)):u(l),c(!1),i(!b)})}return{data:b,isEditMode:t,handleSave:v,loggedInUser:j,setIsEditMode:i,error:m,setError:u,isLoading:n}}function ut({data:o,clientId:d}){const{data:t,isEditMode:i,handleSave:b,loggedInUser:x,setIsEditMode:m,error:u,setError:n,isLoading:c}=ht(o,d);return e.jsx(ee,{title:"debtor intelligence",children:e.jsxs("div",{className:"px-3 py-2",children:[u&&e.jsxs("p",{className:"d-flex align-items-start gap-1 small text-danger",children:[e.jsx("button",{type:"button",onClick:()=>n(""),className:"btn-close btn-sm"}),te.truncate(u,{length:150})]}),i?e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"note",className:"form-label",children:t&&t.text?"Edit note":"No note found, create new note"}),e.jsx("textarea",{className:"form-control",name:"note",id:"note",rows:"2",defaultValue:t&&t.text?t.text:"",placeholder:"type here...",disabled:c})]}),e.jsx("b",{className:"d-block my-1",children:x}),e.jsx("div",{className:"small text-success",children:"today"}),e.jsx("button",{disabled:c,type:"submit",className:"d-block btn btn-info text-white w-100 mt-3",children:c?"Saving...":"Save"})]}):e.jsxs("div",{children:[e.jsx("small",{children:t.text}),e.jsx("b",{className:"d-block my-1",children:t.user}),e.jsx("div",{className:"small text-success",children:he(t.timestamp)}),e.jsx("button",{onClick:()=>m(!0),type:"button",className:"d-block btn btn-info w-100 mt-4 text-white",children:"Edit"})]})]})})}function xt(o,d){const[t,i]=h.useState(!o),[b,x]=h.useState(o),[m,u]=h.useState(""),[n,c]=h.useState(!1);function r(j){j.preventDefault(),c(!0),u("");const v=Object.fromEntries(new FormData(j.target).entries());v.client_id=d.toString(),v.other_numbers=v.other_numbers.split(",").filter(Boolean).map(a=>a.trim()),X.put(reverseUrl("update_client_contact_details"),v).then(a=>{const s={contactPerson:`${a.data.firstname} ${a.data.surname}`,smsNumber:a.data.sms_number,otherNumbers:a.data.other_numbers?a.data.other_numbers.join(", "):"",emailAddress:a.data.email_address,address:a.data.address};x(s),u(""),c(!1),i(!1)}).catch(a=>{a instanceof ne?u(a.response.status===500?`Error: ${a.response.statusText}`:JSON.stringify(a.response.data)):u(a),c(!1),i(!b)})}return{data:b,isEditMode:t,handleSave:r,setIsEditMode:i,error:m,setError:u,isLoading:n}}function pt({data:o,clientId:d}){const{data:t,isEditMode:i,handleSave:b,setIsEditMode:x,error:m,setError:u,isLoading:n}=xt(o,d);return e.jsx(ee,{title:"contact details",children:e.jsxs("div",{className:"py-2",children:[m&&e.jsxs("p",{className:"d-flex align-items-start px-2 gap-1 small text-danger",children:[e.jsx("button",{type:"button",onClick:()=>u(""),className:"btn-close btn-sm"}),te.truncate(m,{length:150})]}),i?e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center py-1 px-2 border-bottom custom-bg-whitesmoke",children:[e.jsx("label",{htmlFor:"firstname",className:"form-label small",children:"First Name"}),e.jsx("input",{type:"text",className:"form-control form-control-sm w-50 rounded-2",name:"firstname",id:"firstname",disabled:n,defaultValue:t&&t.contactPerson?t.contactPerson.trim().split(" ")[0]:""})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center py-1 px-2 border-bottom",children:[e.jsx("label",{htmlFor:"surname",className:"form-label small",children:"Surname"}),e.jsx("input",{type:"text",className:"form-control form-control-sm w-50 rounded-2",name:"surname",id:"surname",disabled:n,defaultValue:t&&t.contactPerson?t.contactPerson.trim().split(" ")[1]:""})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center py-1 px-2 border-bottom custom-bg-whitesmoke",children:[e.jsx("label",{htmlFor:"sms_number",className:"form-label small",children:"SMS Number"}),e.jsx("input",{type:"text",className:"form-control form-control-sm w-50 rounded-2",name:"sms_number",id:"sms_number",disabled:n,defaultValue:t&&t.smsNumber?t.smsNumber:""})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center py-1 px-2 border-bottom",children:[e.jsx("label",{htmlFor:"other_numbers",className:"form-label small",children:"Other Numbers (comma separated)"}),e.jsx("input",{type:"text",className:"form-control form-control-sm w-50 rounded-2",name:"other_numbers",id:"other_numbers",disabled:n,defaultValue:t&&t.other_numbers?t.other_numbers:"",placeholder:"(comma separated)"})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center py-1 px-2 border-bottom custom-bg-whitesmoke",children:[e.jsx("label",{htmlFor:"email_address",className:"form-label small",children:"Email Address"}),e.jsx("input",{type:"email",className:"form-control form-control-sm w-50 rounded-2",name:"email_address",id:"email_address",disabled:n,defaultValue:t&&t.emailAddress?t.emailAddress:""})]}),e.jsxs("div",{className:"d-flex gap-2 justify-content-between align-items-center py-1 px-2 border-bottom",children:[e.jsx("label",{htmlFor:"address",className:"form-label small",children:"Address"}),e.jsx("input",{type:"text",className:"form-control form-control-sm w-50 rounded-2",name:"address",id:"address",disabled:n,defaultValue:t&&t.address?t.address:""})]}),e.jsx("button",{disabled:n,type:"submit",className:"d-block btn btn-info text-white w-100 mt-3",children:n?"Saving...":"Save"})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex gap-2 py-1 px-2 border-bottom custom-bg-whitesmoke",children:[e.jsx("div",{children:"Contact Person: "}),e.jsx("div",{className:"flex-grow-1 text-center",children:t.contactPerson})]}),e.jsxs("div",{className:"d-flex gap-2 py-1 px-2 border-bottom",children:[e.jsx("div",{children:"SMS Number: "}),e.jsx("div",{className:"flex-grow-1 text-center",children:t.smsNumber})]}),e.jsxs("div",{className:"d-flex gap-2 py-1 px-2 border-bottom custom-bg-whitesmoke",children:[e.jsx("div",{children:"Other Numbers: "}),e.jsx("div",{className:"flex-grow-1 text-center",children:t.otherNumbers})]}),e.jsxs("div",{className:"d-flex gap-2 py-1 px-2 border-bottom",children:[e.jsx("div",{children:"Email Address: "}),e.jsx("div",{className:"flex-grow-1 text-center",children:t.emailAddress})]}),e.jsxs("div",{className:"d-flex gap-2 py-1 px-2 border-bottom custom-bg-whitesmoke",children:[e.jsx("div",{children:"Address: "}),e.jsx("div",{className:"flex-grow-1 text-center",children:t.address})]}),e.jsx("div",{className:"mt-4 px-2",children:e.jsx("button",{onClick:()=>x(!0),type:"button",className:"d-block btn btn-info w-100 text-white",children:"Edit"})})]})]})})}function bt({data:o}){return e.jsx(ee,{title:"forecast inflows",children:e.jsxs("table",{className:"table table-sm table-responsive table-bordered  mb-0",children:[e.jsx("thead",{className:"custom-bg-grey-2 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{children:"0-7 Days"}),e.jsx("th",{children:"8-14 Days"}),e.jsx("th",{children:"15-21 Days"}),e.jsx("th",{children:"21+ Days"}),e.jsx("th",{children:"total"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{children:o.zeroToSevenDays}),e.jsx("td",{children:o.eightToFourteenDays}),e.jsx("td",{children:o.fourteenToTwentyOneDays}),e.jsx("td",{children:o.twentyOnePlusDays}),e.jsxs("td",{children:["$",o.total]})]})})]})})}function gt(o,d){const[t,i]=h.useState(o),[b,x]=h.useState(""),[m,u]=h.useState(!1),[n,c]=h.useState("note");function r(j){j.preventDefault(),u(!0),x("");const v=Object.fromEntries(new FormData(j.target).entries());v.client_id=d.toString(),v.reminder_type=n.toUpperCase(),n==="note"&&(v.action_date=new Date().toISOString().split("T")[0]),X.post(reverseUrl("communication_history"),v).then(a=>{i(s=>[...s,{text:a.data.message,actionDone:a.data.action_done,user:a.data.user_name,communicationType:a.data.reminder_type.toLowerCase(),timestamp:a.data.created_at}]),x(""),u(!1)}).catch(a=>{a instanceof ne?x(a.response.status===500?`Error: ${a.response.statusText}`:JSON.stringify(a.response.data)):x(a),u(!1)})}return{messages:t,handleSubmit:r,error:b,setError:x,isLoading:m,remainderType:n,setRemainderType:c}}function ft({lease:o,messages:d,clientId:t}){const{error:i,messages:b,isLoading:x,remainderType:m,setRemainderType:u,handleSubmit:n,setError:c}=gt(d,t);return e.jsxs(e.Fragment,{children:[e.jsx(ze,{isOpen:m==="works",close:()=>u("note"),lease:o}),e.jsx(ee,{noBoundary:!0,title:"communication history",children:e.jsxs("div",{className:"custom-bg-whitesmoke px-5 py-3",children:[e.jsxs("div",{className:"custom-vh-50 custom-overflow-y-auto",children:[b.map((r,j)=>e.jsxs("div",{className:"custom-message py-2 px-3 border shadow-sm mb-3",children:[e.jsx("small",{children:r.text+(r.communicationType.toLowerCase().trim()!=="note"&&r.actionDone?` (action date: ${he(r.actionDone)})`:"")}),e.jsxs("div",{className:"mt-2 d-flex justify-content-end align-items-center text-end gap-2",children:[e.jsx("small",{className:"smallest",children:e.jsxs("b",{children:[r.user,r.communicationType&&" | "+r.communicationType.toLowerCase()]})}),e.jsx("small",{className:"text-success smallest",children:he(r.timestamp)})]})]},j)),b.length===0&&e.jsxs("small",{className:"h-100 text-grey d-flex justify-content-center align-items-center text-center",children:["No communication ",e.jsx("br",{})," history"]})]}),e.jsxs("form",{onSubmit:n,className:"border-top border-4 w-100 pt-3",children:[i&&e.jsxs("p",{className:"d-flex align-items-start gap-1 small text-danger",children:[e.jsx("button",{type:"button",onClick:()=>c(""),className:"btn-close btn-sm"}),te.truncate(i,{length:150})]}),e.jsx("textarea",{rows:2,name:"message",id:"message",placeholder:"Type message here...",className:"d-block w-100 p-2 custom-form-control border-0 border-bottom border-bottom-3 border-dark",required:!0,disabled:x}),e.jsxs("div",{className:"d-flex justify-content-center pt-2 gap-2 align-items-center",children:[e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"reminder_type",disabled:x,value:"note",id:"reminder_type-note",checked:m==="note",onChange:r=>u(r.target.value)}),e.jsx("label",{className:"form-check-label",htmlFor:"reminder_type-note",children:"Note"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"reminder_type",disabled:x,value:"sms",id:"reminder_type-sms",checked:m==="sms",onChange:r=>u(r.target.value)}),e.jsx("label",{className:"form-check-label",htmlFor:"reminder_type-sms",children:"SMS"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"reminder_type",disabled:x,value:"email",id:"reminder_type-email",checked:m==="email",onChange:r=>u(r.target.value)}),e.jsx("label",{className:"form-check-label",htmlFor:"reminder_type-email",children:"Email"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"reminder_type",disabled:x,value:"reminder",id:"reminder_type-reminder",checked:m==="reminder",onChange:r=>u(r.target.value)}),e.jsx("label",{className:"form-check-label",htmlFor:"reminder_type-reminder",children:"Reminder"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"reminder_type",disabled:x,value:"works",id:"reminder_type-works",checked:m==="works",onChange:r=>u(r.target.value)}),e.jsx("label",{className:"form-check-label",htmlFor:"reminder_type-works",children:"Works"})]})]}),m!=="note"&&m!=="works"&&e.jsxs("div",{className:"d-flex my-2 gap-2 align-items-center justify-content-center",children:[e.jsx("label",{htmlFor:"action_date",className:"small d-block text-nowrap form-label",children:`${m==="reminder"?"Show":"Send"} ${m} on:`}),e.jsx("input",{min:new Date().toISOString().split("T")[0],type:"date",className:"form-control form-control-sm rounded-4",name:"action_date",id:"action_date",required:!0})]}),e.jsx("button",{disabled:x,type:"submit",className:"d-block btn btn-info w-100 mt-4 text-white",children:x?"Submiting...":"Submit"})]})]})})]})}function Nt(o,d,t){const[i,b]=h.useState(o),[x,m]=h.useState(""),[u,n]=h.useState(!1),[c,r]=h.useState([]);function j(){n(!0),m("");const s={plans:c.map(l=>I(k({},l),{client_id:d.toString()}))};X.post(reverseUrl("payment_plans"),s).then(l=>{r([]),m(""),n(!1),t()}).catch(l=>{l instanceof ne?m(l.response.status===500?`Error: ${l.response.statusText}`:JSON.stringify(l.response.data)):m(l),r([]),n(!1)})}function v(s){r(l=>[...l,s])}function a(){r([])}return{paymentPlans:i,newPaymentPlans:c,addNewPaymentPlan:v,confirmNewPaymentPlans:j,clearNewPaymentPlans:a,error:x,setError:m,isLoading:u}}function jt({addNewPaymentPlan:o}){function d(t){t.preventDefault();const i=Object.fromEntries(new FormData(t.target).entries());o(i)}return e.jsx(ee,{title:"payment plan",children:e.jsxs("form",{onSubmit:d,className:"p-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center gap-5 mb-2",children:[e.jsx("label",{htmlFor:"spoke_with",className:"text-nowrap",children:"Person spoken with:"}),e.jsx("input",{type:"text",name:"spoke_with",id:"spoke_with",placeholder:"Person spoken with here",className:"custom-form-control border-0 border-bottom border-bottom-3 border-dark",required:!0})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center gap-5 mb-2",children:[e.jsx("label",{htmlFor:"expected_pay_date",className:"text-nowrap",children:"Expected Pay Date:"}),e.jsx("input",{type:"date",name:"expected_pay_date",id:"expected_pay_date",className:"custom-form-control border-0 custom-pointer border-bottom border-bottom-3 border-dark",required:!0,defaultValue:new Date().toISOString().split("T")[0],min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center gap-5 mb-2",children:[e.jsx("label",{htmlFor:"amount",className:"text-nowrap",children:"Amount ($):"}),e.jsx("input",{min:0,type:"number",name:"amount",id:"amount",placeholder:"Amount in $",className:"custom-form-control border-0 border-bottom border-bottom-3 border-dark",required:!0})]}),e.jsx("button",{type:"submit",className:"d-block btn btn-info w-100 mt-4 text-white",children:"Add to payment plan"})]})})}function yt({paymentPlans:o}){return e.jsx(ee,{title:"payment plans",children:e.jsx("div",{className:"custom-mx-h-15 overflow-auto",children:e.jsxs("table",{className:"table table-sm table-responsive table-bordered mb-0",children:[e.jsx("thead",{className:"custom-bg-grey-2 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Plan ID"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Date"})]})}),e.jsxs("tbody",{children:[o.map((d,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:d.id||t}),e.jsx("td",{children:d.amount}),e.jsx("td",{children:Ce(d.date)})]},d.id)),o.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center small text-grey py-3",children:"No payment plans"})})]})]})})})}function vt({newPaymentPlans:o,confirmNewPaymentPlans:d,clearNewPaymentPlans:t,error:i,setError:b,isLoading:x}){return e.jsx(ee,{title:"plan details",children:e.jsxs("div",{className:"p-3 pb-2",children:[e.jsxs("div",{className:"custom-h-07 overflow-auto",children:[o.map((m,u)=>e.jsx("div",{className:"p-1 small border-bottom",children:`${m.spoke_with} promised to pay USD${m.amount} on ${Ce(m.expected_pay_date)}`},u)),o.length===0&&e.jsx("div",{className:"text-center small text-grey py-3",children:"No new payment plans"})]}),e.jsxs("div",{className:"pt-2 bg-white",children:[i&&e.jsxs("p",{className:"d-flex align-items-start gap-1 small text-danger",children:[e.jsx("button",{type:"button",onClick:()=>b(""),className:"btn-close btn-sm"}),te.truncate(i,{length:150})]}),e.jsxs("div",{className:"d-flex gap-3",children:[e.jsx("button",{type:"button",onClick:d,className:"d-block btn btn-info w-100 text-white",disabled:x||!o.length,children:x?"Saving...":"Save plan"}),e.jsx("button",{type:"button",onClick:t,className:"d-block btn btn-dark w-100 text-white",disabled:x||!o.length,children:"Clear All"})]})]})]})})}function wt({paymentPlans:o,clientId:d,refreshClientViewData:t}){const{paymentPlans:i,newPaymentPlans:b,addNewPaymentPlan:x,confirmNewPaymentPlans:m,clearNewPaymentPlans:u,error:n,setError:c,isLoading:r}=Nt(o,d,t);return e.jsxs(e.Fragment,{children:[e.jsx(jt,{addNewPaymentPlan:x,clientId:d}),e.jsx(vt,{newPaymentPlans:b,confirmNewPaymentPlans:m,clearNewPaymentPlans:u,error:n,setError:c,isLoading:r}),e.jsx(yt,{paymentPlans:i})]})}function _t({clientViewProps:{showModal:o,hideClientView:d,data:t,error:i,isLoading:b,clientId:x,refreshClientViewData:m,lease:u}}){const n=!t;return e.jsx(e.Fragment,{children:e.jsxs($,{show:o,onHide:d,fullscreen:!0,contentClassName:"custom-bg-whitesmoke",children:[e.jsx($.Header,{className:"p-0",children:e.jsxs("div",{className:"w-100 p-2 text-center bg-info position-relative",children:[e.jsx("h4",{className:"text-white",children:b||i||n?"Client View":t.tenantName}),e.jsx("button",{type:"button",onClick:d,className:"btn position-absolute top-0 end-0 h-100 d-flex align-items-center text-white",children:e.jsx("i",{className:"material-icons fs-3 px-4",children:"close"})})]})}),e.jsx($.Body,{children:e.jsxs("div",{className:"position-relative custom-mn-h-5",children:[b&&e.jsxs("div",{className:"text-center position-absolute top-50 start-50 translate-middle",children:[e.jsx("div",{className:"spinner-border text-info spinner-border-md",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{children:"Loading...please wait"})]}),i&&e.jsxs("div",{className:"text-center text-danger position-absolute top-50 start-50 translate-middle",children:[e.jsx("p",{children:e.jsx("i",{className:"material-icons fs-1",children:"warning"})}),e.jsxs("p",{children:["Error: ",te.truncate(i,{length:500})]})]}),!(b||i||n)&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"row row-cols-3 align-items-stretch",children:[e.jsxs("div",{className:"col p-1",children:[e.jsx(mt,{data:t.agedAnalysis}),e.jsx(ut,{data:t.debtorIntelligence,clientId:x}),e.jsx(pt,{data:t.contactDetails,clientId:x})]}),e.jsx("div",{className:"col p-1",children:e.jsx(ft,{messages:t.communicationHistory,clientId:x,lease:u})}),e.jsxs("div",{className:"col p-1",children:[e.jsx(bt,{data:t.forecastInflows}),e.jsx(wt,{clientId:x,paymentPlans:t.paymentPlans,refreshClientViewData:m})]})]})})]})})]})})}function St(){const[o,d]=h.useState(!1),[t,i]=h.useState(null),[b,x]=h.useState(""),[m,u]=h.useState(!1),[n,c]=h.useState(null);function r(a){c(a),d(!0),u(!0),x(""),X(reverseUrl("client_details"),{params:{lease_id:a.lease_id}}).then(s=>{const l={tenantName:a.name,agedAnalysis:{oneTwentyDays:s.data.aged_analysis["120_days_plus"],ninetyDays:s.data.aged_analysis["90_days"],sixtyDays:s.data.aged_analysis["60_days"],thirtyDays:s.data.aged_analysis["30_days"],current:s.data.aged_analysis.current},contactDetails:{contactPerson:`${s.data.client.firstname} ${s.data.client.surname}`,smsNumber:s.data.client.sms_number,otherNumbers:s.data.other_numbers?s.data.client.other_numbers.join(", "):"",emailAddress:s.data.client.email,address:s.data.client.address},paymentPlans:s.data.payment_plans.map(y=>({id:y.id,person:y.spoke_with,date:y.expected_pay_date,amount:y.amount})),communicationHistory:s.data.communication_history.map(y=>({text:y.message,timestamp:y.created_at,user:y.user_name,actionDone:y.action_done?y.action_done:null,communicationType:y.type})),debtorIntelligence:Object.values(s.data.debtor_intelligence).length&&Object.values(s.data.debtor_intelligence).every(Boolean)?{text:s.data.debtor_intelligence.note,timestamp:s.data.debtor_intelligence.updated_at,user:s.data.debtor_intelligence.user_name}:null,forecastInflows:{zeroToSevenDays:s.data.forecast_inflows["0-7"],eightToFourteenDays:s.data.forecast_inflows["8-14"],fourteenToTwentyOneDays:s.data.forecast_inflows["14-21"],twentyOnePlusDays:s.data.forecast_inflows["21+"],total:s.data.forecast_inflows.total}};console.log({res:s,resData:l}),i(l),x(""),u(!1)}).catch(s=>{s instanceof ne?x(s.response.status===500?`Error: ${s.response.statusText}`:JSON.stringify(s.response.data)):x(s),i(null),u(!1)})}function j(){console.log("refreshing.."),u(!0),x(""),X(reverseUrl("client_details"),{params:{lease_id:n.lease_id}}).then(a=>{const s={tenantName:n.name,agedAnalysis:{oneTwentyDays:a.data.aged_analysis["120_days_plus"],ninetyDays:a.data.aged_analysis["90_days"],sixtyDays:a.data.aged_analysis["60_days"],thirtyDays:a.data.aged_analysis["30_days"],current:a.data.aged_analysis.current},contactDetails:{contactPerson:`${a.data.client.firstname} ${a.data.client.surname}`,smsNumber:a.data.client.sms_number,otherNumbers:a.data.other_numbers?a.data.client.other_numbers.join(", "):"",emailAddress:a.data.client.email,address:a.data.client.address},paymentPlans:a.data.payment_plans.map(l=>({id:l.id,person:l.spoke_with,date:l.expected_pay_date,amount:l.amount})),communicationHistory:a.data.communication_history.map(l=>({text:l.message,timestamp:l.created_at,user:l.user_name,actionDone:l.action_done?l.action_done:null,communicationType:l.type})),debtorIntelligence:Object.values(a.data.debtor_intelligence).length&&Object.values(a.data.debtor_intelligence).every(Boolean)?{text:a.data.debtor_intelligence.note,timestamp:a.data.debtor_intelligence.updated_at,user:a.data.debtor_intelligence.user_name}:null,forecastInflows:{zeroToSevenDays:a.data.forecast_inflows["0-7"],eightToFourteenDays:a.data.forecast_inflows["8-14"],fourteenToTwentyOneDays:a.data.forecast_inflows["14-21"],twentyOnePlusDays:a.data.forecast_inflows["21+"],total:a.data.forecast_inflows.total}};i(s),x(""),u(!1)}).catch(a=>{a instanceof ne?x(a.response.status===500?`Error: ${a.response.statusText}`:JSON.stringify(a.response.data)):x(a),i(null),u(!1)})}function v(){d(!1)}return{showModal:o,openClientView:r,hideClientView:v,data:t,error:b,isLoading:m,clientId:n?n.id:null,refreshClientViewData:j,lease:n}}function Tt(){const{props:{error:o},url:d}=Se();let t=new URL(d).searchParams.get("color");const[i,b]=h.useState(!1),[x,m]=h.useState(!1),[u,n]=h.useState({}),[c,r]=h.useState([]),[j,v]=h.useState({}),[a,s]=h.useState(!1),[l,y]=h.useState(!1),[R,F]=h.useState(0),[P,Y]=h.useState(!1),[A,C]=h.useState(!1),[B,w]=h.useState(""),[U,J]=h.useState(!1),[K,W]=h.useState(!1),[V,H]=h.useState(""),[g,N]=h.useState(""),[O,M]=h.useState(t?"rent-owing-des":"default"),q=St(),z=(S,_)=>{W(!0),N(_),H(S)},Q=()=>{W(!1),N(""),H("")};h.useEffect(()=>{X.post(reverseUrl("open_subscription")).then(S=>{r(S.data)}).catch(S=>{})},[r]);const D=document.getElementById("hide-footer");switch(h.useEffect(()=>(D!==null&&document.getElementById("footer").classList.add("d-none"),()=>{D!==null&&document.getElementById("footer").classList.remove("d-none")}),[D]),t){case"orange":t="warning";break;case"black":t="black";break;case"red":t="red";break;case"green":t="success";break;case"#991b1b":t="danger";break}o&&T.error(o);function p(S){M(S.target.value)}let f=S=>S;function Z(S){console.log(S),X.post(reverseUrl("write-off"),{lease_id:S.lease_id}).then(_=>{console.log(_),Re.Inertia.reload()}).catch(_=>{var E,ae;console.log(_);const L=(ae=(E=_==null?void 0:_.response)==null?void 0:E.data)!=null&&ae.errors?JSON.stringify(_.response.data.errors):JSON.stringify(_);T.error(`An error occured:
`+te.truncate(L,{length:200}))})}switch(O){case"rent-owing-asc":f=S=>{const _=[...S];return _.sort((L,E)=>L.owing_amount-E.owing_amount),_};break;case"rent-owing-des":f=S=>{const _=[...S];return _.sort((L,E)=>E.owing_amount-L.owing_amount),_};break;case"color-asc":f=S=>{const _={};S.forEach(E=>{E.color in _?_[E.color].push(E):_[E.color]=[E]});let L=[];return Object.keys(_).forEach(E=>{L=L.concat(_[E].sort((ae,ie)=>ae.owing_amount-ie.owing_amount))}),L};break;case"color-des":f=S=>{const _={};S.forEach(E=>{E.color in _?_[E.color].push(E):_[E.color]=[E]});let L=[];return Object.keys(_).forEach(E=>{L=L.concat(_[E].sort((ae,ie)=>ie.owing_amount-ae.owing_amount))}),L};break;default:f=S=>S;break}return{totalColor:t,writeOff:Z,btnAdd:i,setBtnAdd:b,editBtn:x,setEditBtn:m,details:u,setDetails:n,subscriptions:c,setSubscriptions:r,subscription:j,setSubscription:v,terminate:a,setTerminate:s,showReceipt:l,setShowReceipt:y,subLength:R,setSubLength:F,showVerify:P,setShowVerify:Y,isVerified:A,setIsVerified:C,verificationType:B,setVerificationType:w,isVisible:U,setIsVisible:J,showAlert:K,setShowAlert:W,message:V,setMessage:H,leaseeName:g,setLeaseeName:N,clientViewProps:q,handleShowAlert:z,error:o,hideFooter:D,handleCloseAlert:Q,sort:O,changeSort:p,sortFunc:f}}const Ct=({show:o,handleClose:d,url:t,setVerified:i,verification_type:b,setCreditInfo:x})=>{const[m,u]=h.useState(!1),[n,c]=h.useState({}),{data:r,setData:j,post:v,reset:a}=ce({otp:"",verification_type:b}),[s,l]=h.useState(!1),[y,R]=h.useState(30);h.useEffect(()=>{const C=setInterval(()=>{R(B=>B<=1?(clearInterval(C),l(!0),0):B-1)},1e3);return()=>clearInterval(C)},[]);const F=()=>re(void 0,null,function*(){l(!1);try{(yield X.get(reverseUrl("new_otp"))).data.status==="success"?T.success("OTP sent successfully"):T.error("Something went wrong! Please try again")}catch(C){T.error("Something went wrong! Please try again")}}),P=C=>j(I(k({},r),{[C.target.id]:C.target.value})),Y=()=>r.otp.length!==4?(c({otp:"otp must be four digits"}),!1):parseInt(r.otp,10)?!0:(c({otp:"otp must be a number"}),!1),A=C=>{console.log("indi"),C.preventDefault(),Y()&&(v(reverseUrl(t),{onStart:()=>{u(!0)},onSuccess:B=>{d(),a(),T.success("Verification successful"),u(!1),typeof i=="function"&&i(!0)},onError:B=>{T.error("Something went wrong! Please try again"),c(B),console.log(erros),u(!1)}}),u(!1))};return e.jsx(e.Fragment,{children:e.jsx($,{size:"lg",show:o,onHide:d,centered:!0,children:e.jsx("div",{children:e.jsxs("div",{className:"card card-raised",children:[e.jsx("div",{className:"card-header bg-info px-4",children:e.jsxs("div",{className:`d-flex justify-content-between
                                align-items-center`,children:[e.jsxs("div",{className:"me-4",children:[e.jsx("h2",{className:"display-6 mb-0 text-white",children:"Verify OTP"}),e.jsx("div",{className:"card-text"})]}),e.jsx("div",{className:"d-flex gap-2"})]})}),e.jsx("div",{className:"card-body p-4",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body p-4",style:{borderStyle:"solid",borderColor:"#26a69a"},children:[e.jsx($.Body,{children:e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"col-md-12",children:[e.jsx("div",{children:e.jsx("p",{children:b==="individual"?"Enter the 4-digit code we sent to user's mobile number. This code will expire after 5 minutes":"Enter the 4-digit code we sent to user's email. This code will expire after 5 minutes"})}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Verification Code"}),e.jsx("input",{value:r.otp,onChange:P,type:"text",name:"otp",id:"otp",placeholder:"Enter your 4 digit otp",className:"form-control form-control-sm"}),n&&e.jsx("div",{className:"text-danger mt-1",children:n.otp})]})})]}),e.jsxs("div",{className:"mt-5 d-flex gap-4 align-items-center ",children:[e.jsxs("p",{children:["Didn't receive code?",e.jsx("button",{onClick:F,className:"ms-2 text-decoration-underline border-0 bg-transparent text-info",disabled:s===!1,children:"Resend Code"})]}),y>0&&e.jsx("p",{className:"text-success",children:`Resend code in ${y} seconds`})]})]})}),e.jsx($.Footer,{children:e.jsx(me,{className:"text-white",variant:"info",onClick:C=>A(C),disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ml-2",children:"processing.."})]}):"Verify"})})]})})})]})})})})};function Pt({leases:o,total_pages:d,total_items:t,current_page:i}){const{totalColor:b,writeOff:x,btnAdd:m,setBtnAdd:u,editBtn:n,setEditBtn:c,details:r,setDetails:j,subscriptions:v,subscription:a,setSubscription:s,terminate:l,setTerminate:y,showReceipt:R,setShowReceipt:F,subLength:P,setSubLength:Y,showVerify:A,setShowVerify:C,setIsVerified:B,verificationType:w,setVerificationType:U,isVisible:J,setIsVisible:K,showAlert:W,setShowAlert:V,message:H,setMessage:g,leaseeName:N,clientViewProps:O,handleShowAlert:M,handleCloseAlert:q,sort:z,changeSort:Q,sortFunc:D}=Tt();return console.log(b),console.log({allState:{leases:o,total_pages:d,total_items:t,current_page:i,btnAdd:m,editBtn:n,details:r,subscriptions:v,subscription:a,terminate:l,showReceipt:R,subLength:P,showVerify:A,verificationType:w,isVisible:J,showAlert:W,message:H,leaseeName:N,clientViewProps:O}}),e.jsxs(e.Fragment,{children:[e.jsxs(e.Fragment,{children:[e.jsx(_t,{clientViewProps:O}),e.jsxs(ve,{onClose:q,show:W&&!!H,delay:1e4,className:"w-100 shadow-none mb-3",style:{background:"#dcfce7"},autohide:!0,children:[e.jsxs(ve.Header,{className:"w-100",children:[e.jsx("strong",{className:"me-auto",children:N?`Following message has been sent to ${N}`:""}),e.jsx("small",{className:"text-muted text-capitalize ms-auto",children:"just now"})]}),e.jsx("p",{className:"p-3 m-0",children:H||""})]}),(a==null?void 0:a.type)==="individual"&&m&&e.jsx(we,{action:"add",show:m,handleClose:()=>{u(!1),j({})},setShowVerify:C,lesseeDetails:r,subscriptionPeriod:P,handleShowAlert:M}),(a==null?void 0:a.type)==="individual"&&n&&e.jsx(we,{action:"edit",show:n,handleClose:()=>{c(!1),j({})},handleShowAlert:M,lesseeDetails:r,subscriptionPeriod:r.lease_period}),(a==null?void 0:a.type)==="company"&&m&&e.jsx(_e,{action:"add",show:m,handleClose:()=>{u(!1),j({})},lesseeDetails:r,subscriptionPeriod:P,handleShowAlert:M}),(a==null?void 0:a.type)==="company"&&n&&e.jsx(_e,{action:"edit",show:n,handleClose:()=>{c(!1),j({})},handleShowAlert:M,lesseeDetails:r,subscriptionPeriod:r.lease_period}),l&&e.jsx(it,{show:l,handleClose:()=>{y(!1),j({})},handleShowAlert:M,leaseData:r}),R&&e.jsx(be,{show:R,handleClose:p=>re(this,null,function*(){g(p),F(!1),V(!0),j({})}),leaseDetails:r,myKey:"leases"}),A&&e.jsx(Ct,{show:A,handleClose:()=>{C(!1)},url:"client-individual-verify-otp",setVerified:B,verification_type:w})]}),e.jsxs("main",{id:"hide-footer",children:[e.jsxs("div",{className:"container-xl p-0 mb-5",children:[e.jsx("h5",{className:"bg-info text-center text-white p-2 rounded-2",children:"Lease Management"}),e.jsxs("div",{className:"row justify-content-between align-items-center my-3 g-2",children:[e.jsx("div",{className:"col-5",children:e.jsx(Ke,{searchBy:"name"})}),e.jsx("div",{className:"col-auto",children:e.jsxs("div",{className:"d-flex border c-bg-light align-items-center",children:[e.jsx("label",{htmlFor:"sort",className:"form-label bg-white c-bg-light d-block my-0 text-nowrap p-1",children:"Sort By:"}),e.jsxs("select",{className:"form-select c-select rounded-0 border",name:"sort",id:"sort",value:z,onChange:Q,children:[e.jsx("option",{value:"default",children:"default"}),e.jsx("option",{value:"rent-owing-asc",children:"Rent Owing asc"}),e.jsx("option",{value:"rent-owing-des",children:"Rent Owing des"}),e.jsx("option",{value:"color-asc",children:"color (rent asc)"}),e.jsx("option",{value:"color-des",children:"color (rent des)"})]})]})})]}),e.jsxs("div",{className:"position-relative bg-white rounded-2 border",children:[e.jsxs("h5",{className:"text-center py-2 mb-0 text-white border bg-info",children:["Active Leases - ",t]}),e.jsxs("table",{className:"table table-sm table-responsive table-bordered ",children:[e.jsx("thead",{className:"position-sticky bg-white shadow-sm c-table-top",children:e.jsxs("tr",{children:[e.jsx("th",{className:"ps-3",children:"Lease ID"}),e.jsx("th",{children:"Tenant"}),e.jsx("th",{children:"Customer Number"}),e.jsx("th",{className:"text-end",children:"Rent Owing"}),e.jsx("th",{colSpan:3,className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:o?D(o).map((p,f)=>e.jsxs("tr",{className:p.terminated?"c-terminated":"",children:[e.jsx("th",{className:"ps-3",children:p.lease_id||""}),e.jsx("td",{children:e.jsx("button",{title:"double click to view client",type:"button",onDoubleClick:()=>O.openClientView(p),className:`custom-btn text-decoration-underline ${p.terminated?"c-terminated":""}`,children:p.name})}),e.jsx("td",{children:p.customer_number}),e.jsx("td",{className:`bg-${p.color} text-white text-end`,style:{backgroundColor:p.color=="light-red"?"#f87171":""},children:`${p.currency} ${de(p.owing_amount).replace("$","")}`}),e.jsx("td",{className:"bg-info text-white text-center c-pointer",onClick:()=>{j(p),F(!0)},children:"Receipt"}),p.terminated?e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"c-terminated text-center",children:"Terminated"}),e.jsx("td",{className:"bg-danger text-white text-center c-pointer",onClick:()=>x(p),children:"Write off"})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"bg-primary text-white text-center c-pointer",onClick:()=>{j(p),c(!0),u(!1),s({type:p.is_company?"company":"individual"})},children:"Adjust"}),e.jsx("td",{className:"bg-danger text-white text-center c-pointer",onClick:()=>{j(p),y(!0)},children:"Terminate"})]})]},p.lease_id+"-"+f)):""}),b&&(o!=null&&o.length)?e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"border-0 pt-5"}),e.jsxs("td",{className:"border-0 pt-5",children:["Total Debtors: ",o==null?void 0:o.length]}),e.jsx("td",{className:"border-0 pt-5",children:"Total mount"}),e.jsx("td",{className:"border-0 pt-5 px-0",children:e.jsx("span",{className:`bg-${b} text-end text-white p-2 w-100 d-inline-block`,style:{backgroundColor:b=="light-red"?"#f87171":b},children:`USD ${de(o?o.reduce((p,f)=>p+f.owing_amount,0):0).replace("$","")}`})}),e.jsx("td",{className:"border-0 pt-5"})]})}):""]}),e.jsx(Qe,{currentPage:i,totalPages:d})]})]}),e.jsx("div",{className:"position-fixed w-100 bottom-0 start-0",children:e.jsx(Ze,{isVisible:J,setIsVisible:K,trigger:e.jsxs("button",{type:"button",className:"btn btn-lg c-bg-warning-light w-100 justify-content-center align-items-center text-capitalize gap-2 ",children:["Open Subscriptions",e.jsx("i",{className:"material-icons fs-3",children:"keyboard_arrow_up"})]}),children:e.jsx(Xe,{title:"Open Subscriptions",children:e.jsxs("table",{className:"table table-responsive table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Open Slots"}),e.jsx("th",{children:"Period (months)"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{colSpan:"2"})]})}),e.jsx("tbody",{children:v==null?void 0:v.map((p,f)=>e.jsx(Ye.Fragment,{children:p.open_slots>0&&e.jsxs("tr",{children:[e.jsx("th",{children:f+1}),e.jsx("td",{children:p.subscription_class}),e.jsx("td",{children:p.open_slots}),e.jsx("td",{children:p.period_length}),e.jsx("td",{children:p.start_date}),e.jsx("td",{children:p.end_date}),e.jsx("td",{colSpan:"2",className:`${p.open_slots===0?"bg-gray":"bg-success"} text-white text-center c-pointer`,onClick:()=>{p.open_slots!==0&&(u(!0),c(!1),K(!1),j({}),s({type:p.subscription_class}),U(p.subscription_class),Y(p.period_left))},children:"Activate"})]},"subscription"+f)},f))})]})})})})]})]})}Pt.layout=o=>e.jsx(Je,{children:o,title:"Leases"});export{Pt as default};
