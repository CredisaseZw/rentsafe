var Pe=Object.defineProperty,Re=Object.defineProperties;var _e=Object.getOwnPropertyDescriptors;var le=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable;var ge=Math.pow,xe=(d,l,a)=>l in d?Pe(d,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):d[l]=a,v=(d,l)=>{for(var a in l||(l={}))pe.call(l,a)&&xe(d,a,l[a]);if(le)for(var a of le(l))fe.call(l,a)&&xe(d,a,l[a]);return d},T=(d,l)=>Re(d,_e(l));var oe=(d,l)=>{var a={};for(var t in d)pe.call(d,t)&&l.indexOf(t)<0&&(a[t]=d[t]);if(d!=null&&le)for(var t of le(d))l.indexOf(t)<0&&fe.call(d,t)&&(a[t]=d[t]);return a};var Q=(d,l,a)=>new Promise((t,f)=>{var g=c=>{try{u(a.next(c))}catch(s){f(s)}},m=c=>{try{u(a.throw(c))}catch(s){f(s)}},u=c=>c.done?t(c.value):Promise.resolve(c.value).then(g,m);u((a=a.apply(d,l)).next())});import{r as o,j as e,a as ae,b as re,u as Me}from"./main-159d3891.js";import"./PageHeader-97f3b1b8.js";import{L as Ee}from"./Layout-dcae7a62.js";import{h as M}from"./moment-686b5dfa.js";import{_ as b,I as de}from"./index-fb59542d.js";import{f as K}from"./formatting-345d2430.js";import{u as Ae,a as Ye,F as Oe,b as ce,c as Ie,d as me,C as ke,M as I}from"./Modal-09026bab.js";import{M as ye}from"./MultipleUpload-2ec12698.js";import{B as H}from"./Button-c9c478d7.js";import{S as Le}from"./search-903298dd.js";import{B as He,D as Ve}from"./DrawerContent-e505ca72.js";import{E as Fe,a as Ue}from"./removeClass-e5c3440d.js";import"./index-d26e8feb.js";import"./lodash-a81afe97.js";const ie=ge(2,31)-1;function ve(d,l,a){const t=a-Date.now();d.current=t<=ie?setTimeout(l,t):setTimeout(()=>ve(d,l,a),ie)}function Ge(){const d=Ae(),l=o.useRef();return Ye(()=>clearTimeout(l.current)),o.useMemo(()=>{const a=()=>clearTimeout(l.current);function t(f,g=0){d()&&(a(),g<=ie?l.current=setTimeout(f,g):ve(l,f,Date.now()+g))}return{set:t,clear:a,handleRef:l}},[])}const $e={[Fe]:"showing",[Ue]:"showing show"},we=o.forwardRef((d,l)=>e.jsx(Oe,T(v({},d),{ref:l,transitionClasses:$e})));we.displayName="ToastFade";const ze=we,qe=o.createContext({onClose(){}}),Se=qe,Te=o.forwardRef((c,u)=>{var s=c,{bsPrefix:d,closeLabel:l="Close",closeVariant:a,closeButton:t=!0,className:f,children:g}=s,m=oe(s,["bsPrefix","closeLabel","closeVariant","closeButton","className","children"]);d=ce(d,"toast-header");const B=o.useContext(Se),A=Ie(h=>{B==null||B.onClose==null||B.onClose(h)});return e.jsxs("div",T(v({ref:u},m),{className:me(d,f),children:[g,t&&e.jsx(ke,{"aria-label":l,variant:a,onClick:A,"data-dismiss":"toast"})]}))});Te.displayName="ToastHeader";const We=Te,Ce=o.forwardRef((g,f)=>{var m=g,{className:d,bsPrefix:l,as:a="div"}=m,t=oe(m,["className","bsPrefix","as"]);return l=ce(l,"toast-body"),e.jsx(a,v({ref:f,className:me(d,l)},t))});Ce.displayName="ToastBody";const Ze=Ce,Be=o.forwardRef((Y,n)=>{var r=Y,{bsPrefix:d,className:l,transition:a=ze,show:t=!0,animation:f=!0,delay:g=5e3,autohide:m=!1,onClose:u,onEntered:c,onExit:s,onExiting:B,onEnter:A,onEntering:h,onExited:E,bg:L}=r,k=oe(r,["bsPrefix","className","transition","show","animation","delay","autohide","onClose","onEntered","onExit","onExiting","onEnter","onEntering","onExited","bg"]);d=ce(d,"toast");const p=o.useRef(g),x=o.useRef(u);o.useEffect(()=>{p.current=g,x.current=u},[g,u]);const j=Ge(),w=!!(m&&t),O=o.useCallback(()=>{w&&(x.current==null||x.current())},[w]);o.useEffect(()=>{j.set(O,p.current)},[j,O]);const P=o.useMemo(()=>({onClose:u}),[u]),$=!!(a&&f),V=e.jsx("div",T(v({},k),{ref:n,className:me(d,l,L&&`bg-${L}`,!$&&(t?"show":"hide")),role:"alert","aria-live":"assertive","aria-atomic":"true"}));return e.jsx(Se.Provider,{value:P,children:$&&a?e.jsx(a,{in:t,onEnter:A,onEntering:h,onEntered:c,onExit:s,onExiting:B,onExited:E,unmountOnExit:!0,children:V}):V})});Be.displayName="Toast";const Ne=Object.assign(Be,{Body:Ze,Header:We});function he({show:d,handleClose:l,leaseDetails:a}){var r;const[t,f]=o.useState(""),[g,m]=o.useState(!1),[u,c]=o.useState(0),[s,B]=o.useState({}),[A,h]=o.useReducer(n,[]),{data:E,post:L,reset:k}=ae([]);function n(p,x){switch(x.type){case"initialize":return[...p,...x.payload];case"updatePaymentAmount":return p.map(j=>j.lease_id===x.payload.lease_id?T(v({},j),{paymentAmount:x.payload.paymentAmount}):j);case"updatePaymentDate":return p.map(j=>j.lease_id===x.payload.lease_id?T(v({},j),{paymentDate:x.payload.paymentDate}):j);case"updateReceiptNumber":return p.map(j=>j.lease_id===x.payload.lease_id?T(v({},j),{receiptNumber:x.payload.receiptNumber}):j);case"updateDetails":return p.map(j=>j.lease_id===x.payload.lease_id?T(v({},j),{details:x.payload.details}):j);default:return p}}o.useEffect(()=>{re.get(reverseUrl("get_all_active_leases")).then(p=>{var x,j,w,O;h({type:"initialize",payload:(j=(x=p.data)==null?void 0:x.result)==null?void 0:j.map(P=>T(v({},P),{balance_amount:P.balance_amount,paymentAmount:0,paymentDate:new Date().toISOString().split("T")[0],receiptNumber:"",details:""}))}),B(T(v({},(O=(w=p.data)==null?void 0:w.result)==null?void 0:O.find(P=>P.lease_id===a.lease_id)),{paymentAmount:0,paymentDate:new Date().toISOString().split("T")[0],receiptNumber:"",details:""}))}).catch(p=>{b.error("Something went wrong getting tenant details! Please try refreshing the page")})},[]);const Y=p=>Q(this,null,function*(){if(p.preventDefault(),m(!0),A.forEach(x=>{x.paymentAmount>0&&E.push({leaseId:x.lease_id,paymentAmount:x.paymentAmount,paymentDate:x.paymentDate,receiptNumber:x.receiptNumber,details:x.details})}),s.paymentAmount>0&&E.push({leaseId:s.lease_id,paymentAmount:Number(s.paymentAmount),paymentDate:s.paymentDate,receiptNumber:s.receiptNumber,details:s.details}),E.length===0){b.error("Please add at least one payment");return}L(reverseUrl("create_receipt_and_payment"),{onSuccess:x=>{var j,w;if(((j=x.props)==null?void 0:j.result)==="error"){b.error((w=x.props)==null?void 0:w.result);return}l("Receipts created successfully").then(()=>{k()})},onError:x=>{f(x),b.error("Something went wrong! Please try again")},onFinish:()=>{m(!1)}})});return e.jsx("div",{className:"container-xl p-5",children:e.jsxs("div",{className:"card card-raised",children:[e.jsx(de,{position:"top-right",duration:"4000"}),e.jsx("div",{className:"card-body p-4",children:e.jsxs(I,{show:d,onHide:l,size:"xl",backdrop:"static",centered:!0,children:[e.jsx(I.Header,{closeButton:!0}),e.jsx(I.Body,{className:"p-4 d-flex w-100 flex-column justify-content-between align-items-center",children:e.jsxs("div",{className:"table-responsive  w-100 ",children:[e.jsx("div",{className:"flex justify-content-center align-items-center w-100",children:e.jsx("h5",{className:"text-center tf-color bg-info",children:"Rent Receipt"})}),e.jsxs("table",{className:"table table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderTop:"0px",fontSize:"12px",width:"100%"},children:[e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Date"}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Customer"}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Receipt No."}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Details"}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Currency"}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Amount Owing"}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Received Amount"}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid",borderBottom:"1px solid"},children:"Amount Balance"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"tf-borderRight",style:{paddingRight:"1px",paddingLeft:"1px"},children:e.jsx("input",{onChange:p=>B(T(v({},s),{paymentDate:p.target.value})),className:"form-control form-control-sm tf-borderRight tf-input",type:"date",name:"date",id:"date",value:s==null?void 0:s.paymentDate,max:new Date().toISOString().split("T")[0],min:s!=null&&s.opening_balance_date?new Date((r=s.opening_balance_date.split("T"))==null?void 0:r[0]).toISOString().split("T")[0]:"",style:{width:"100%",border:"1px solid #111"}})}),e.jsx("td",{className:"tf-borderRight",style:{paddingRight:"1px",paddingLeft:"1px"},children:s==null?void 0:s.tenant}),e.jsx("td",{className:"tf-borderRight",style:{paddingRight:"1px",paddingLeft:"1px",maxWidth:"60px"},children:e.jsx("input",{onChange:p=>B(T(v({},s),{receiptNumber:p.target.value})),className:"form-control form-control-sm tf-borderRight tf-input",type:"text",name:"receiptNumber",id:"receiptNumber",value:s==null?void 0:s.receiptNumber,style:{width:"100%",border:"1px solid #111"}})}),e.jsx("td",{className:"tf-borderRight",style:{paddingRight:"1px",paddingLeft:"1px"},children:e.jsx("input",{onChange:p=>B(T(v({},s),{details:p.target.value})),className:"form-control form-control-sm tf-borderRight tf-input",type:"text",name:"details",id:"details",value:s==null?void 0:s.details,style:{width:"100%",border:"1px solid #111"}})}),e.jsx("td",{className:"tf-borderRight",style:{paddingRight:"1px",paddingLeft:"1px"},children:s==null?void 0:s.Currency}),e.jsx("td",{className:`tf-borderRight bg-${s==null?void 0:s.color} text-white text-end`,style:{paddingRight:"1px",paddingLeft:"1px"},children:K(s==null?void 0:s.rent_owing)}),e.jsxs("td",{className:"tf-borderRight",style:{paddingRight:"1px",paddingLeft:"1px"},children:[e.jsx("input",{onChange:p=>{B(T(v({},s),{paymentAmount:p.target.value}))},className:"form-control form-control-sm tf-borderRight tf-input",name:"paymentAmount",id:"paymentAmount",value:(s==null?void 0:s.paymentAmount)===0?"":s==null?void 0:s.paymentAmount,style:{width:"100%",border:"1px solid #111"}}),t&&e.jsx("div",{className:"alert alert-danger",role:"alert",children:t==null?void 0:t.paymentAmount})]}),e.jsx("td",{className:"tf-borderRight text-end",style:{paddingRight:"1px",paddingLeft:"1px",borderBottom:"1px solid #e0e0e0"},children:K((s==null?void 0:s.balance_amount)-(s==null?void 0:s.paymentAmount))})]}),u>0&&Array.from({length:u},(p,x)=>e.jsx(De,{leases:A,dispatch:h},x))]})]}),e.jsx("div",{className:"d-flex flex-row-reverse",children:e.jsxs("button",{className:"btn btn-raised bg-success text-white",style:{backgroundColor:"#0d475c"},onClick:()=>c(p=>p+1),children:[e.jsx("i",{className:"leading-icon material-icons",children:"add"}),"Add Receipts"]})})]})}),e.jsx(I.Footer,{className:"p-4 d-flex justify-content-center",children:e.jsx("div",{className:"d-flex flex-row-reverse",children:e.jsx("button",{className:"btn btn-raised bg-info text-white",style:{backgroundColor:"#0d475c"},onClick:Y,children:g?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ml-2",children:"Processing.."})]}):e.jsx(e.Fragment,{children:"Submit"})})})})]})})]})})}function De({leases:d,dispatch:l}){var f,g;const[a,t]=o.useState(null);return o.useEffect(()=>{a&&t(d.find(m=>m.lease_id===a.lease_id))},[d]),e.jsxs("tr",{children:[e.jsx("td",{className:"tf-borderRight",style:{paddingRight:"1px",paddingLeft:"1px"},children:e.jsx("input",{onChange:m=>a&&l({type:"updatePaymentDate",payload:{lease_id:a.lease_id,paymentDate:m.target.value}}),className:"form-control form-control-sm tf-borderRight tf-input",type:"date",name:"date",id:"date",value:a==null?void 0:a.paymentDate,max:new Date().toISOString().split("T")[0],min:a!=null&&a.opening_balance_date?new Date((f=a.opening_balance_date.split("T"))==null?void 0:f[0]).toISOString().split("T")[0]:"",style:{width:"100%",border:"1px solid #111"}})}),e.jsx("td",{className:"tf-borderRight",style:{paddingRight:"1px",paddingLeft:"1px"},children:e.jsxs("select",{onChange:m=>{t(d.find(u=>u.lease_id===parseInt(m.target.value)))},className:"form-control form-control-sm tf-borderRight tf-input",name:"lease",id:"lease",style:{width:"100%",border:"1px solid #e0e0e0",borderTop:"0px"},children:[e.jsx("option",{value:"",children:"Select Lease"}),d.map(m=>e.jsxs("option",{value:m.lease_id,children:[m.tenant," - ",m.lease_id]},m.lease_id))]})}),e.jsx("td",{className:"tf-borderRight",style:{paddingRight:"1px",paddingLeft:"1px",maxWidth:"60px"},children:e.jsx("input",{onChange:m=>a&&l({type:"updateReceiptNumber",payload:{lease_id:a.lease_id,receiptNumber:m.target.value}}),className:"form-control form-control-sm tf-borderRight tf-input",name:"receiptNumber",id:"receiptNumber",value:a==null?void 0:a.receiptNumber,style:{width:"100%",border:"1px solid #111"}})}),e.jsx("td",{className:"tf-borderRight",style:{paddingRight:"1px",paddingLeft:"1px"},children:e.jsx("input",{onChange:m=>a&&l({type:"updateDetails",payload:{lease_id:a.lease_id,receiptNumber:m.target.value}}),className:"form-control form-control-sm tf-borderRight tf-input",name:"details",id:"details",value:a==null?void 0:a.details,style:{width:"100%",border:"1px solid #111"}})}),e.jsx("td",{className:"tf-borderRight",style:{paddingRight:"1px",paddingLeft:"1px"},children:a==null?void 0:a.Currency}),e.jsx("td",{className:`tf-borderRight bg-${a==null?void 0:a.color} text-white text-end`,style:{paddingRight:"1px",paddingLeft:"1px"},children:K((g=a==null?void 0:a.rent_owing)!=null?g:0)}),e.jsx("td",{className:"tf-borderRight",style:{paddingRight:"1px",paddingLeft:"1px"},children:e.jsx("input",{onChange:m=>a&&l({type:"updatePaymentAmount",payload:{lease_id:a.lease_id,paymentAmount:Number(m.target.value)}}),className:"form-control form-control-sm tf-borderRight tf-input",name:"paymentAmount",id:"paymentAmount",value:(a==null?void 0:a.paymentAmount)===0?"":a==null?void 0:a.paymentAmount,style:{width:"100%",border:"1px solid #111"}})}),e.jsx("td",{className:"tf-borderRight text-end",style:{paddingRight:"1px",paddingLeft:"1px",borderBottom:"1px solid #e0e0e0"},children:a!=null&&a.balance_amount?K((a==null?void 0:a.balance_amount)-(a==null?void 0:a.paymentAmount)):""})]})}function Xe(d,l){const[a,t]=o.useState(d);return o.useEffect(()=>{const f=setTimeout(()=>{t(d)},l);return()=>{clearTimeout(f)}},[d,l]),a}const je=({show:d,handleClose:l,action:a,lesseeDetails:t,subscriptionPeriod:f,handleShowAlert:g})=>{const[m,u]=o.useState(!1),[c,s]=o.useState(""),[B,A]=o.useState(!1),[h,E]=o.useState({}),[L,k]=o.useState(!1),[n,Y]=o.useState(!0),{data:r,setData:p,post:x,reset:j}=ae({identificationNumber:(t==null?void 0:t.reg_ID_Number)||"",lesseeName:(t==null?void 0:t.name)||"",lesseeAddress:(t==null?void 0:t.address)||"",lesseePhone:(t==null?void 0:t.mobile)||"",leaseDetails:(t==null?void 0:t.lease_details)||"",leaseStartDate:(t==null?void 0:t.start_date)||"",leaseEndDate:(t==null?void 0:t.end_date)||"",leaseCurrency:(t==null?void 0:t.currency)||"USD",depositAmount:(t==null?void 0:t.deposit_amount)||0,leasePeriod:f||(t==null?void 0:t.lease_period),rentVariable:(t==null?void 0:t.rent_variable)||!1,depositPeriod:(t==null?void 0:t.deposit_period)||0,monthlyRental:(t==null?void 0:t.monthly_rentals)||0,paymentPeriodStart:(t==null?void 0:t.payment_period_start)||"25",paymentPeriodEnd:(t==null?void 0:t.payment_period_end)||"7",isCompany:!1,leaseId:(t==null?void 0:t.lease_id)||-1,monthOneBalance:"",monthTwoBalance:"",monthThreeBalance:"",moreThanThreeMonthsBalance:"",currentBalance:""}),w=()=>{Y(!0),k(!1)},O=()=>{k(!0),Y(!1)},P=M(),$=P.clone().add(r.paymentPeriodEnd>=P.date()?0:1,"months").date(r.paymentPeriodEnd).format("DD-MMM-YY"),V=P.clone().subtract(r.paymentPeriodEnd>=P.date()?1:0,"months").date(r.paymentPeriodEnd).format("DD-MMM-YY"),X=P.clone().subtract(r.paymentPeriodEnd>=P.date()?2:1,"months").date(r.paymentPeriodEnd).format("DD-MMM-YY"),z=P.clone().subtract(r.paymentPeriodEnd>=P.date()?3:2,"months").date(r.paymentPeriodEnd).format("DD-MMM-YY"),q=Xe(r.identificationNumber,500),W=o.useCallback(()=>{if(q&&q.length>=5)try{u(!0),re.post(reverseUrl("get-user"),r).then(N=>{var i,R,U,J,S,ne,se,_;(i=N.data)!=null&&i.props.name?(p(T(v({},r),{lesseeName:((R=N.data)==null?void 0:R.props.name)||"",lesseeAddress:((U=N.data)==null?void 0:U.props.address)||"",lesseePhone:((J=N.data)==null?void 0:J.props.phone)||""})),E((ne=(S=N.data)==null?void 0:S.props)==null?void 0:ne.openingBalances)):((r.identificationNumber.length===6||r.identificationNumber.length>7)&&b.error("User not found!",{duration:4e3,id:"error-toast",icon:"❌"}),s((_=(se=N.data)==null?void 0:se.props)==null?void 0:_.errors)),u(!1)}).catch(N=>{b.error("Something went wrong! Please try again"),s(N)}).finally(()=>{u(!1)})}catch(N){b.error("Something went wrong! Please try again"),s(N)}},[q]);o.useEffect(()=>{a==="add"&&W()},[a,W]),o.useEffect(()=>{if(r.leaseStartDate){const i=M(r.leaseStartDate);p(T(v({},r),{leaseEndDate:i}))}},[]);const C=N=>{N.target.id==="rentVariable"?p(T(v({},r),{[N.target.id]:N.target.checked})):N.target.id==="leasePeriod"?Number(N.target.value)>Number(f)?(b.error(`Lease period cannot be more than your subscription period (${f} months)`),p(T(v({},r),{[N.target.id]:f}))):p(T(v({},r),{[N.target.id]:N.target.value})):p(T(v({},r),{[N.target.id]:N.target.value}))},F=N=>Q(void 0,null,function*(){if(N.preventDefault(),r.lesseeName===""){b.error("Please enter a valid lessee");return}r.leaseEndDate=M(r.leaseStartDate).add(r.leasePeriod,"months").format("YYYY-MM-DD"),r.leaseStartDate=M(r.leaseStartDate).format("YYYY-MM-DD"),r.monthOneBalance=Number(r.monthOneBalance),r.monthTwoBalance=Number(r.monthTwoBalance),r.monthThreeBalance=Number(r.monthThreeBalance),r.moreThanThreeMonthsBalance=Number(r.moreThanThreeMonthsBalance),r.currentBalance=Number(r.currentBalance),r.monthOneDate=M(V).format("YYYY-MM-DD"),r.monthTwoDate=M(X).format("YYYY-MM-DD"),r.monthThreeDate=M(z).format("YYYY-MM-DD"),r.currentDate=M($).format("YYYY-MM-DD"),r.monthlyRental=Number(r.monthlyRental),r.depositAmount=r.depositAmount,r.depositPeriod=Number(r.depositPeriod),r.leasePeriod=Number(r.leasePeriod),r.outStandingBalance=r.moreThanThreeMonthsBalance+r.monthThreeBalance+r.monthTwoBalance+r.monthOneBalance+r.currentBalance,x(reverseUrl("create-individual-lease"),{onStart:()=>{u(!0)},onSuccess:i=>{var U,J,S;const R=(U=i==null?void 0:i.props)==null?void 0:U.flash.message;R&&((J=i==null?void 0:i.props)==null?void 0:J.flash.type)==="success"?(l(),g(R,r.lesseeName)):R&&((S=i==null?void 0:i.props)==null?void 0:S.flash.type)==="error"&&b.error(R.message),j(),u(!1)},onError:i=>{b.error(N.message||"Something went wrong! Please try again"),s(N),u(!1)}})}),Z=N=>{N.preventDefault(),r.leaseStartDate=M(r.leaseStartDate).format("YYYY-MM-DD"),r.leaseEndDate=M(r.leaseStartDate).add(r.leasePeriod,"months").format("YYYY-MM-DD"),x(reverseUrl("client-edit-lease"),{onStart:()=>{u(!0)},onSuccess:i=>{var R,U;((R=i==null?void 0:i.props)==null?void 0:R.flash.type)==="success"?(l(),g("Lease updated successfully")):((U=i==null?void 0:i.props)==null?void 0:U.flash.type)==="error"&&b.error("An error occurred, please try again later"),u(!1)},onError:i=>{b.error("Something went wrong! Please try again"),s(i),u(!1)}})};return e.jsx(e.Fragment,{children:e.jsx(I,{size:"lg",show:d,onHide:l,children:e.jsxs("div",{children:[e.jsx(I.Header,{closeButton:!0,className:"card-header bg-transparent",style:{paddingLeft:"0px"},children:e.jsxs("div",{className:"",children:[e.jsx("button",{className:`btn  btn-sm ${n?"btn-info text-white":"btn-light"}`,onClick:w,children:"Single"}),e.jsx("button",{className:`btn  btn-sm ${L?"btn-info text-white":"btn-light"}`,onClick:O,children:"Multiple"})]})}),n?e.jsxs("div",{className:"card card-raised",children:[e.jsx("div",{className:"card-header bg-info",children:e.jsxs("div",{className:`d-flex justify-content-between
                      align-items-center`,children:[e.jsxs("div",{className:"me-4",children:[e.jsx("h2",{className:"display-6 mb-0 text-white",children:a==="view"?"View Lease - Individual":a==="edit"?"Edit Lease - Individual":"Add Lease - Individual"}),e.jsx("div",{className:"card-text"})]}),e.jsx("div",{className:"d-flex gap-2"})]})}),e.jsx("div",{className:"card-body p-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-info px-4",style:{paddingTop:"2px",paddingBottom:"2px"},children:e.jsx("div",{className:`d-flex justify-content-center
                            align-items-center`,children:e.jsxs("div",{className:"me-4",children:[e.jsx("h6",{className:"display-6 mb-0 text-white",children:"Lease details"}),e.jsx("div",{className:"card-text"})]})})}),e.jsx("div",{className:"card-body p-4",style:{borderStyle:"solid",borderColor:"#26a69a"},children:e.jsx(I.Body,{children:e.jsxs("form",{onSubmit:a==="add"?F:a==="edit"?Z:()=>{},children:[e.jsxs("div",{className:"row mb-4",children:[e.jsx(de,{}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"National ID:"}),e.jsx("input",{value:r.identificationNumber,onChange:C,type:"text",required:!0,name:"identificationNumber",id:"identificationNumber",className:"form-control form-control-sm"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.identificationNumber})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lessee Name:"}),e.jsx("input",{value:r.lesseeName,onChange:C,type:"text",name:"lesseeName",required:!0,id:"lesseeName",className:"form-control form-control-sm",readOnly:!0}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.lesseeName})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lessee Mobile Number"}),e.jsx("input",{value:r.lesseePhone,onChange:C,type:"text",name:"lesseePhone",id:"lesseePhone",required:!0,className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.lesseePhone})]})]})]}),e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Address:"}),e.jsx("textarea",{value:r.lesseeAddress,onChange:C,type:"text",required:!!r.lesseeName,name:"lesseeAddress",id:"lesseeAddress",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.lesseeAddress})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Details:"}),e.jsx("textarea",{value:r.leaseDetails,onChange:C,name:"leaseDetails",id:"leaseDetails",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leaseDetails})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Currency"}),e.jsxs("select",{value:r.leaseCurrency,onChange:C,id:"leaseCurrency",name:"leaseCurrency",className:"form-select form-select-sm",readOnly:a==="view",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"ZWG",children:"ZWG"})]}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leaseCurrency})]})]})}),e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Monthly Rental:"}),e.jsx("input",{value:r.monthlyRental===0?"":r.monthlyRental,placeholder:"enter monthly rental",onChange:C,type:"text",required:!!r.lesseeName,id:"monthlyRental",name:"monthlyRental",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.monthlyRental})]}),e.jsxs("div",{className:"mt-1 col-lg-4 d-flex flex-column",children:[e.jsx("label",{className:"form-label",children:"Variable Rent:"}),e.jsx("input",{checked:r.rentVariable,onChange:C,type:"checkbox",id:"rentVariable",name:"rentVariable",className:"form-check-input border-1 p-2 border-black"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.rentVariable})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Period(Months):"}),e.jsx("input",{value:r.depositPeriod===0?"":r.depositPeriod,placeholder:"enter deposit period",onChange:C,type:"text",id:"depositPeriod",name:"depositPeriod",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.depositPeriod})]})]})}),e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Amount:"}),e.jsx("input",{value:r.depositAmount===0?"":r.depositAmount,placeholder:"enter deposit amount",onChange:C,type:"text",name:"depositAmount",id:"depositAmount",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.depositAmount})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Subs Months Remaining:"}),e.jsx("input",{value:r.leasePeriod,onChange:C,type:"number",id:"leasePeriod",name:"leasePeriod",className:"form-control form-control-sm"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leasePeriod})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Start Date:"}),e.jsx("input",{value:r.leaseStartDate,onChange:C,type:"date",required:!!r.lesseeName,name:"leaseStartDate",id:"leaseStartDate",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leaseStartDate})]})]})}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease End Date:"}),e.jsx("span",{className:"form-control form-control-sm",children:r.leaseStartDate?M(r.leaseStartDate).add(r.leasePeriod,"months").subtract(1,"days").format("DD / MM / YYYY"):""}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.leaseEndDate})]}),e.jsxs("div",{className:"col-lg-4 mt-1",children:[e.jsx("label",{className:"form-label",children:"Payment Period Start Date:"}),e.jsx("input",{value:r.paymentPeriodStart,type:"number",id:"paymentPeriodStart",name:"paymentPeriodStart",className:"form-control form-control-sm",readOnly:!0,disabled:!0}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.paymentPeriodStart})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Payment Period End Date:"}),e.jsx("input",{value:r.paymentPeriodEnd,onChange:C,type:"number",min:"1",max:"31",required:!!r.lesseeName,name:"paymentPeriodEnd",id:"paymentPeriodEnd",className:"form-control form-control-sm",readOnly:a==="view"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.paymentPeriodEnd})]})]}),a==="add"&&e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"table-responsive table-bordered",children:[e.jsx("h3",{className:"text-center p-2 fw-bolder h6",style:{backgroundColor:"#a0a0af"},children:"Opening Rent Balances"}),e.jsx("table",{className:"table table-bordered",children:e.jsxs("tbody",{children:[e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",style:{lineHeight:"15px"},children:"Payment Date"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:"More than 3 months"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:z}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:X}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:V}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:$}),e.jsx("td",{className:"fw-bold",style:{lineHeight:"15px"},children:"Outstanding Balance"})]}),e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",children:"Amount"}),e.jsx("td",{className:"bg-black text-white",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"moreThanThreeMonthsBalance",name:"moreThanThreeMonthsBalance",onChange:C,value:r.moreThanThreeMonthsBalance})}),e.jsx("td",{className:"text-white bg-danger",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthThreeBalance",name:"monthThreeBalance",onChange:C,value:r.monthThreeBalance})}),e.jsx("td",{className:"text-white",style:{backgroundColor:"#f87171"},children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthTwoBalance",name:"monthTwoBalance",onChange:C,value:r.monthTwoBalance})}),e.jsx("td",{className:"text-white bg-warning",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthOneBalance",name:"monthOneBalance",onChange:C,value:r.monthOneBalance})}),e.jsx("td",{className:"text-white bg-success",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"currentBalance",name:"currentBalance",onChange:C,value:r.currentBalance})}),e.jsx("td",{className:`text-white d-flex align-items-center justify-content-center py-4 my-auto ${Number(r.moreThanThreeMonthsBalance)>0?"bg-black":Number(r.monthThreeBalance)>0?"bg-danger":Number(r.monthTwoBalance)>0?"bg-transperant":Number(r.monthOneBalance)>0?"bg-warning":"bg-success"}`,style:{backgroundColor:Number(r.monthTwoBalance)>0?"#f87171":""},children:K(Number(r.moreThanThreeMonthsBalance)+Number(r.monthThreeBalance)+Number(r.monthTwoBalance)+Number(r.monthOneBalance)+Number(r.currentBalance)||0)})]})]})})]})}),e.jsx("div",{className:"w-100 mt-4 d-flex justify-content-end gap-3",children:a==="view"?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"text-white",variant:"info",onClick:()=>{A(!0)},children:"Receipt"}),e.jsx(H,{className:"text-white",variant:"success",onClick:()=>{l()},children:"Edit"}),e.jsx(H,{className:"text-white",variant:"danger",onClick:()=>{l()},children:"Terminate"})]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{variant:"secondary",onClick:l,children:"Cancel"}),e.jsx(H,{className:"text-white",variant:"info",type:"submit",disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ml-2",children:"processing.."})]}):"Submit"})," "]})})]})})}),B&&e.jsx(he,{show:B,handleClose:()=>{A(!1)}})]})})]}):e.jsx(ye,{type:"individual",actionType:"lease"})]})})})},be=({show:d,handleClose:l,action:a,lesseeDetails:t,subscriptionPeriod:f,handleShowAlert:g})=>{const[m,u]=o.useState(!1),[c,s]=o.useState(!1),[B,A]=o.useState(!0),[h,E]=o.useState(""),[L,k]=o.useState(!1),{data:n,setData:Y,post:r,reset:p}=ae({identificationNumber:(t==null?void 0:t.reg_ID_Number)||"",lesseeName:(t==null?void 0:t.name)||"",lesseeAddress:(t==null?void 0:t.address)||"",mobile:(t==null?void 0:t.mobile)||"",email:(t==null?void 0:t.email)||"",rentGuarantorId:(t==null?void 0:t.rent_guarantor_id)||"",rentGuarantorIdType:(t==null?void 0:t.rent_guarantor_id_type)||"",rentGuarantorName:(t==null?void 0:t.rent_guarantor_name)||"",leaseDetails:(t==null?void 0:t.lease_details)||"",leaseStartDate:(t==null?void 0:t.start_date)||"",rentVariable:(t==null?void 0:t.rent_variable)||!1,leaseEndDate:(t==null?void 0:t.end_date)||"",leaseCurrency:(t==null?void 0:t.currency)||"USD",depositAmount:(t==null?void 0:t.deposit_amount)||0,leasePeriod:f||(t==null?void 0:t.lease_period),depositPeriod:(t==null?void 0:t.deposit_period)||0,monthlyRental:(t==null?void 0:t.monthly_rentals)||0,paymentPeriodStart:(t==null?void 0:t.payment_period_start)||"25",paymentPeriodEnd:(t==null?void 0:t.payment_period_end)||"7",isCompany:!0,leaseId:(t==null?void 0:t.lease_id)||-1,monthOneBalance:"",monthTwoBalance:"",monthThreeBalance:"",moreThanThreeMonthsBalance:"",currentBalance:""}),[x,j]=o.useState(a==="edit"?n.lesseeName:""),[w,O]=o.useState(n.lesseeName),[P,$]=o.useState(n.email),[V,X]=o.useState(n.identificationNumber),[z,q]=o.useState(n.mobile),[W,C]=o.useState(n.lesseeAddress),F=M(),Z=F.clone().add(n.paymentPeriodEnd>=F.date()?0:1,"months").date(n.paymentPeriodEnd).format("DD-MMM-YY"),N=F.clone().subtract(n.paymentPeriodEnd>=F.date()?1:0,"months").date(n.paymentPeriodEnd).format("DD-MMM-YY"),i=F.clone().subtract(n.paymentPeriodEnd>=F.date()?2:1,"months").date(n.paymentPeriodEnd).format("DD-MMM-YY"),R=F.clone().subtract(n.paymentPeriodEnd>=F.date()?3:2,"months").date(n.paymentPeriodEnd).format("DD-MMM-YY");o.useEffect(()=>{Y(T(v({},n),{lesseeName:w,email:P,identificationNumber:String(V),mobile:z,lesseeAddress:W}))},[V,w,P,z,W]),o.useEffect(()=>{a==="add"&&(()=>{if(n.rentGuarantorId&&/^[\d]{8,9}[A-Za-z]{1}[\d]{2}$/.test(n.rentGuarantorId))try{u(!0),re.post(reverseUrl("get-user"),{identificationNumber:n.rentGuarantorId}).then(y=>{var G,D,ee,te,ue;(G=y.data)!=null&&G.props.name?Y(T(v({},n),{rentGuarantorName:((D=y.data)==null?void 0:D.props.name)||"",rentGuarantorIdType:((ee=y.data)==null?void 0:ee.props.identification_type)||""})):(b.error("User not found!",{duration:4e3,icon:"❌"}),E((ue=(te=y.data)==null?void 0:te.props)==null?void 0:ue.errors)),u(!1)}).catch(y=>{b.error("Something went wrong! Please try again"),E(y)}).finally(()=>{u(!1)})}catch(y){b.error("Something went wrong! Please try again"),E(y)}})()},[n.rentGuarantorId]);const U=()=>{A(!0),s(!1)},J=()=>{s(!0),A(!1)},S=_=>{_.target.id==="rentVariable"?Y(T(v({},n),{[_.target.id]:_.target.checked})):_.target.id==="leasePeriod"?Number(_.target.value)>Number(f)?(b.error(`Lease period cannot be more than your subscription period (${f} months)`),Y(T(v({},n),{[_.target.id]:f}))):Y(T(v({},n),{[_.target.id]:_.target.value})):Y(T(v({},n),{[_.target.id]:_.target.value}))},ne=_=>Q(void 0,null,function*(){if(_.preventDefault(),!n.lesseeName){b.error("Please add a valid lessee");return}u(!0),n.leaseEndDate=M(n.leaseStartDate).add(n.leasePeriod,"months").format("YYYY-MM-DD"),n.monthOneBalance=Number(n.monthOneBalance),n.monthTwoBalance=Number(n.monthTwoBalance),n.monthThreeBalance=Number(n.monthThreeBalance),n.moreThanThreeMonthsBalance=Number(n.moreThanThreeMonthsBalance),n.currentBalance=Number(n.currentBalance),n.monthOneDate=M(N).format("YYYY-MM-DD"),n.monthTwoDate=M(i).format("YYYY-MM-DD"),n.monthThreeDate=M(R).format("YYYY-MM-DD"),n.currentDate=M(Z).format("YYYY-MM-DD"),n.monthlyRental=Number(n.monthlyRental),n.depositAmount=n.depositAmount,n.depositPeriod=Number(n.depositPeriod),n.leasePeriod=Number(n.leasePeriod),n.outStandingBalance=n.moreThanThreeMonthsBalance+n.monthThreeBalance+n.monthTwoBalance+n.monthOneBalance+n.currentBalance,r(reverseUrl("create-company-lease"),{onStart:()=>{u(!0)},onSuccess:y=>{var D,ee,te;const G=(D=y==null?void 0:y.props)==null?void 0:D.flash.message;G&&((ee=y==null?void 0:y.props)==null?void 0:ee.flash.type)==="success"?(l(),p(),g(G,n.lesseeName)):G&&((te=y==null?void 0:y.props)==null?void 0:te.flash.type)==="error"&&b.error(G.message),u(!1)},onError:y=>{b.error(_.message||"Something went wrong! Please try again"),E(_),u(!1)}})}),se=_=>{_.preventDefault(),n.leaseStartDate=M(n.leaseStartDate).format("YYYY-MM-DD"),r(reverseUrl("client-edit-lease"),{onStart:()=>{u(!0)},onSuccess:y=>{var G,D;((G=y==null?void 0:y.props)==null?void 0:G.flash.type)==="success"?(l(),g("Lease updated successfully")):((D=y==null?void 0:y.props)==null?void 0:D.flash.type)==="error"&&b.error("An error occurred, please try again"),u(!1)},onError:y=>{b.error("Something went wrong! Please try again"),E(y),u(!1)}})};return e.jsx(e.Fragment,{children:e.jsx(I,{size:"lg",show:d,onHide:l,children:e.jsxs("div",{children:[e.jsx(I.Header,{closeButton:!0,className:"card-header bg-transparent",style:{paddingLeft:"0px"},children:e.jsxs("div",{className:"",children:[e.jsx("button",{className:`btn  btn-sm ${B?"btn-info text-white":"btn-light"}`,onClick:U,children:"Single"}),e.jsx("button",{className:`btn  btn-sm ${c?"btn-info text-white":"btn-light"}`,onClick:J,children:"Multiple"})]})}),B?e.jsxs("div",{className:"card card-raised",children:[e.jsx("div",{className:"card-header bg-info",children:e.jsxs("div",{className:`d-flex justify-content-between
                      align-items-center`,children:[e.jsxs("div",{className:"me-4",children:[e.jsx("h2",{className:"display-6 mb-0 text-white",children:a==="view"?"View Lease - Company":a==="edit"?"Edit Lease - Company":"Add Lease - Company"}),e.jsx("div",{className:"card-text"})]}),e.jsx("div",{className:"d-flex gap-2"})]})}),e.jsx("div",{className:"card-body p-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-info px-4",style:{paddingTop:"2px",paddingBottom:"2px"},children:e.jsx("div",{className:`d-flex justify-content-center
                            align-items-center`,children:e.jsxs("div",{className:"me-4",children:[e.jsx("h6",{className:"display-6 mb-0 text-white",children:"Lease details"}),e.jsx("div",{className:"card-text"})]})})}),e.jsx("div",{className:"card-body p-4",style:{borderStyle:"solid",borderColor:"#26a69a"},children:e.jsx(I.Body,{children:e.jsxs("form",{onSubmit:a==="add"?ne:a==="edit"?se:()=>{},children:[e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsx(de,{}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Company Trading Name:"}),e.jsx(Le,{from:"leases",delay:500,placeholder:"Company Name",value:x,setValue:j,url:reverseUrl("get_searched_companies"),type:"company",setAddress:C,setClientName:O,setRegNumber:$,setClientId:X,setMobileNo:q}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.identificationNumber})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lessee Name:"}),e.jsx("input",{value:n.lesseeName,onChange:S,type:"text",name:"lesseeName",readOnly:!0,required:!0,id:"lesseeName",className:"form-control form-control-sm"}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.lesseeName})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Email:"}),e.jsx("input",{value:n.email,onChange:S,type:"text",name:"email",required:!0,id:"email",className:"form-control form-control-sm",readOnly:a==="view"}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.email})]})]})}),e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Mobile:"}),e.jsx("input",{value:n.mobile,onChange:S,type:"text",name:"mobile",required:!0,id:"mobile",className:"form-control form-control-sm",readOnly:a==="view"}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.mobile})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Rent Guarantor ID:"}),e.jsx("input",{value:n.rentGuarantorId,onChange:S,type:"text",name:"rentGuarantorId",id:"rentGuarantorId",className:"form-control form-control-sm",readOnly:a==="view"}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.rentGuarantorId})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Rent Guarantor Name:"}),e.jsx("input",{value:n.rentGuarantorName,onChange:S,type:"text",name:"rentGuarantorName",id:"rentGuarantorName",className:"form-control form-control-sm",readOnly:!0}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.rentGuarantorName})]})]})}),e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Address:"}),e.jsx("textarea",{value:n.lesseeAddress,onChange:S,type:"text",required:!!n.lesseeName,name:"lesseeAddress",id:"lesseeAddress",className:"form-control form-control-sm",readOnly:a==="view"}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.lesseeAddress})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Details:"}),e.jsx("textarea",{value:n.leaseDetails,onChange:S,type:"text",name:"leaseDetails",id:"leaseDetails",className:"form-control form-control-sm",readOnly:a==="view"}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.leaseDetails})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Currency"}),e.jsxs("select",{value:n.leaseCurrency,onChange:S,id:"leaseCurrency",name:"leaseCurrency",className:"form-select form-select-sm",readOnly:a==="view",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"ZWG",children:"ZWG"})]}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.leaseCurrency})]})]})}),e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Monthly Rental:"}),e.jsx("input",{value:n.monthlyRental===0?"":n.monthlyRental,placeholder:"enter monthly rental",onChange:S,type:"text",required:!!n.lesseeName,id:"monthlyRental",name:"monthlyRental",className:"form-control form-control-sm",readOnly:a==="view"}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.monthlyRental})]}),e.jsxs("div",{className:"mt-1 col-lg-4 d-flex flex-column",children:[e.jsx("label",{className:"form-label",children:"Variable Rent:"}),e.jsx("input",{checked:n.rentVariable,onChange:S,type:"checkbox",id:"rentVariable",name:"rentVariable",className:"form-check-input border-1 p-2 border-black",readOnly:a==="view"}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.rentVariable})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Period(Months):"}),e.jsx("input",{value:n.depositPeriod===0?"":n.depositPeriod,placeholder:"enter deposit period",onChange:S,type:"text",id:"depositPeriod",name:"depositPeriod",className:"form-control form-control-sm",readOnly:a==="view"}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.depositPeriod})]})]})}),e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Deposit Amount:"}),e.jsx("input",{value:n.depositAmount===0?"":n.depositAmount,placeholder:"enter deposit amount",onChange:S,type:"text",name:"depositAmount",id:"depositAmount",className:"form-control form-control-sm",readOnly:a==="view"}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.depositAmount})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Subs Months Remaining:"}),e.jsx("input",{value:n.leasePeriod,onChange:S,type:"number",id:"leasePeriod",name:"leasePeriod",className:"form-control form-control-sm"}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.leasePeriod})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease Start Date:"}),e.jsx("input",{value:n.leaseStartDate,onChange:S,type:"date",name:"leaseStartDate",required:!!n.lesseeName,id:"leaseStartDate",className:"form-control form-control-sm",readOnly:a==="view"}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.leaseStartDate})]})]})}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Lease End Date:"}),e.jsx("span",{className:"form-control form-control-sm",children:n.leaseStartDate?M(n.leaseStartDate).add(n.leasePeriod,"months").subtract(1,"days").format("DD / MM / YYYY"):""}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.leaseEndDate})]}),e.jsxs("div",{className:"col-lg-4 mt-1",children:[e.jsx("label",{className:"form-label",children:"Payment Period Start Date:"}),e.jsx("input",{value:n.paymentPeriodStart,onChange:S,type:"number",id:"paymentPeriodStart",name:"paymentPeriodStart",className:"form-control form-control-sm",readOnly:!0,disabled:!0}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.paymentPeriodStart})]}),e.jsxs("div",{className:"mt-1 col-lg-4",children:[e.jsx("label",{className:"form-label",children:"Payment Period End Date:"}),e.jsx("input",{value:n.paymentPeriodEnd,onChange:S,min:"1",max:"31",type:"number",required:!!n.lesseeName,name:"paymentPeriodEnd",id:"paymentPeriodEnd",className:"form-control form-control-sm",readOnly:a==="view"}),h&&e.jsx("div",{className:"text-danger mt-1",children:h.paymentPeriodEnd})]})]}),a==="add"&&e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"table-responsive table-bordered",children:[e.jsx("h3",{className:"text-center p-2 fw-bolder h6",style:{backgroundColor:"#a0a0af"},children:"Opening Rent Balances"}),e.jsx("table",{className:"table table-bordered",children:e.jsxs("tbody",{children:[e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",style:{lineHeight:"15px"},children:"Payment Date"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:"More than 3 months"}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:R}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:i}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:N}),e.jsx("td",{className:"",style:{lineHeight:"15px"},children:Z}),e.jsx("td",{className:"fw-bold",style:{lineHeight:"15px"},children:"Outstanding Balance"})]}),e.jsxs("tr",{style:{lineHeight:"5px",fontSize:"12px"},children:[e.jsx("th",{scope:"row",className:"fw-bold",children:"Amount"}),e.jsx("td",{className:"bg-black text-white",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"moreThanThreeMonthsBalance",name:"moreThanThreeMonthsBalance",onChange:S,value:n.moreThanThreeMonthsBalance})}),e.jsx("td",{className:"text-white bg-danger",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthThreeBalance",name:"monthThreeBalance",onChange:S,value:n.monthThreeBalance})}),e.jsx("td",{className:"text-white",style:{backgroundColor:"#f87171"},children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthTwoBalance",name:"monthTwoBalance",onChange:S,value:n.monthTwoBalance})}),e.jsx("td",{className:"text-white bg-warning",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"monthOneBalance",name:"monthOneBalance",onChange:S,value:n.monthOneBalance})}),e.jsx("td",{className:"text-white bg-success",children:e.jsx("input",{className:"form-control form-control-sm",type:"text",id:"currentBalance",name:"currentBalance",onChange:S,value:n.currentBalance})}),e.jsx("td",{className:`text-white text-end h-100 d-flex align-items-center justify-content-center py-4 my-auto ${Number(n.moreThanThreeMonthsBalance)>0?"bg-black":Number(n.monthThreeBalance)>0?"bg-danger":Number(n.monthTwoBalance)>0?"bg-transperant":Number(n.monthOneBalance)>0?"bg-warning":"bg-success"}`,style:{backgroundColor:Number(n.monthTwoBalance)>0?"#f87171":""},children:K(Number(n.moreThanThreeMonthsBalance)+Number(n.monthThreeBalance)+Number(n.monthTwoBalance)+Number(n.monthOneBalance)+Number(n.currentBalance)||0)})]})]})})]})}),e.jsx("div",{className:"w-100 d-flex justify-content-end gap-3",children:a==="view"?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"text-white",variant:"info",onClick:()=>{k(!0)},children:"Receipt"}),e.jsx(H,{className:"text-white",variant:"success",onClick:()=>{l()},children:"Edit"}),e.jsx(H,{className:"text-white",variant:"danger",onClick:()=>{l()},children:"Terminate"})]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{variant:"secondary",onClick:l,children:"Cancel"}),e.jsx(H,{className:"text-white",variant:"info",type:"submit",disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ml-2",children:"processing.."})]}):"Submit"})," "]})})]})})}),L&&e.jsx(he,{show:L,handleClose:()=>{k(!1)}})]})})]}):e.jsx(ye,{type:"company",actionType:"lease"})]})})})},Je=({show:d,handleClose:l,handleShowAlert:a,leaseData:t})=>{const[f,g]=o.useState(!1),{data:m,post:u}=ae({leaseId:t.lease_id}),c=()=>{u(reverseUrl("delete_lease"),{onStart:()=>{g(!0)},onSuccess:s=>{a("Lease terminated successfully"),g(!1)},onError:s=>{b.error("Something went wrong! Please try again"),g(!1)},onFinish:()=>{l()}})};return e.jsx("div",{className:"container-xl p-5",children:e.jsx("div",{className:"card card-raised",children:e.jsx("div",{className:"card-body p-4",children:e.jsxs(I,{show:d,onHide:l,size:"md",backdrop:"static",centered:!0,children:[e.jsx(I.Header,{closeButton:!0,className:"h4 bg-info text-white text-center text-uppercase",children:"Confirm Lease Termination"}),e.jsxs(I.Body,{className:"p-4 d-flex justify-content-between align-items-center gap-4",children:[e.jsx(de,{}),e.jsxs("p",{className:"my-3 text-center",children:["Are you sure you want to terninate lease for ",t.name,"? This action cannot be undone."]})]}),e.jsxs(I.Footer,{className:"p-4 d-flex justify-content-end gap-4",children:[e.jsxs(H,{onClick:l,variant:"secondary",children:[e.jsx("i",{className:"material-icons",children:"cancel"}),"Cancel"]}),e.jsxs(H,{onClick:c,variant:"danger",children:[e.jsx("i",{className:"material-icons",children:"done"}),"Delete"]})]})]})})})})},Ke=({show:d,handleClose:l,url:a,setVerified:t,verification_type:f,setCreditInfo:g})=>{const[m,u]=o.useState(!1),[c,s]=o.useState({}),{data:B,setData:A,post:h,reset:E}=ae({otp:"",verification_type:f}),[L,k]=o.useState(!1),[n,Y]=o.useState(30);o.useEffect(()=>{const w=setInterval(()=>{Y(O=>O<=1?(clearInterval(w),k(!0),0):O-1)},1e3);return()=>clearInterval(w)},[]);const r=()=>Q(void 0,null,function*(){k(!1);try{(yield re.get(reverseUrl("new_otp"))).data.status==="success"?b.success("OTP sent successfully"):b.error("Something went wrong! Please try again")}catch(w){b.error("Something went wrong! Please try again")}}),p=w=>A(T(v({},B),{[w.target.id]:w.target.value})),x=()=>B.otp.length!==4?(s({otp:"otp must be four digits"}),!1):parseInt(B.otp,10)?!0:(s({otp:"otp must be a number"}),!1),j=w=>{console.log("indi"),w.preventDefault(),x()&&(h(reverseUrl(a),{onStart:()=>{u(!0)},onSuccess:O=>{l(),E(),b.success("Verification successful"),u(!1),typeof t=="function"&&t(!0)},onError:O=>{b.error("Something went wrong! Please try again"),s(O),console.log(erros),u(!1)}}),u(!1))};return e.jsx(e.Fragment,{children:e.jsx(I,{size:"lg",show:d,onHide:l,centered:!0,children:e.jsx("div",{children:e.jsxs("div",{className:"card card-raised",children:[e.jsx("div",{className:"card-header bg-info px-4",children:e.jsxs("div",{className:`d-flex justify-content-between
                                align-items-center`,children:[e.jsxs("div",{className:"me-4",children:[e.jsx("h2",{className:"display-6 mb-0 text-white",children:"Verify OTP"}),e.jsx("div",{className:"card-text"})]}),e.jsx("div",{className:"d-flex gap-2"})]})}),e.jsx("div",{className:"card-body p-4",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body p-4",style:{borderStyle:"solid",borderColor:"#26a69a"},children:[e.jsx(I.Body,{children:e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"col-md-12",children:[e.jsx("div",{children:e.jsx("p",{children:f==="individual"?"Enter the 4-digit code we sent to user's mobile number. This code will expire after 5 minutes":"Enter the 4-digit code we sent to user's email. This code will expire after 5 minutes"})}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Verification Code"}),e.jsx("input",{value:B.otp,onChange:p,type:"text",name:"otp",id:"otp",placeholder:"Enter your 4 digit otp",className:"form-control form-control-sm"}),c&&e.jsx("div",{className:"text-danger mt-1",children:c.otp})]})})]}),e.jsxs("div",{className:"mt-5 d-flex gap-4 align-items-center ",children:[e.jsxs("p",{children:["Didn't receive code?",e.jsx("button",{onClick:r,className:"ms-2 text-decoration-underline border-0 bg-transparent text-info",disabled:L===!1,children:"Resend Code"})]}),n>0&&e.jsx("p",{className:"text-success",children:`Resend code in ${n} seconds`})]})]})}),e.jsx(I.Footer,{children:e.jsx(H,{className:"text-white",variant:"info",onClick:w=>j(w),disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ml-2",children:"processing.."})]}):"Verify"})})]})})})]})})})})},Qe=({leases:d})=>{const[l,a]=o.useState(!1),[t,f]=o.useState(!1),[g,m]=o.useState({}),[u,c]=o.useState([]),[s,B]=o.useState({}),[A,h]=o.useState(!1),[E,L]=o.useState(!1),[k,n]=o.useState(0),[Y,r]=o.useState(!1),[p,x]=o.useState(!1),[j,w]=o.useState(""),[O,P]=o.useState(!1),[$,V]=o.useState(!1),[X,z]=o.useState(""),[q,W]=o.useState(""),C=(i,R)=>{V(!0),W(R),z(i)},F=()=>{V(!1),W(""),z("")};o.useEffect(()=>{re.post(reverseUrl("open_subscription")).then(i=>{c(i.data)}).catch(i=>{})},[c]);const Z=document.getElementById("hide-footer");o.useEffect(()=>(Z!==null&&document.getElementById("footer").classList.add("d-none"),()=>{Z!==null&&document.getElementById("footer").classList.remove("d-none")}),[Z]);const N=Me().props.error;return N&&b.error(N),e.jsxs("main",{className:"position-relative",id:"hide-footer",style:{height:"100%"},children:[X&&e.jsxs(Ne,{onClose:F,show:$,delay:1e4,className:"w-100 shadow-none ",style:{background:"#dcfce7"},autohide:!0,children:[e.jsxs(Ne.Header,{className:"text-uppercase w-100",children:[e.jsx("strong",{className:"me-auto",children:q?`Following message has been sent to ${q}`:""}),e.jsx("small",{className:"text-muted text-capitalize ms-auto",children:"just now"})]}),e.jsx("p",{className:"p-4",children:X})]}),e.jsx("div",{className:"container-xl",children:e.jsxs("div",{className:"card card-raised mb-5",children:[e.jsx("div",{className:"card-header px-4",style:{height:"50px",backgroundColor:"#32a4a8"},children:e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx("div",{className:"",children:e.jsx("h2",{className:"display-6 tf-color",children:"Lease Management"})})})}),e.jsxs("div",{className:"card-body p-4 position-relative ",children:[e.jsx("div",{className:"",style:{backgroundColor:"#428f38"},children:e.jsx("h5",{className:"text-center tf-color",children:"Active Lease"})}),e.jsx("div",{className:"table-responsive tableFixHead",children:e.jsxs("table",{className:"table-responsive table table-bordered",children:[e.jsx("thead",{className:"bg-white",children:e.jsxs("tr",{style:{borderTop:"0px"},children:[e.jsx("th",{scope:"col",style:{width:"100px"},children:"No."}),e.jsx("th",{scope:"col",style:{},children:"Tenant"}),e.jsx("th",{scope:"col",style:{},children:"Customer Number"}),e.jsx("th",{scope:"col",className:"text-end",children:"Rent Owing"}),e.jsx("th",{scope:"col",colSpan:3,className:"tf-borderRight",children:e.jsx("span",{style:{visibility:"hidden"},children:"Actions to be done"})})]})}),e.jsx("tbody",{children:d==null?void 0:d.map((i,R)=>e.jsxs("tr",{className:"w-100 py-2",children:[e.jsx("th",{scope:"row",children:R+1}),e.jsx("td",{children:i.name}),e.jsx("td",{children:i.mobile_number}),e.jsxs("td",{className:`bg-${i.color} text-white text-end`,style:{backgroundColor:i.color=="light-red"?"#f87171":""},children:[i.currency,K(i.owing_amount)]}),e.jsx("td",{className:"bg-info text-white text-center tfRow",onClick:()=>{L(!0),m(i)},children:"Receipt"}),e.jsx("td",{className:"bg-primary text-white text-center tfRow",onClick:()=>{f(!0),a(!1),m(i),B({type:i.is_company?"company":"individual"})},children:"Adjust"}),e.jsx("td",{className:"bg-danger text-white text-center tfRow",onClick:()=>{h(!0),m(i)},children:"Terminate"})]},"lease"+R))})]})}),(s==null?void 0:s.type)==="individual"&&l&&e.jsx(je,{action:"add",show:l,handleClose:()=>{a(!1),m({})},setShowVerify:r,lesseeDetails:g,subscriptionPeriod:k,handleShowAlert:C}),(s==null?void 0:s.type)==="individual"&&t&&e.jsx(je,{action:"edit",show:t,handleClose:()=>{f(!1),m({})},handleShowAlert:C,lesseeDetails:g,subscriptionPeriod:g.lease_period}),(s==null?void 0:s.type)==="company"&&l&&e.jsx(be,{action:"add",show:l,handleClose:()=>{a(!1),m({})},lesseeDetails:g,subscriptionPeriod:k,handleShowAlert:C}),(s==null?void 0:s.type)==="company"&&t&&e.jsx(be,{action:"edit",show:t,handleClose:()=>{f(!1),m({})},handleShowAlert:C,lesseeDetails:g,subscriptionPeriod:g.lease_period}),A&&e.jsx(Je,{show:A,handleClose:()=>{h(!1),m({})},handleShowAlert:C,leaseData:g}),E&&e.jsx(he,{show:E,handleClose:i=>Q(void 0,null,function*(){z(i),L(!1),V(!0),m({})}),leaseDetails:g}),Y&&e.jsx(Ke,{show:Y,handleClose:()=>{r(!1)},url:"client-individual-verify-otp",setVerified:x,verification_type:j})]})]})}),e.jsx("div",{className:"w-100 ",style:{backgroundColor:"#e3d329",position:"fixed",bottom:"0",right:"0",width:"100%"},children:e.jsx(He,{isVisible:O,setIsVisible:P,trigger:e.jsxs("div",{style:{backgroundColor:"#e3d329"},className:"position-relative tf-color",children:[e.jsx("h5",{className:"text-center tf-color py-2",children:"Open Subscriptions"}),e.jsx("i",{className:"icon material-icons position-absolute top-50 translate-middle",style:{right:"35%",fontSize:"50px",transform:"translateY(-50%)"},children:"keyboard_arrow_up"})]}),children:e.jsx(Ve,{title:"Open Subscriptions",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-bordered",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderTop:"0px"},children:[e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"No."}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Type"}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Open Slots"}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Period (months)"}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"Start Date"}),e.jsx("th",{scope:"col",style:{borderTop:"1px solid #e0e0e0"},children:"End Date"}),e.jsx("th",{scope:"col",colSpan:"2",className:"tf-borderRight"})]})}),e.jsx("tbody",{children:u==null?void 0:u.map((i,R)=>e.jsx(e.Fragment,{children:i.open_slots>0&&e.jsxs("tr",{children:[e.jsx("th",{scope:"row",children:R+1}),e.jsx("td",{children:i.subscription_class}),e.jsx("td",{children:i.open_slots}),e.jsx("td",{children:i.period_length}),e.jsx("td",{children:i.start_date}),e.jsx("td",{children:i.end_date}),e.jsx("td",{colSpan:"2",className:`${i.open_slots===0?"bg-gray":"bg-success"} text-white text-center tfRow`,onClick:()=>{i.open_slots!==0&&(a(!0),f(!1),P(!1),m({}),B({type:i.subscription_class}),w(i.subscription_class),n(i.period_length))},children:"Activate"})]},"subscription"+R)}))})]})})})})})]})};Qe.layout=d=>e.jsx(Ee,{children:d,title:"Leases"});export{Qe as default};
