import{R as l,r as $,b as i,_ as d,j as e}from"./main-fd1dbebb.js";import{C as q,L as P}from"./Layout-7d6b92ff.js";import{M as B}from"./MessageModal-7ce3cf05.js";import{u as I,f as M}from"./index-cf4ac53f.js";import"./lodash-1fb00506.js";import"./Modal-d83c389c.js";import"./removeClass-ca95e0eb.js";import"./index-6b877c29.js";import"./assertThisInitialized-3be3daa4.js";import"./formatting-fad57ba1.js";import"./MultipleUpload-3d28a641.js";import"./search-0091414d.js";function R(){const[r,m]=l.useState(!1),[u,h]=l.useState(null),[x,j]=l.useState(null),[n,p]=l.useState([]),[g,o]=l.useState(!1),[N,v]=l.useState([]),[y,_]=l.useState([]),[w,S]=l.useState([]),[s,a]=l.useState([]);function A(){i.get("/accounting/vat-settings/").then(t=>{_(t.data)}).catch(t=>{console.error(t)})}function D(){i.get("/accounting/sales-accounts/").then(t=>{S(t.data)}).catch(t=>{console.log(t)})}function E(){i.get("/accounting/currency").then(t=>{a(t.data)}).catch(t=>{console.log(t)})}function f(){i.get("/accounting/items/").then(t=>{p(t.data)}).catch(t=>{console.log(t)})}function F(){i.get("/accounting/sales-categories/").then(t=>{v(t.data)}).catch(t=>{console.log(t)})}$.useEffect(()=>{f(),D(),F(),A(),E()},[]);function C(){j(null),m(!1)}function T(){m(!0)}function V(t){t.preventDefault(),o(!0);const b=Object.fromEntries(new FormData(t.target));i.post("/accounting/items/",b).then(c=>{o(!1),console.log(c),d.success("Item added successfully"),f(),C()}).catch(c=>{o(!1),console.log(c),d.error(I(c))})}function k(t){t.preventDefault();const b=Object.fromEntries(new FormData(t.target));console.log(b),i.patch(`/accounting/items/${x.id}/`,b).then(c=>{d.success("Item updated successfully"),C(),f()}).catch(c=>{console.log(c),d.error(I(c))})}function O(){i.delete(`/accounting/items/${u.id}/`).then(()=>{d.success("Item deleted successfully"),f(),h(null)}).catch(t=>{console.log(t),d.error(I(t))})}return{items:n,loading:g,showAdd:r,currencies:s,categories:N,taxOptions:y,itemToEdit:x,itemToDelete:u,salesAccounts:w,setItemToDelete:h,setItemToEdit:j,handleItemAddition:V,openShowAdd:T,handleClose:C,handleDelete:O,handleEdit:k}}function U(){const{items:r,loading:m,showAdd:u,categories:h,currencies:x,taxOptions:j,itemToEdit:n,itemToDelete:p,salesAccounts:g,setItemToDelete:o,setItemToEdit:N,handleItemAddition:v,handleDelete:y,openShowAdd:_,handleClose:w,handleEdit:S}=R();return e.jsxs("main",{children:[e.jsx(B,{show:!!p,handleClose:()=>o(null),title:"Delete Item",message:`Are you sure you want to delete ${p?.name}?`,actionButtons:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-sm btn-info text-white",onClick:()=>o(null),children:"Cancel"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:y,children:"Delete"})]})}),e.jsx(q,{show:u||!!n,handleClose:w,title:n?"Edit Item":"Add Item",size:"md",children:e.jsxs("form",{className:"px-4 pb-5",onSubmit:n?S:v,children:[e.jsx("div",{className:"c-bg-light p-1 mb-3 text-center",children:"Item"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"category",className:"form-label",children:"Item Category"}),e.jsxs("select",{className:"form-select ",id:"category",name:"category",defaultValue:n?n.category:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Select one"}),h.map((s,a)=>e.jsx("option",{value:s.id,children:s.name},a))]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"id",className:"form-label",children:"Item Id"}),e.jsx("input",{type:"text",className:"form-control",id:"item_id",name:"item_id",required:!0,defaultValue:n?.id})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"name",className:"form-label",children:"Item Name"}),e.jsx("input",{type:"text",className:"form-control",id:"name",name:"name",required:!0,defaultValue:n?.name})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Unit Price"}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"w-50 d-flex",children:[e.jsx("label",{htmlFor:"unit_price_currency",className:"px-2 text-nowrap c-bg-light d-flex align-items-center",children:"Currency"}),e.jsxs("select",{className:"form-select rounded-0 px-1",id:"unit_price_currency",name:"unit_price_currency",required:!0,defaultValue:n?n.unit_price_currency:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Select one"}),x?.map((s,a)=>e.jsxs("option",{value:s.id,children:[s.currency_code," - ",s.currency_name]},a))]})]}),e.jsxs("div",{className:"w-50 d-flex",children:[e.jsx("label",{htmlFor:"price",className:"px-2 text-nowrap c-bg-light d-flex align-items-center",children:"Unit Price"}),e.jsx("input",{type:"number",className:"form-control rounded-0",id:"price",name:"price",required:!0,defaultValue:n?n.price:""})]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"unit_name",className:"form-label",children:"Unit Name (optional)"}),e.jsx("input",{type:"text",className:"form-control",id:"unit_name",name:"unit_name",defaultValue:n?n.unit_name:""})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"tax_configuration",className:"form-label",children:"Tax Configuration"}),e.jsxs("select",{className:"form-select ",id:"tax_configuration",name:"tax_configuration",defaultValue:n?n.tax_configuration:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Select one"}),j.map((s,a)=>e.jsxs("option",{value:s.id,children:[s.description," - ",s.rate,"%"]},a))]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"sales_account",className:"form-label",children:"Sales Account"}),e.jsxs("select",{className:"form-select",id:"sales_account",name:"sales_account",required:!0,defaultValue:n?n.sales_account:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Select one"}),g.map((s,a)=>e.jsx("option",{value:s.id,children:s.account_name},a))]})]}),e.jsx("div",{className:"mt-5 text-center",children:e.jsx("button",{disabled:m,type:"submit",className:"btn btn-primary",children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"d-inline-block ms-2",children:"saving.."})]}):"Save"})})]})}),e.jsxs("h5",{className:"position-relative text-center mb-2 p-2 mb-0",children:["Sales Items",e.jsx("div",{className:"position-absolute top-0 end-0",children:e.jsxs("button",{className:"btn btn-info text-white",onClick:_,children:[e.jsx("i",{className:"leading-icon material-icons",children:"add"}),"Add"]})})]}),e.jsxs("table",{className:"table table-sm table-striped border bg-white",children:[e.jsx("thead",{className:"position-sticky c-table-top text-white bg-info shadow-sm c-z-5",children:e.jsxs("tr",{className:"c-force-borders c-force-borders-white",children:[e.jsx("th",{className:"ps-3",children:e.jsx("div",{children:"Category"})}),e.jsx("th",{children:e.jsx("div",{children:"Id "})}),e.jsx("th",{children:e.jsx("div",{children:"Name "})}),e.jsx("th",{children:e.jsx("div",{children:"Unit Price "})}),e.jsx("th",{children:e.jsx("div",{children:"Date Created "})}),e.jsx("th",{children:e.jsx("div",{children:" "})})]})}),e.jsxs("tbody",{children:[!r?.length&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,children:e.jsx("div",{className:"custom-h-3 bg-white d-flex justify-content-center align-items-center",children:"Nothing to show"})})}),r?.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"ps-3",children:s.category_object.name}),e.jsx("td",{className:"ps-3",children:s.id}),e.jsx("td",{className:"ps-3",children:s.name}),e.jsx("td",{className:"ps-3",children:`${s.currency_object?.currency_code||""} ${s.price} / ${s.unit_name}`}),e.jsx("td",{className:"ps-3",children:s.date_created&&M(s.date_created)}),e.jsxs("td",{className:"d-flex gap-2 justify-content-end pe-3",children:[e.jsx("button",{className:"btn btn-sm btn-info text-white",onClick:()=>N(s),children:"Edit"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>o(s),children:"Delete"})]})]},a))]})]})]})}U.layout=r=>e.jsx(P,{children:r,title:"Sales Categories"});export{U as default};
