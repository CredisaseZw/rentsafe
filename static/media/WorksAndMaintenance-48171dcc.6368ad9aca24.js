import{r as b,b as F,_ as N,j as e}from"./main-5c37eb2a.js";import{u as q}from"./index-acacf113.js";import{M as O}from"./Modal-34f4a559.js";function S(m,s,n,i){const[t,h]=b.useState(!1),[a,c]=b.useState(!1),[r,u]=b.useState(i?i.isWorks?"works":"maintenance":"works"),[_,j]=b.useState(2),[g,y]=b.useState("weekly");async function k(o){o.preventDefault(),h(!0),c(!1);const l=Object.fromEntries(new FormData(o.target).entries()),x={property:l.property,tenant_landlord:l.tenant_landlord,tradesman:l.tradesman,reason:l.reason,budget:l.budget,title:l.works_title,details:l.works_detail,contractor:l.contractor_name,required_materials:l.required,responsible_person:l.whose_account,scheduled_date:l.date_schedule,...s?{creditor_id:s}:{},lease_id:m};console.log({formData:l,data:x}),F.post(reverseUrl("create_work_schedule"),x).then(d=>{console.log(d),N.success("Works data submitted!"),c(!0),n()}).catch(d=>{console.log(d),N.error(q(d))}),h(!1)}async function f(o){o.preventDefault(),h(!0),c(!1);const l=Object.fromEntries(new FormData(o.target).entries()),x={property:l.property,tenant_landlord:l.tenant_landlord,details:l.maintenance_detail,title:l.maintenance_title,tradesman:l.tradesman,contractor:l.contractor_name,required_materials:l.required,budget:l.budget,responsible_person:l.whose_account,reason:l.reason,frequency:l.frequency,scheduled_day:l.day_date,...l.frequency==="once_per"?{month_frequency:Number(l.month_frequency)}:{},...s?{creditor_id:s}:{},lease_id:m};console.log({data:x,formData:l}),F.post(reverseUrl("create_maintenance_schedule"),x).then(d=>{console.log(d),N.success("Maintenance data submited!"),c(!0),n()}).catch(d=>{console.log(d),N.error(q(d))}),h(!1)}function p(o){if(y("once_per"),o.target.value.trim()===""){j("");return}let l=Number(o.target.value);Number.isNaN(l)||l<1||l>999||j(l)}return{activeTab:r,isLoading:t,oncePerMonths:_,wasSuccessful:a,maintenanceFrequency:g,showMaintenance:()=>u("maintenance"),showWorks:()=>u("works"),setOncePerMonths:p,setMaintenanceFrequency:y,setWasSuccessful:c,submitMaintenance:f,submitWorks:k}}function R({isOpen:m,close:s,lease:n,creditorId:i,viewDefaults:t,refresh:h}){const{activeTab:a,isLoading:c,oncePerMonths:r,wasSuccessful:u,maintenanceFrequency:_,showWorks:j,submitWorks:g,showMaintenance:y,setOncePerMonths:k,submitMaintenance:f,setWasSuccessful:p,setMaintenanceFrequency:o}=S(n.lease_id,i,h,t);return e.jsx(e.Fragment,{children:e.jsxs(O,{show:m,onHide:()=>{p(!1),s()},size:"lg",contentClassName:"custom-bg-whitesmoke",backdrop:"static",centered:!0,children:[e.jsx(O.Header,{className:"p-0",children:e.jsx("div",{className:"w-100 p-3",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[!(c||u)&&e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",onClick:j,style:t?t.isWorks?{}:{display:"none"}:{},className:a==="works"?"btn btn-info text-white":"btn btn-outline-info",children:"Works Schedule"}),e.jsx("button",{type:"button",onClick:y,style:t?t.isWorks?{display:"none"}:{}:{},className:a==="maintenance"?"btn btn-info text-white":"btn btn-outline-info",children:"Maintenance Schedule"})]}),e.jsx("div",{className:"ms-auto d-flex gap-2",children:e.jsx("button",{type:"button",onClick:()=>{p(!1),s()},className:"btn btn-danger btn-sm",children:e.jsx("i",{className:"material-icons fs-3",children:"close"})})})]})})}),e.jsx(O.Body,{children:e.jsxs("div",{className:"custom-mn-h-5 position-relative p-3 pb-0",children:[c&&e.jsxs("div",{className:"text-center position-absolute top-50 start-50 translate-middle",children:[e.jsx("div",{className:"spinner-border text-info spinner-border-md",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Submitting..."})}),e.jsx("p",{children:"Submitting...please wait"})]}),u&&e.jsxs("div",{className:"position-absolute text-center top-50 start-50 translate-middle",children:[e.jsx("div",{children:e.jsx("i",{className:"material-icons fs-1 text-success",children:"check_circle"})}),e.jsxs("p",{children:["Done! ",e.jsx("br",{}),e.jsx("button",{type:"button",className:"btn btn-info text-white mt-2",onClick:()=>{p(!1),s()},children:"Close"})]})]}),e.jsx("div",{className:c||u?"d-none":"d-block",children:t&&t.isWorks||a==="works"?e.jsx(W,{viewDefaults:t,lease:n,submit:g}):e.jsx(M,{lease:n,oncePerMonths:r,setOncePerMonths:k,maintenanceFrequency:_,setMaintenanceFrequency:o,submit:f,viewDefaults:t})})]})})]})})}function W({submit:m,lease:s,viewDefaults:n}){return e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"property",className:"form-label small w-25",children:"Property:"}),e.jsx("input",{className:"form-control",name:"property",id:"property",defaultValue:n?.property?void 0:s?.address,...n?{value:n.property,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"tenant_landlord",className:"form-label small w-25",children:"Tenant / Landlord:"}),e.jsx("input",{className:"form-control",name:"tenant_landlord",id:"tenant_landlord",defaultValue:n?.tenant_landlord?void 0:s?.name||s.trading_name,...n?{value:n.tenant_landlord,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"works_title",className:"form-label small w-25",children:"Works Title:"}),e.jsx("input",{className:"form-control",name:"works_title",id:"works_title",...n?{value:n.title,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"works_detail",className:"form-label small w-25",children:"Works Detail:"}),e.jsx("input",{className:"form-control",name:"works_detail",id:"works_detail",...n?{value:n.details,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"tradesman",className:"form-label small w-25",children:"Trades Required:"}),e.jsx("input",{className:"form-control",name:"tradesman",id:"tradesman",...n?{value:n.tradesman,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"contractor_name",className:"form-label small w-25",children:"Contractor Name:"}),e.jsx("input",{className:"form-control",name:"contractor_name",id:"contractor_name",...n?{value:n.contractor_name||n.contractor,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"required",className:"form-label small w-25",children:"Inputs Required:"}),e.jsx("input",{className:"form-control",name:"required",id:"required",...n?{value:n.required||n.required_materials,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"budget",className:"form-label small w-25",children:"Budget:"}),e.jsx("input",{className:"form-control",type:"number",name:"budget",id:"budget",step:.01,...n?{value:n.budget,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"whose_account",className:"form-label small w-25",children:"Whose account:"}),e.jsxs("div",{className:"d-flex gap-3 align-items-center",children:[e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"whose_account",id:"tenant",value:"tenant",...n?{checked:n.whose_account==="tenant"||n.responsible_person==="tenant",readOnly:!0}:{defaultChecked:!s?.is_company}}),e.jsx("label",{className:"form-check-label",htmlFor:"tenant",children:"Tenant"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"whose_account",id:"landlord",value:"landlord",...n?{checked:n.whose_account==="landlord"||n.responsible_person==="landlord",readOnly:!0}:{defaultChecked:s?.is_company}}),e.jsx("label",{className:"form-check-label",htmlFor:"landlord",children:"Landlord"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"whose_account",id:"agent",value:"agent",...n?{checked:n.whose_account==="agent"||n.responsible_person==="agent",readOnly:!0}:{}}),e.jsx("label",{className:"form-check-label",htmlFor:"agent",children:"Agent"})]})]})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"reason",className:"form-label small w-25",children:"Reason:"}),e.jsx("input",{className:"form-control",name:"reason",id:"reason",...n?{value:n.reason,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"date_schedule",className:"form-label small w-25",children:"Date Schedule:"}),e.jsx("input",{type:"date",className:"form-control",name:"date_schedule",required:!0,id:"date_schedule",...n?{value:n.date_schedule||n.scheduled_date?new Date(n.date_schedule||n.scheduled_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],readOnly:!0}:{min:new Date().toISOString().split("T")[0]}})]}),e.jsx("div",{className:`mt-5 text-end ${n?"d-none":""}`,children:e.jsx("button",{type:"submit",className:"btn btn-info text-white",children:"Submit"})})]})}function M({submit:m,lease:s,maintenanceFrequency:n,setMaintenanceFrequency:i,oncePerMonths:t,setOncePerMonths:h,viewDefaults:a}){let c=[];for(let r=1;r<32;r++)c.push(r);return e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"property",className:"form-label small w-25",children:"Property:"}),e.jsx("input",{className:"form-control",name:"property",id:"property",defaultValue:a?.property?void 0:s?.address,...a?{value:a.property,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"tenant_landlord",className:"form-label small w-25",children:"Tenant / Landlord:"}),e.jsx("input",{className:"form-control",name:"tenant_landlord",id:"tenant_landlord",defaultValue:a?.tenant_landlord?void 0:s?.name||s.trading_name,...a?{value:a.tenant_landlord,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"maintenance_title",className:"form-label small w-25",children:"Maintenance Title:"}),e.jsx("input",{className:"form-control",name:"maintenance_title",id:"maintenance_title",...a?{value:a.title,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"maintenance_detail",className:"form-label small w-25",children:"Maintenance Detail:"}),e.jsx("input",{className:"form-control",name:"maintenance_detail",id:"maintenance_detail",...a?{value:a.details,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"tradesman",className:"form-label small w-25",children:"Trades Required:"}),e.jsx("input",{className:"form-control",name:"tradesman",id:"tradesman",...a?{value:a.tradesman,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"contractor_name",className:"form-label small w-25",children:"Contractor Name:"}),e.jsx("input",{className:"form-control",name:"contractor_name",id:"contractor_name",...a?{value:a.contractor_name||a.contractor,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"required",className:"form-label small w-25",children:"Inputs Required:"}),e.jsx("input",{className:"form-control",name:"required",id:"required",...a?{value:a.required||a.required_materials,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"budget",className:"form-label small w-25",children:"Budget:"}),e.jsx("input",{className:"form-control",type:"number",step:.01,name:"budget",id:"budget",...a?{value:a.budget,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"whose_account",className:"form-label small w-25",children:"Whose account:"}),e.jsxs("div",{className:"d-flex gap-3 align-items-center",children:[e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"whose_account",id:"tenant",value:"tenant",...a?{checked:a.whose_account==="tenant"||a.responsible_person==="tenant",readOnly:!0}:{defaultChecked:!s?.is_company}}),e.jsx("label",{className:"form-check-label",htmlFor:"tenant",children:"Tenant"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"whose_account",id:"landlord",value:"landlord",...a?{checked:a.whose_account==="landlord"||a.responsible_person==="landlord",readOnly:!0}:{defaultChecked:s?.is_company}}),e.jsx("label",{className:"form-check-label",htmlFor:"landlord",children:"Landlord"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"whose_account",id:"agent",value:"agent",...a?{checked:a.whose_account==="agent"||a.responsible_person==="agent",readOnly:!0}:{}}),e.jsx("label",{className:"form-check-label",htmlFor:"agent",children:"Agent"})]})]})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"reason",className:"form-label small w-25",children:"Reason:"}),e.jsx("input",{className:"form-control",name:"reason",id:"reason",...a?{value:a.reason,readOnly:!0}:{}})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"frequency",className:"form-label small w-25",children:"Frequency:"}),e.jsxs("div",{className:"d-flex gap-3 align-items-center",children:[e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"frequency",id:"weekly",value:"weekly",...a?{checked:a.frequency==="weekly",readOnly:!0}:{checked:n==="weekly",onChange:r=>i(r.target.value)}}),e.jsx("label",{className:"form-check-label",htmlFor:"weekly",children:"Weekly"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"frequency",id:"monthly",value:"monthly",...a?{checked:a.frequency==="monthly",readOnly:!0}:{checked:n==="monthly",onChange:r=>i(r.target.value)}}),e.jsx("label",{className:"form-check-label",htmlFor:"monthly",children:"Monthly"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"radio",name:"frequency",id:"once_per",value:"once_per",...a?{checked:a.frequency==="once_per",readOnly:!0}:{checked:n==="once_per",onChange:r=>i(r.target.value)}}),e.jsxs("label",{className:"form-check-label",htmlFor:"once_per",children:["Once every"," ",e.jsx("input",{className:"c-once-per-months",required:n==="once_per",name:"month_frequency",id:"once_per",...a?{value:a.month_frequency||void 0,readOnly:!0}:{value:t,onChange:h}})," ","months"]})]})]})]}),e.jsxs("div",{className:"d-flex gap-2 align-items-center mb-2",children:[e.jsx("label",{htmlFor:"date",className:"form-label small w-25",children:a&&a.frequency==="weekly"||n==="weekly"?"Day:":"Date:"}),e.jsx("select",{className:"form-select",name:"day_date",id:"day_date",required:!0,...a?{value:a.scheduled_day,readOnly:!0}:{defaultValue:""},children:a?e.jsx("option",{value:a.scheduled_day,children:a.scheduled_day}):n==="weekly"?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",disabled:!0,children:"Select Day"}),e.jsx("option",{value:"monday",children:"Monday"}),e.jsx("option",{value:"tuesday",children:"Tuesday"}),e.jsx("option",{value:"wednesday",children:"Wednesday"}),e.jsx("option",{value:"thursday",children:"Thursday"}),e.jsx("option",{value:"friday",children:"Friday"}),e.jsx("option",{value:"saturday",children:"Saturday"}),e.jsx("option",{value:"sunday",children:"Sunday"})]}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",disabled:!0,children:"Select Date"}),c.map(r=>e.jsx("option",{value:r,children:r},r))]})})]}),e.jsx("div",{className:`mt-5 text-end ${a?"d-none":""}`,children:e.jsx("button",{type:"submit",className:"btn btn-info text-white",children:"Submit"})})]})}export{R as W};
