import{r as s,b as L,u as z,j as t,_ as B}from"./main-fd1dbebb.js";import{_ as F}from"./lodash-1fb00506.js";import{u as I}from"./index-cf4ac53f.js";function Y({delay:p=500,url:f,value:d,setValue:b,placeholder:j,type:k,setAddress:h,setClientId:C,setRegNumber:i,setClientName:g,setMobileNo:y,from:u="subs"}){const[E,c]=s.useState(!1),[x,l]=s.useState(!1),[v,S]=s.useState(""),[w,n]=s.useState([]),[m,D]=s.useState([]);s.useEffect(()=>{if(!d){n([]);return}const a=F.debounce(o=>{l(!0),L.post(f,{searchParam:"guess",searchValue:o}).then(e=>{e.data?.status!=="failed"?(k==="company"?(D([...e.data]),n(e.data.map(r=>({label:r.registration_name+"("+r.registration_number+")",value:r.id})))):n(e.data.map(r=>({label:r.firstname+" "+r.surname+"("+r.national_id+")",value:r.id}))),S(""),l(!1)):(n([]),l(!1),S(I(e)))})},p);return a(d),l(!1),()=>{a.cancel()}},[p,f,d]);const _=z().props?.Auth?.company?.company_id,R=a=>{const o=Number(a.value)===Number(_);if(console.log({selected_company_id:a.value,company_id:_,isSelfCompany:o}),o){B.error("Blocked, a company cannot create a lease on itself");return}C(a.value),b(a.label),g&&g(a.label.split("(")[0]),i&&u==="subs"&&i(a.label.split("(").at(-1).split(")")[0]),i&&u==="leases"&&i(m.find(e=>e.id===a.value).email),y&&u==="leases"&&y(m.find(e=>e.id===a.value).mobile),h&&h(m.find(e=>e.id===a.value).address),c(!1)};return t.jsxs("div",{style:{width:"100%",border:"1px solid gray",borderRadius:"0.5rem",position:"relative"},children:[t.jsx("input",{type:"text",placeholder:j,value:d,onChange:a=>b(a.target.value),onFocus:()=>c(!0),onBlur:()=>{setTimeout(()=>c(!1),200)},style:{width:"100%",padding:"0.2rem",fontSize:"1rem",border:"none",borderRadius:"0.5rem",backgroundColor:"#eee",color:"black",opacity:"0.8"},className:"form-control"}),E&&t.jsx("div",{style:{border:"2px #ccc solid",borderRadius:"0.5rem",backgroundColor:"#d9d9d9",padding:"1rem 0.2rem",height:"250px",overflowY:"scroll",width:"100%",marginTop:"0.1rem",position:"absolute",top:"100%",left:"0",zIndex:"100"},children:!x&&v?t.jsx("div",{style:{color:"red",margin:"auto"},children:v}):x&&w.length===0?t.jsx("div",{style:{color:"black",margin:"auto"},children:"Loading..."}):w.map((a,o)=>t.jsx("div",{onClick:()=>R(a),style:{cursor:"pointer",padding:"0.2rem 0.5rem",color:"black",opacity:"0.8",backgroundColor:"#d3d3d3",borderRadius:"0.5rem",margin:"0.5rem 0"},children:a.label},o))})]})}export{Y as S};
