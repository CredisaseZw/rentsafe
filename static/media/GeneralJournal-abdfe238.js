import{R as j,b as w,_ as A,j as e}from"./main-5c37eb2a.js";import{L as E}from"./Layout-779839f2.js";import"./lodash-9dd08774.js";import"./assertThisInitialized-3be3daa4.js";import"./removeClass-bd16bbcb.js";import"./Modal-34f4a559.js";import"./index-5a5385bf.js";import"./formatting-fad57ba1.js";import"./MultipleUpload-041fb25a.js";import"./index-acacf113.js";import"./search-513e0541.js";function D(){const h={firstLine:{period:"",ref:"GJ-00",account:"",description:"",dr:0,cr:0,directContra:"yes"},additionalLines:[{period:"",ref:"GJ-00",account:"",description:"",dr:0,cr:0}]},[L,d]=j.useState([{...h},{...h}]),[b,g]=j.useState([]);function C(){w.get("/accounting/sales-accounts/").then(i=>{g(i.data)}).catch(i=>{console.log(i)})}j.useEffect(()=>{C()},[]);function x(){if(L.every(s=>{if(s.firstLine.directContra==="yes")return!0;const t=s.firstLine,n=s.additionalLines,u=n.reduce((l,N)=>l+parseFloat(N.dr),0),p=n.reduce((l,N)=>l+parseFloat(N.cr),0);return(t.dr>0||t.dr<0?u===parseFloat(t.dr):!0)&&(t.cr>0||t.cr<0?p===parseFloat(t.cr):!0)}))console.log("posting!",L);else{A.error("Second entry dr/cr columns do not balance with first entry dr/cr columns");return}}function v(i){d(s=>{const t=[...s];return t[i]={...t[i],firstLine:{...t[i].firstLine,directContra:t[i].firstLine.directContra==="yes"?"no":"yes"},additionalLines:[{period:t[i].firstLine.directContra==="yes"?"":t[i].firstLine.period,ref:"GJ-00",account:"",description:t[i].firstLine.description,dr:t[i].firstLine.cr>0||t[i].firstLine.cr<0?t[i].firstLine.cr:0,cr:t[i].firstLine.dr>0||t[i].firstLine.dr<0?t[i].firstLine.dr:0}]},t})}function f(i,s){d(t=>{const n=[...t],{name:u,value:p}=i.target;return n[s].firstLine[u]=p,n[s].additionalLines.forEach(l=>{n[s].firstLine.directContra==="yes"&&(l.period=n[s].firstLine.period,l.ref=n[s].firstLine.ref),l.description=n[s].firstLine.description,n[s].firstLine.dr>0||n[s].firstLine.dr<0?(l.cr=n[s].firstLine.dr,l.dr=0):(l.dr=n[s].firstLine.cr,l.cr=0)}),n})}function m(i,s,t){d(n=>{const u=[...n],{name:p,value:l}=i.target;return u[s].additionalLines[t][p]=l,u})}function r(i){d(s=>s.filter((t,n)=>n!==i))}function c(){d(i=>[...i,{...h}])}function a(i){d(s=>{const t=[...s];return t[i].additionalLines.push({period:"",ref:"GJ-00",account:"",description:t[i].firstLine.description,dr:0,cr:0}),t})}function o(i,s){d(t=>{const n=[...t];return n[i].additionalLines=n[i].additionalLines.filter((u,p)=>p!==s),n})}return{entries:L,generalLedgerAccounts:b,addEntry:c,postData:x,setEntries:d,removeEntry:r,addAdditionalLine:a,toggleDirectContra:v,removeAdditionalLine:o,handleFirstLineChange:f,handleAdditionalLineChange:m}}function k(){const{entries:h,generalLedgerAccounts:L,addEntry:d,postData:b,removeEntry:g,addAdditionalLine:C,toggleDirectContra:x,removeAdditionalLine:v,handleFirstLineChange:f,handleAdditionalLineChange:m}=D();return e.jsxs("div",{children:[e.jsx("h5",{className:"text-center",children:"General Journal"}),e.jsxs("div",{className:"d-flex gap-3 mb-3",children:["Date ",e.jsxs("b",{children:[" ",new Date().toISOString().split("T")[0]]})]}),e.jsxs("table",{className:"table table-sm bg-white table-bordered table-responsive",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Period"}),e.jsx("th",{children:"Reference"}),e.jsx("th",{children:"Account"}),e.jsx("th",{className:"custom-mn-w-3",children:"Description"}),e.jsx("th",{children:"DR"}),e.jsx("th",{children:"CR"}),e.jsx("th",{children:"Direct Contra"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:h.map((r,c)=>e.jsxs(j.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("select",{className:"c-form-select",name:"period",value:r.firstLine.period,onChange:a=>f(a,c),children:new Array(12).fill(0).map((a,o)=>e.jsx("option",{value:o+1,children:o+1},o))})}),e.jsx("td",{children:r.firstLine.ref+(c+1)}),e.jsx("td",{children:e.jsxs("select",{className:"c-form-select",name:"account",value:r.firstLine.account,onChange:a=>f(a,c),children:[e.jsx("option",{value:"",disabled:!0,children:"select one"}),L.map((a,o)=>e.jsx("option",{value:a.id,children:a.name},o))]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"form-control",name:"description",placeholder:"enter description...",value:r.firstLine.description,onChange:a=>f(a,c)})}),e.jsx("td",{children:e.jsx("input",{disabled:r.firstLine.cr>0||r.firstLine.cr<0,type:"number",className:"form-control",style:{maxWidth:"15ch"},name:"dr",placeholder:"0.00",value:r.firstLine.dr,onChange:a=>f(a,c)})}),e.jsx("td",{children:e.jsx("input",{disabled:r.firstLine.dr>0||r.firstLine.dr<0,type:"number",className:"form-control",style:{maxWidth:"15ch"},name:"cr",placeholder:"0.00",value:r.firstLine.cr,onChange:a=>f(a,c)})}),e.jsx("td",{children:e.jsx("div",{className:"form-check d-flex justify-content-center",children:e.jsx("input",{className:"form-check-input",name:"directContra",type:"checkbox",value:"yes",checked:r.firstLine.directContra==="yes",onChange:()=>x(c)})})}),e.jsx("td",{children:e.jsx("button",{disabled:h.length===1,className:"btn btn-sm btn-danger ",onClick:()=>g(c),children:e.jsx("i",{className:"material-icons",children:"close"})})})]}),r.additionalLines.map((a,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("select",{className:"c-form-select",name:"period",value:a.period,disabled:r.firstLine.directContra==="yes",onChange:i=>m(i,c,o),children:new Array(12).fill(0).map((i,s)=>e.jsx("option",{value:s+1,children:s+1},s))})}),e.jsx("td",{children:r.firstLine.ref+(c+1)}),e.jsx("td",{children:e.jsxs("select",{className:"c-form-select",name:"account",value:a.account,onChange:i=>m(i,c,o),children:[e.jsx("option",{value:"",disabled:!0,children:"select one"}),L.map((i,s)=>e.jsx("option",{value:i.id,children:i.name},s))]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"form-control",disabled:!0,name:"description",placeholder:"enter description...",value:a.description,onChange:i=>m(i,c,o)})}),e.jsx("td",{children:e.jsx("input",{disabled:r.firstLine.directContra==="yes"||r.firstLine.directContra!=="yes"&&(r.firstLine.dr>0||r.firstLine.dr<0),type:"number",className:"form-control",style:{maxWidth:"15ch"},name:"dr",placeholder:"0.00",value:a.dr,onChange:i=>m(i,c,o)})}),e.jsx("td",{children:e.jsx("input",{disabled:r.firstLine.directContra==="yes"||r.firstLine.directContra!=="yes"&&(r.firstLine.cr>0||r.firstLine.cr<0),type:"number",className:"form-control",style:{maxWidth:"15ch"},name:"cr",placeholder:"0.00",value:a.cr,onChange:i=>m(i,c,o)})}),e.jsxs("td",{children:[e.jsx("button",{disabled:r.additionalLines.length===1,className:"btn btn-sm text-danger me-2",onClick:()=>v(c,o),children:e.jsx("i",{className:"material-icons",children:"delete_outline"})}),o===r.additionalLines.length-1&&e.jsx("button",{disabled:r.firstLine.directContra==="yes",className:"btn btn-sm btn-outline-info",onClick:()=>C(c),children:e.jsx("i",{className:"material-icons",children:"add"})})]}),e.jsx("td",{})]},o)),e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:e.jsx("br",{})})}),c===h.length-1&&e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:e.jsx("button",{className:"btn btn-sm btn-outline-info",onClick:d,children:"Add Entry"})})})]},c))})]}),e.jsx("div",{className:"text-end",children:e.jsx("button",{className:"btn btn-info text-white",onClick:b,children:"Post"})})]})}k.layout=h=>e.jsx(E,{children:h,title:"General Journal"});export{k as default};
