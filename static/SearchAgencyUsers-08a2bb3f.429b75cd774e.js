import{r as i,a as V,j as e,_ as w,b as J,u as I}from"./media/main-05399e1a.js";import{D as R}from"./DeleteUserConfirmition-89cbf9a6.js";import{B as z}from"./BulkIconButton-a1027250.js";import{N as G}from"./NotFound-c48b9528.js";import{P as K}from"./PageHeader-beb10da4.js";import{M as C}from"./Modal-c30bba59.js";import{B}from"./Button-37d70552.js";import"./removeClass-6c8588b0.js";import"./index-3307b432.js";import"./Button-d8c7c16a.js";function L({show:g,handleClose:u,setAddSuccessful:b,url:O,userDetails:t,notFound:A}){const[h,d]=i.useState(!1),[s,v]=i.useState(""),{data:a,setData:N,post:F,reset:f}=V({firstName:t?.firstname||"",lastName:t?.surname||"",identificationNumber:t?.identification_number||"",identificationType:t?.identification_type||"",gender:t?.gender||"",dob:t?.dob||"",maritalStatus:t?.marital_status||"",address:t?.address||"",mobileNumber:t?.mobile||"",landLine:t?.landline||"",emailAddress:t?.email||"",currentEmployer:t?.employer_name||"",jobTitle:t?.job_title||"",dateOfemployment:t?.date_of_employment||"",individualId:t?.id||-1,isAgent:t?.is_agent||!1}),n=m=>N({...a,[m.target.id]:m.target.value}),j=m=>{console.log("create agent.."),m.preventDefault(),F(reverseUrl(O),{onStart:()=>{d(!0)},onSuccess:x=>{f(),w.success("OTP has been sent to user"),d(!1),u(),b(!0)},onError:x=>{w.error("Something went wrong! Please try again"),v(x),d(!1)}})},y=m=>{console.log("activate agent.."),m.preventDefault(),d(!0),J.post(reverseUrl("activate-agent"),{userId:a.individualId}).then(x=>{if(d(!1),u(),b(!0),console.log("success"),console.log(x.data.status),x.data.status==="success")w.success("Agent Activated successfully");else throw new Error}).catch(x=>{console.log("error"),d(!1),w.error("Something went wrong! Please try again")})};return e.jsx(e.Fragment,{children:e.jsx(C,{size:"lg",show:g,onHide:u,children:e.jsx("div",{children:e.jsxs("div",{className:"card card-raised",children:[e.jsx(C.Header,{closeButton:!0,className:"card-header bg-info px-4",children:e.jsxs("div",{className:`d-flex justify-content-between
                            align-items-center`,children:[e.jsxs("div",{className:"me-4",children:[e.jsx("h2",{className:"display-6 mb-0 text-white",children:"Create Agent"}),e.jsx("div",{className:"card-text"})]}),e.jsx("div",{className:"d-flex gap-2"})]})}),e.jsx("div",{className:"card-body p-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-info px-4",style:{paddingTop:"2px",paddingBottom:"2px"},children:e.jsx("div",{className:`d-flex justify-content-center
                            align-items-center`,children:e.jsxs("div",{className:"me-4",children:[e.jsx("h6",{className:"display-6 mb-0 text-white",children:"Personal details"}),e.jsx("div",{className:"card-text"})]})})}),e.jsxs("div",{className:"card-body p-4",style:{borderStyle:"solid",borderColor:"#26a69a"},children:[e.jsxs(C.Body,{children:[e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsxs("label",{className:"form-label",children:["Surname",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{value:a.lastName,onChange:n,type:"text",name:"lastName",required:!0,id:"lastName",placeholder:"Enter last name",className:"form-control form-control-sm"}),s&&e.jsx("div",{className:"text-danger mt-1",children:s.lastName})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs("label",{className:"form-label",children:["First Name",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{value:a.firstName,onChange:n,type:"text",name:"firstName",required:!0,id:"firstName",placeholder:"Enter first name",className:"form-control form-control-sm"}),s&&e.jsx("div",{className:"text-danger mt-1",children:s.firstName})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs("label",{className:"form-label",children:["Identification Type",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("select",{className:"form-select form-select-sm","aria-label":"Default select example",name:"identificationType",id:"identificationType",required:!0,onChange:n,value:a.identificationType,children:[e.jsx("option",{children:"Select..."}),e.jsx("option",{value:"nationalid",children:"National ID"}),e.jsx("option",{value:"passport",children:"Passport"}),e.jsx("option",{value:"servicesid",children:"Service ID"})]}),s&&e.jsx("div",{className:"text-danger mt-1",children:s.identificationType})]})]})})}),e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsxs("label",{className:"form-label",children:["Identification Number",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{value:a.identificationNumber,onChange:n,type:"text",required:!0,name:"identificationNumber",id:"identificationNumber",placeholder:"eg. 12345678K29",className:"form-control form-control-sm"}),s&&e.jsx("div",{className:"text-danger mt-1",children:s.identificationNumber})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Gender"}),e.jsxs("select",{className:"form-select form-select-sm","aria-label":"Default select example",onChange:n,id:"gender",name:"gender",value:a.gender,children:[e.jsx("option",{children:"Select..."}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]}),s&&e.jsx("div",{className:"text-danger mt-1",children:s.gender})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Date Of birth"}),e.jsx("input",{value:a.dob,onChange:n,type:"date",name:"dob",id:"dob",className:"form-control form-control-sm"}),s&&e.jsx("div",{className:"text-danger mt-1",children:s.dob})]})]})})}),e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Marital Status"}),e.jsxs("select",{className:"form-select form-select-sm","aria-label":"Default select example",name:"maritalStatus",onChange:n,id:"maritalStatus",value:a.maritalStatus,children:[e.jsx("option",{children:"Select..."}),e.jsx("option",{value:"single",children:"Single"}),e.jsx("option",{value:"Married",children:"Married"}),e.jsx("option",{value:"Other",children:"Other"})]}),s&&e.jsx("div",{className:"text-danger mt-1",children:s.maritalStatus})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs("label",{className:"form-label",children:["Address",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("textarea",{value:a.address,onChange:n,type:"text",id:"address",required:!0,name:"address",placeholder:"eg. 12 Main Road",className:"form-control form-control-sm"}),s&&e.jsx("div",{className:"text-danger mt-1",children:s.address})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsxs("label",{className:"form-label",children:["Mobile Number",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{value:a.mobileNumber,onChange:n,type:"tel",name:"mobileNumber",id:"mobileNumber",required:!0,placeholder:"eg. 0777123456",className:"form-control form-control-sm"}),s&&e.jsx("div",{className:"text-danger mt-1",children:s.mobileNumber})]})]})})}),e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Landline"}),e.jsx("input",{value:a.landLine,onChange:n,type:"tel",id:"landLine",name:"landLine",placeholder:"eg. 263 123 4567",className:"form-control form-control-sm"}),s&&e.jsx("div",{className:"text-danger mt-1",children:s.landLine})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Email Address"}),e.jsx("input",{value:a.emailAddress,onChange:n,type:"email",id:"emailAddress",name:"emailAddress",placeholder:"eg. your-name@your-company.com",className:"form-control form-control-sm"}),s&&e.jsx("div",{className:"text-danger mt-1",children:s.emailAddress})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-info px-4",style:{paddingTop:"2px",paddingBottom:"2px"},children:e.jsx("div",{className:`d-flex justify-content-center
                            align-items-center`,children:e.jsxs("div",{className:"me-4",children:[e.jsx("h6",{className:"display-6 mb-0 text-white",children:"Employment Details"}),e.jsx("div",{className:"card-text"})]})})})}),e.jsx("div",{className:"row mb-4 mt-4",children:e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Current Employer"}),e.jsx("input",{value:a.currentEmployer,onChange:n,type:"text",id:"currentEmployer",name:"currentEmployer",placeholder:"eg. Your Current Company",className:"form-control form-control-sm"}),s&&e.jsx("div",{className:"text-danger mt-1",children:s.currentEmployer})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Current Job Title"}),e.jsx("input",{value:a.jobTitle,onChange:n,type:"text",name:"jobTitle",id:"jobTitle",placeholder:"eg. Accounts Clerk",className:"form-control form-control-sm"}),s&&e.jsx("div",{className:"text-danger mt-1",children:s.jobTitle})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Date of Employement"}),e.jsx("input",{value:a.dateOfemployment,onChange:n,type:"date",id:"dateOfemployment",name:"dateOfemployment",className:"form-control form-control-sm"}),s&&e.jsx("div",{className:"text-danger mt-1",children:s.dateOfemployment})]})]})})})]}),e.jsx(C.Footer,{children:A?e.jsx(B,{className:"text-white",variant:"info",onClick:j,disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ml-2",children:"processing.."})]}):"Save and Proceed"}):e.jsx(e.Fragment,{children:a.isAgent?e.jsx(B,{className:"text-white",variant:"info",disabled:!0,children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ml-2",children:"processing.."})]}):"De-activate"}):e.jsx(B,{className:"text-white",variant:"info",onClick:y,disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ml-2",children:"processing.."})]}):"Activate Agent"})})})]})]})})]})})})})}function ne(){const[g,u]=i.useState(!1),b=()=>{u(!1),f(!1)},[O,t]=i.useState(!1),A=()=>u(!0),[h,d]=i.useState([]),[s,v]=i.useState([]),[a,N]=i.useState(!1),[F,f]=i.useState(!1),[n,j]=i.useState(!1),[y,m]=i.useState(!1),[x,p]=i.useState({}),[_,E]=i.useState(!1),[P,U]=i.useState({});I().props.Auth;const k=I().props.result,M=I().props.agents;i.useEffect(()=>{d(k?.sort((l,r)=>{const c=`${l.firstname} ${l.surname}`.toUpperCase(),o=`${r.firstname} ${r.surname}`.toUpperCase();return c<o?-1:c>o?1:0})),v(M?.sort((l,r)=>{const c=`${l.firstname} ${l.surname}`.toUpperCase(),o=`${r.firstname} ${r.surname}`.toUpperCase();return c<o?-1:c>o?1:0}))},[]);const{data:S,setData:$,post:q}=V({searchParam:"fullname",searchValue:""}),D=l=>{f(!0),$({...S,[l.target.id]:l.target.value})},H=l=>{if(l.preventDefault(),S.searchValue==="")return U({searchValue:"Please enter a search value"});q(reverseUrl("search-agents"),{onStart:()=>{N(!0),j(!1),d({}),U({}),E(!1)},onSuccess:r=>{const c=o=>JSON.stringify(o)==="{}";r.props.result.length<1&&E(!0),c(r.props.result)===!0?j(!0):d(r.props.result),N(!1)},onError:r=>{N(!1)}})};return e.jsxs("main",{children:[e.jsx(K,{title:"Agency Users"}),e.jsxs("div",{className:"container-xl p-5",children:[e.jsx("div",{className:"row align-items-center mb-5",children:e.jsx("div",{className:"col-12 col-md-auto",children:e.jsx("form",{className:"mb-5",onSubmit:H,children:e.jsxs("div",{className:"d-flex flex-column flex-sm-row gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:"",children:"Filter by Full Name/ID"}),e.jsx("input",{value:S.searchValue,onChange:D,type:"text",name:"searchValue",id:"searchValue",placeholder:"Search individual to activate",className:"form-control form-control"}),P.searchValue&&e.jsx("small",{className:"text-danger",children:P.searchValue})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",htmlFor:"",children:"Select filter Parameter"}),e.jsxs("select",{className:"form-select","aria-label":"Default select example",name:"searchParam",id:"searchParam",onChange:D,children:[e.jsx("option",{value:"fullname",children:"Full name"}),e.jsx("option",{value:"nationalid",children:"National ID"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{className:"btn btn-raised-info text-white",type:"submit",disabled:a,children:[e.jsx("i",{className:"leading-icon material-icons",children:"search"}),a?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ml-2",children:"Searching.."})]}):"Search"]})}),e.jsx("div",{className:"mt-4",children:e.jsx(z,{})})]})})})}),g&&e.jsx(L,{show:g,handleClose:b,setAddSuccessful:t,action:"create",url:"create-agent",notFound:!0}),n&&e.jsx(L,{show:n,handleClose:()=>{j(!1),p({})},setAddSuccessful:()=>{},setFetchedData:d,userDetails:x}),y&&e.jsx(R,{url:"delete-agent",handleClose:()=>{m(!1),p({}),f(!1)},show:y,type:"agent",setFetchedData:d,setAllAgents:v,userId:x.id,name:x.name}),e.jsx("div",{className:"card card-raised",children:e.jsx("div",{className:"card-body p-4",children:e.jsxs("div",{className:"datatable-wrapper datatable-loading no-footer sortable searchable fixed-columns",children:[e.jsxs("div",{className:"datatable-container",children:[e.jsx("table",{className:"table table-striped",children:e.jsxs("tbody",{children:[e.jsxs("tr",{style:{backgroundColor:"#e4e4e4"},children:[e.jsx("th",{scope:"col",children:"Forenames"}),e.jsx("th",{scope:"col",children:"surname"}),e.jsx("th",{scope:"col",children:"National ID"}),e.jsx("th",{scope:"col",children:"Edit"}),e.jsx("th",{scope:"col",children:"Delete"})]}),a?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ml-2",children:"searching.."})]}):h&&h?.map(({id:l,firstname:r,surname:c,identification_number:o})=>e.jsxs("tr",{children:[e.jsx("th",{scope:"row",children:r}),e.jsx("td",{children:c}),e.jsx("td",{children:o}),l?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-raised text-info d-flex align-items-center justify-content-center",onClick:()=>{j(!0),p(h?.find(T=>T.id===l))},children:e.jsx("i",{className:"leading-icon material-icons",children:"edit"})})}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-raised text-danger d-flex align-items-center justify-content-center",onClick:()=>{m(!0),p({id:l,name:r+" "+c})},children:e.jsx("i",{className:"leading-icon material-icons",children:"delete"})})})]}):null]},l)),s&&!F&&s?.map(({id:l,firstname:r,surname:c,identification_number:o})=>e.jsxs("tr",{children:[e.jsx("th",{scope:"row",children:r}),e.jsx("td",{children:c}),e.jsx("td",{children:o}),l?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-raised text-info d-flex align-items-center justify-content-center",onClick:()=>{j(!0),p(s?.find(T=>T.id===l))},children:e.jsx("i",{className:"leading-icon material-icons",children:"edit"})})}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-raised text-danger d-flex align-items-center justify-content-center",onClick:()=>{m(!0),p({id:l,name:r+" "+c})},children:e.jsx("i",{className:"leading-icon material-icons",children:"delete"})})})]}):null]},l))]})}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-md-auto",children:_&&e.jsx(G,{handleShow:A,searchValue:S.searchValue,handleCloseModal:()=>E(!1),userType:"Individual"})})})]}),e.jsxs("div",{className:"datatable-bottom",children:[e.jsx("div",{className:"datatable-info"}),e.jsx("nav",{className:"datatable-pagination"})]})]})})})]})]})}export{ne as default};
