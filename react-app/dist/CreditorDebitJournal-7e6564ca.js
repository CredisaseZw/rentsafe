import{r as b,b as w,_ as x,j as e}from"./media/main-03506851.js";import{L as g}from"./Layout-5dfbe7be.js";import f from"./SearchCreditor-e158f907.js";import{f as h}from"./formatting-fad57ba1.js";import"./lodash-53c4daa3.js";import"./assertThisInitialized-3be3daa4.js";import"./removeClass-5c418ba9.js";import"./Modal-af3c3068.js";import"./index-c9bff481.js";import"./MultipleUpload-2f4dc496.js";import"./index-81a8d5ca.js";import"./search-a4b5c39c.js";function D(){const[c,o]=b.useState(B),[i,r]=b.useState(!1);function d(a,t){const{name:n,value:u}=a.target;o(j=>j.map((p,N)=>t===N?{...p,[n]:u}:p))}function m(a){a.preventDefault(),r(!0),w.post(reverseUrl("creditor_debit_journal"),{rows:c}).then(t=>{if(console.log(t),t.data.error)throw new Error(t.data.error);x.success("Journal entry(s) created successfully"),o([{id:1,date:new Date().toISOString().split("T")[0],creditorName:"",details:"",accountBalance:"",debitAmount:"",endBalance:"",leaseId:"",accountBalance:"",endDate:""}])}).catch(t=>{console.log(t),x.error(`Failed to submit data 
`+t)}),r(!1)}function l(a){o(t=>t.filter((n,u)=>u!==a))}function s(){o(a=>[...a,{id:a.length+1,date:new Date().toISOString().split("T")[0],creditorName:"",details:"",accountBalance:"",debitAmount:"",endBalance:"",leaseId:"",accountBalance:"",endDate:""}])}return{rows:c,isLoading:i,addRow:s,setRows:o,removeRow:l,handleSubmit:m,handleInputChange:d}}const B=[{id:1,date:new Date().toISOString().split("T")[0],creditorName:"",details:"",accountBalance:"",debitAmount:"",endBalance:"",leaseId:"",accountBalance:"",endDate:""}];function S(){const{rows:c,isLoading:o,addRow:i,setRows:r,removeRow:d,handleSubmit:m,handleInputChange:l}=D();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-white border rounded-3",children:[e.jsx("h5",{className:"text-center p-2 mb-0 text-white bg-info",children:"Debit Journal"}),e.jsxs("form",{className:"p-2",onSubmit:m,children:[e.jsxs("table",{className:"table table-responsive table-bordered table-sm",children:[e.jsx("thead",{className:"position-sticky c-table-top bg-white shadow-sm c-z-5",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-nowrap",children:"Date"}),e.jsx("th",{className:"text-nowrap",children:"Creditor"}),e.jsx("th",{className:"text-nowrap",children:"Details"}),e.jsx("th",{className:"text-nowrap",children:"Account Balance"}),e.jsx("th",{className:"text-nowrap",children:"Debit Amount"}),e.jsx("th",{className:"text-nowrap",children:"End Balance"}),e.jsx("th",{className:"text-nowrap",children:"Action"})]})}),e.jsx("tbody",{children:c.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"custom-w-170",children:e.jsx("input",{className:"form-control custom-w-fit",type:"date",name:"date",required:!0,max:new Date().toISOString().split("T")[0],min:s.endDate?new Date(s.endDate).toISOString().split("T")[0]:void 0,value:s.date,onChange:t=>l(t,a)})}),e.jsx("td",{className:"custom-w-170 position-relative",style:{zIndex:c.length-a},children:e.jsx(f,{value:s.creditorName,setValue:t=>{const n=[...c];n[a].creditorName=t,r(n)},url:reverseUrl("get_creditor_journals"),placeholder:"Start typing",delay:500,setCreditorName:t=>{const n=[...c];n[a].creditorName=t,r(n)},setLeaseId:t=>{const n=[...c];n[a].leaseId=t,r(n)},setOpeningBalance:t=>{const n=[...c];n[a].accountBalance=t,r(n)},setEndDate:t=>{const n=[...c];n[a].endDate=t,r(n)}})}),e.jsx("td",{className:"custom-w-3",children:e.jsx("textarea",{name:"details",className:"form-control",rows:2,id:"details",value:s.details,onChange:t=>l(t,a)})}),e.jsx("td",{className:"text-end",children:s.accountBalance?h(s.accountBalance):""}),e.jsx("td",{className:"custom-w-150",children:e.jsx("input",{onChange:t=>l(t,a),className:"form-control",type:"number",id:"debitAmount",name:"debitAmount",value:s.debitAmount,required:!0})}),e.jsx("td",{className:"text-end",children:s.debitAmount?h(Number(s.accountBalance)-Number(s.debitAmount)):s.accountBalance?h(Number(s.accountBalance)):""}),e.jsx("td",{className:"text-center",children:e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>d(a),disabled:c.length===1,children:"-"})})]},s.id))})]}),e.jsx("div",{className:"text-end p-2",children:e.jsxs("button",{type:"button",className:"btn btn-success",onClick:i,children:[e.jsx("i",{className:"leading-icon material-icons",children:"add"}),"Add Row"]})}),e.jsx("div",{className:"text-center mb-3",children:e.jsx("button",{type:"submit",className:"btn btn-info text-white",children:o?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"ms-2",children:"processing.."})]}):"Submit"})})]})]})})}S.layout=c=>e.jsx(g,{children:c,title:"Creditor Credit Adjustment - Debit Journal"});export{S as default};
