import{R as o,r as A,b as d,_ as m,j as e}from"./main-605f1a65.js";import{C as E}from"./ContentModal-746eda5c.js";import{L as V}from"./Layout-d8d0e5c9.js";import{M as k}from"./MessageModal-4e52efde.js";import{u as I,f as O}from"./index-5b34db9a.js";import"./Modal-fa119524.js";import"./removeClass-2f25b0a4.js";import"./index-4b3e425d.js";import"./lodash-65d1f6eb.js";import"./assertThisInitialized-3be3daa4.js";import"./formatting-9de8c923.js";import"./MultipleUpload-3f80ff47.js";import"./search-7ba8f0d2.js";function U(){const[c,n]=o.useState(!1),[h,j]=o.useState(null),[p,f]=o.useState(null),[t,r]=o.useState([]),[u,x]=o.useState(!1),[g,N]=o.useState([]),[v,y]=o.useState([]);function w(){d.get("/accounting/vat-settings/").then(a=>{y(a.data)}).catch(a=>{console.error(a)})}function s(){d.get("/accounting/items/").then(a=>{r(a.data)}).catch(a=>{console.log(a)})}function l(){d.get("/accounting/sales-categories/").then(a=>{N(a.data)}).catch(a=>{console.log(a)})}A.useEffect(()=>{s(),l(),w()},[]);function _(){f(null),n(!1)}function S(){n(!0)}function C(a){a.preventDefault(),x(!0);const b=Object.fromEntries(new FormData(a.target));d.post("/accounting/items/",b).then(i=>{x(!1),console.log(i),m.success("Item added successfully"),s(),_()}).catch(i=>{x(!1),console.log(i),m.error(I(i))})}function D(a){a.preventDefault();const b=Object.fromEntries(new FormData(a.target));console.log(b),d.patch(`/accounting/items/${p.id}/`,b).then(i=>{m.success("Item updated successfully"),_(),s()}).catch(i=>{console.log(i),m.error(I(i))})}function F(){d.delete(`/accounting/items/${h.id}/`).then(()=>{m.success("Item deleted successfully"),s(),j(null)}).catch(a=>{console.log(a),m.error(I(a))})}return{items:t,loading:u,showAdd:c,categories:g,taxOptions:v,itemToEdit:p,itemToDelete:h,setItemToDelete:j,setItemToEdit:f,handleItemAddition:C,openShowAdd:S,handleClose:_,handleDelete:F,handleEdit:D}}function q({currencies:c=[]}){const{items:n,loading:h,showAdd:j,categories:p,taxOptions:f,itemToEdit:t,itemToDelete:r,setItemToDelete:u,setItemToEdit:x,handleItemAddition:g,handleDelete:N,openShowAdd:v,handleClose:y,handleEdit:w}=U();return e.jsxs("main",{children:[e.jsx(k,{show:!!r,handleClose:()=>u(null),title:"Delete Item",message:`Are you sure you want to delete ${r==null?void 0:r.name}?`,actionButtons:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-sm btn-info text-white",onClick:()=>u(null),children:"Cancel"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:N,children:"Delete"})]})}),e.jsx(E,{show:j||!!t,handleClose:y,title:t?"Edit Item":"Add Item",size:"md",children:e.jsxs("form",{className:"px-4 pb-5",onSubmit:t?w:g,children:[e.jsx("div",{className:"c-bg-light p-1 mb-3 text-center",children:"Item"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"category",className:"form-label",children:"Item Category"}),e.jsxs("select",{className:"form-select ",id:"category",name:"category",defaultValue:t?t.category:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Select one"}),p.map((s,l)=>e.jsx("option",{value:s.id,children:s.name},l))]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"id",className:"form-label",children:"Item Id"}),e.jsx("input",{type:"text",className:"form-control",id:"item_id",name:"item_id",required:!0,defaultValue:t==null?void 0:t.id})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"name",className:"form-label",children:"Item Name"}),e.jsx("input",{type:"text",className:"form-control",id:"name",name:"name",required:!0,defaultValue:t==null?void 0:t.name})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Unit Price"}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"w-50 d-flex",children:[e.jsx("label",{htmlFor:"unit_price_currency",className:"px-2 text-nowrap c-bg-light d-flex align-items-center",children:"Currency"}),e.jsxs("select",{className:"form-select rounded-0 px-1",id:"unit_price_currency",name:"unit_price_currency",required:!0,defaultValue:t?t.unit_price_currency:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Select one"}),c!=null&&c.length?c.map((s,l)=>e.jsx("option",{value:s,children:s},l)):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"ZIG",children:"ZIG"})]})]})]}),e.jsxs("div",{className:"w-50 d-flex",children:[e.jsx("label",{htmlFor:"price",className:"px-2 text-nowrap c-bg-light d-flex align-items-center",children:"Unit Price"}),e.jsx("input",{type:"number",className:"form-control rounded-0",id:"price",name:"price",required:!0,defaultValue:t?t.price:""})]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"unit_name",className:"form-label",children:"Unit Name (optional)"}),e.jsx("input",{type:"text",className:"form-control",id:"unit_name",name:"unit_name",defaultValue:t?t.unit_name:""})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"tax_configuration",className:"form-label",children:"Tax Configuration"}),e.jsxs("select",{className:"form-select ",id:"tax_configuration",name:"tax_configuration",defaultValue:t?t.tax_configuration:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Select one"}),f.map((s,l)=>e.jsxs("option",{value:s.id,children:[s.description," - ",s.rate,"%"]},l))]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"sales_account",className:"form-label",children:"Sales Account"}),e.jsx("input",{type:"text",className:"form-control",id:"sales_account",name:"sales_account",required:!0,defaultValue:t?t.sales_account:""})]}),e.jsx("div",{className:"mt-5 text-center",children:e.jsx("button",{disabled:h,type:"submit",className:"btn btn-primary",children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm"}),e.jsx("span",{className:"d-inline-block ms-2",children:"saving.."})]}):"Save"})})]})}),e.jsxs("h5",{className:"position-relative text-center mb-2 p-2 mb-0",children:["Items",e.jsx("div",{className:"position-absolute top-0 end-0",children:e.jsxs("button",{className:"btn btn-info text-white",onClick:v,children:[e.jsx("i",{className:"leading-icon material-icons",children:"add"}),"Add"]})})]}),e.jsxs("table",{className:"table table-sm table-striped border bg-white",children:[e.jsx("thead",{className:"position-sticky c-table-top text-white bg-info shadow-sm c-z-5",children:e.jsxs("tr",{className:"c-force-borders c-force-borders-white",children:[e.jsx("th",{className:"ps-3",children:e.jsx("div",{children:"Category"})}),e.jsx("th",{children:e.jsx("div",{children:"Id "})}),e.jsx("th",{children:e.jsx("div",{children:"Name "})}),e.jsx("th",{children:e.jsx("div",{children:"Unit Price "})}),e.jsx("th",{children:e.jsx("div",{children:"Date Created "})}),e.jsx("th",{children:e.jsx("div",{children:" "})})]})}),e.jsxs("tbody",{children:[!(n!=null&&n.length)&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,children:e.jsx("div",{className:"custom-h-3 bg-white d-flex justify-content-center align-items-center",children:"Nothing to show"})})}),n==null?void 0:n.map((s,l)=>e.jsxs("tr",{children:[e.jsx("td",{className:"ps-3",children:s.category}),e.jsx("td",{className:"ps-3",children:s.id}),e.jsx("td",{className:"ps-3",children:s.name}),e.jsxs("td",{className:"ps-3",children:[" ",s.price]}),e.jsx("td",{className:"ps-3",children:s.date_created&&O(s.date_created)}),e.jsxs("td",{className:"d-flex gap-2 justify-content-end pe-3",children:[e.jsx("button",{className:"btn btn-sm btn-info text-white",onClick:()=>x(s),children:"Edit"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>u(s),children:"Delete"})]})]},l))]})]})]})}q.layout=c=>e.jsx(V,{children:c,title:"Sales Categories"});export{q as default};
